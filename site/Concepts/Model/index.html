<!doctype html><html lang=en class=no-js> <head><link href=https://fonts.gstatic.com rel=preconnect crossorigin><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="The technical documentation of the DARIAH Contribution Tool. Design, specs, rationales, patterns, diagrams.
"><link href=https://dans-labs.github.io/dariah/Concepts/Model/ rel=canonical><meta name=author content="Dirk Roorda"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../icons/favicon.ico><meta name=generator content="mkdocs-1.0.4, mkdocs-dans-4.4.1"><title>Model - Tech Doc DARIAH contribution tool</title><link rel=stylesheet href=../../assets/stylesheets/application.b28fc32d.css><script src=../../assets/javascripts/modernizr.74668098.js></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,700|Glegoo:300,400,400i,700|Ubuntu+Mono&display=swap"><style>.body-type,body,input{font-family:"Open Sans",sans-serif}.head-type,h1,h2,h3,h4,h5{font-family:"Glegoo",serif}.code-type,code,kbd,pre{font-family:"Ubuntu Mono",monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css></head> <body dir=ltr> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#model tabindex=1 class=md-skip> Skip to content </a> <header class="md-header md-dev" data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://www.dariah.eu title=DARIAH class="md-header-nav__button md-logo"> <img src=../../images/dariah.png height=50> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://dans-labs.github.io/dariah/ title="Tech Doc DARIAH contribution tool" class="md-header-nav__button md-logo"> <img src=../../images/inkind_logo.png height=50> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title head-type" data-md-component=title> <span class=md-header-nav__topic> Tech Doc DARIAH contribution tool <span class="md-dev-inline head-type"> still in beta </span> </span> <span class=md-header-nav__topic> Model <span class="md-dev-inline head-type"> still in beta </span> </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/dans-labs/dariah/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. title=Home class="md-tabs__link head-type"> Home </a> </li> <li class=md-tabs__item> <a href=../../About/Codebase/ title=About class="md-tabs__link head-type"> About </a> </li> <li class=md-tabs__item> <a href=../../Functionality/Business/ title=Functionality class="md-tabs__link head-type"> Functionality </a> </li> <li class=md-tabs__item> <a href=../../Legacy/Content/ title=Legacy class="md-tabs__link head-type"> Legacy </a> </li> <li class=md-tabs__item> <a href=../Architecture/ title=Concepts class="md-tabs__link md-tabs__link--active head-type"> Concepts </a> </li> <li class=md-tabs__item> <a href=../../Server/Authentication/ title=Server class="md-tabs__link head-type"> Server </a> </li> <li class=md-tabs__item> <a href=../../Client/Components/ title=Client class="md-tabs__link head-type"> Client </a> </li> <li class=md-tabs__item> <a href=../../Technology/Tech/ title=Technology class="md-tabs__link head-type"> Technology </a> </li> <li class=md-tabs__item> <a href=../../Integration/API/ title=Integration class="md-tabs__link head-type"> Integration </a> </li> <li class=md-tabs__item> <a href=../../Maintenance/Deploy/ title=Maintenance class="md-tabs__link head-type"> Maintenance </a> </li> </ul> </div> </nav> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title head-type md-nav__title--site" for=__drawer> <a href=https://dans-labs.github.io/dariah/ title="Tech Doc DARIAH contribution tool" class="md-nav__button md-logo"> <img src=../../images/inkind_logo.png width=48 height=48> </a> Tech Doc DARIAH contribution tool </label> <div class=md-nav__source> <a href=https://github.com/dans-labs/dariah/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Home class="md-nav__link head-type"> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class="md-nav__link head-type" for=nav-2> About </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-2> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../About/Codebase/ title=Codebase class="md-nav__link head-type"> Codebase </a> </li> <li class=md-nav__item> <a href=../../About/Stats/ title=Stats class="md-nav__link head-type"> Stats </a> </li> <li class=md-nav__item> <a href=../../About/News/ title=News class="md-nav__link head-type"> News </a> </li> <li class=md-nav__item> <a href=../../About/Lessons/ title=Lessons class="md-nav__link head-type"> Lessons </a> </li> <li class=md-nav__item> <a href=../../About/Diagrams/ title=Diagrams class="md-nav__link head-type"> Diagrams </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class="md-nav__link head-type" for=nav-3> Functionality </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-3> Functionality </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Functionality/Business/ title=Business class="md-nav__link head-type"> Business </a> </li> <li class=md-nav__item> <a href=../../Functionality/Tables/ title=Tables class="md-nav__link head-type"> Tables </a> </li> <li class=md-nav__item> <a href=../../Functionality/Templates/ title=Templates class="md-nav__link head-type"> Templates </a> </li> <li class=md-nav__item> <a href=../../Functionality/Workflow/ title=Workflow class="md-nav__link head-type"> Workflow </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class="md-nav__link head-type" for=nav-4> Legacy </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-4> Legacy </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Legacy/Content/ title=Content class="md-nav__link head-type"> Content </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5 checked> <label class="md-nav__link head-type" for=nav-5> Concepts </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-5> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Architecture/ title=Architecture class="md-nav__link head-type"> Architecture </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active head-type" for=__toc> Model </label> <a href=./ title=Model class="md-nav__link md-nav__link--active head-type"> Model </a> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title head-type" for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#mongodb title=MongoDB class="md-nav__link head-type"> MongoDB </a> </li> <li class=md-nav__item> <a href=#configuration title=Configuration class="md-nav__link head-type"> Configuration </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#name-handling title="Name handling" class="md-nav__link head-type"> Name handling </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#data-model title="Data model" class="md-nav__link head-type"> Data model </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#generic title=generic class="md-nav__link head-type"> generic </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#systemfields title=systemFields class="md-nav__link head-type"> systemFields </a> </li> <li class=md-nav__item> <a href=#table-defaults title="Table defaults" class="md-nav__link head-type"> Table defaults </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#title title=title class="md-nav__link head-type"> title </a> </li> <li class=md-nav__item> <a href=#item title=item class="md-nav__link head-type"> item </a> </li> <li class=md-nav__item> <a href=#sort title=sort class="md-nav__link head-type"> sort </a> </li> <li class=md-nav__item> <a href=#fieldorder title=fieldOrder class="md-nav__link head-type"> fieldOrder </a> </li> <li class=md-nav__item> <a href=#fieldspecs title=fieldSpecs class="md-nav__link head-type"> fieldSpecs </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#valtype title=valType class="md-nav__link head-type"> valType </a> </li> <li class=md-nav__item> <a href=#select title=select class="md-nav__link head-type"> select </a> </li> <li class=md-nav__item> <a href=#fixed title=fixed class="md-nav__link head-type"> fixed </a> </li> <li class=md-nav__item> <a href=#inactive title=inactive class="md-nav__link head-type"> inactive </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#listing-related-records title="Listing related records" class="md-nav__link head-type"> Listing related records </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tables title=tables class="md-nav__link head-type"> tables </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#filters title=filters class="md-nav__link head-type"> filters </a> </li> <li class=md-nav__item> <a href=#details-and-detailorder title="details and detailOrder" class="md-nav__link head-type"> details and detailOrder </a> </li> <li class=md-nav__item> <a href=#needmaster title=needMaster class="md-nav__link head-type"> needMaster </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#permission-model title="Permission model" class="md-nav__link head-type"> Permission model </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#groups title=Groups class="md-nav__link head-type"> Groups </a> </li> <li class=md-nav__item> <a href=#levels title=Levels class="md-nav__link head-type"> Levels </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#authorize title=Authorize class="md-nav__link head-type"> Authorize </a> </li> <li class=md-nav__item> <a href=#methods title=Methods class="md-nav__link head-type"> Methods </a> </li> <li class=md-nav__item> <a href=#actions title=Actions class="md-nav__link head-type"> Actions </a> </li> <li class=md-nav__item> <a href=#tables-and-fields title="Tables and Fields" class="md-nav__link head-type"> Tables and Fields </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Routing/ title=Routing class="md-nav__link head-type"> Routing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class="md-nav__link head-type" for=nav-6> Server </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-6> Server </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Server/Authentication/ title=Authentication class="md-nav__link head-type"> Authentication </a> </li> <li class=md-nav__item> <a href=../../Server/Server/ title=Server class="md-nav__link head-type"> Server </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class="md-nav__link head-type" for=nav-7> Client </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-7> Client </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Client/Components/ title=Components class="md-nav__link head-type"> Components </a> </li> <li class=md-nav__item> <a href=../../Client/Dux/ title=Dux class="md-nav__link head-type"> Dux </a> </li> <li class=md-nav__item> <a href=../../Client/Lib/ title=Lib class="md-nav__link head-type"> Lib </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class="md-nav__link head-type" for=nav-8> Technology </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-8> Technology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Technology/Tech/ title=Tech class="md-nav__link head-type"> Tech </a> </li> <li class=md-nav__item> <a href=../../Technology/ES6/ title=ES6 class="md-nav__link head-type"> ES6 </a> </li> <li class=md-nav__item> <a href=../../Technology/React/ title=React class="md-nav__link head-type"> React </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-9 type=checkbox id=nav-9> <label class="md-nav__link head-type" for=nav-9> Integration </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-9> Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Integration/API/ title=API class="md-nav__link head-type"> API </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-10 type=checkbox id=nav-10> <label class="md-nav__link head-type" for=nav-10> Maintenance </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-10> Maintenance </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Maintenance/Deploy/ title=Deploy class="md-nav__link head-type"> Deploy </a> </li> <li class=md-nav__item> <a href=../../Maintenance/Tests/ title=Tests class="md-nav__link head-type"> Tests </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title head-type" for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#mongodb title=MongoDB class="md-nav__link head-type"> MongoDB </a> </li> <li class=md-nav__item> <a href=#configuration title=Configuration class="md-nav__link head-type"> Configuration </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#name-handling title="Name handling" class="md-nav__link head-type"> Name handling </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#data-model title="Data model" class="md-nav__link head-type"> Data model </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#generic title=generic class="md-nav__link head-type"> generic </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#systemfields title=systemFields class="md-nav__link head-type"> systemFields </a> </li> <li class=md-nav__item> <a href=#table-defaults title="Table defaults" class="md-nav__link head-type"> Table defaults </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#title title=title class="md-nav__link head-type"> title </a> </li> <li class=md-nav__item> <a href=#item title=item class="md-nav__link head-type"> item </a> </li> <li class=md-nav__item> <a href=#sort title=sort class="md-nav__link head-type"> sort </a> </li> <li class=md-nav__item> <a href=#fieldorder title=fieldOrder class="md-nav__link head-type"> fieldOrder </a> </li> <li class=md-nav__item> <a href=#fieldspecs title=fieldSpecs class="md-nav__link head-type"> fieldSpecs </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#valtype title=valType class="md-nav__link head-type"> valType </a> </li> <li class=md-nav__item> <a href=#select title=select class="md-nav__link head-type"> select </a> </li> <li class=md-nav__item> <a href=#fixed title=fixed class="md-nav__link head-type"> fixed </a> </li> <li class=md-nav__item> <a href=#inactive title=inactive class="md-nav__link head-type"> inactive </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#listing-related-records title="Listing related records" class="md-nav__link head-type"> Listing related records </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tables title=tables class="md-nav__link head-type"> tables </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#filters title=filters class="md-nav__link head-type"> filters </a> </li> <li class=md-nav__item> <a href=#details-and-detailorder title="details and detailOrder" class="md-nav__link head-type"> details and detailOrder </a> </li> <li class=md-nav__item> <a href=#needmaster title=needMaster class="md-nav__link head-type"> needMaster </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#permission-model title="Permission model" class="md-nav__link head-type"> Permission model </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#groups title=Groups class="md-nav__link head-type"> Groups </a> </li> <li class=md-nav__item> <a href=#levels title=Levels class="md-nav__link head-type"> Levels </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#authorize title=Authorize class="md-nav__link head-type"> Authorize </a> </li> <li class=md-nav__item> <a href=#methods title=Methods class="md-nav__link head-type"> Methods </a> </li> <li class=md-nav__item> <a href=#actions title=Actions class="md-nav__link head-type"> Actions </a> </li> <li class=md-nav__item> <a href=#tables-and-fields title="Tables and Fields" class="md-nav__link head-type"> Tables and Fields </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/dans-labs/dariah/edit/master/docs/Concepts/Model.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=model>Model<a class=headerlink href=#model title="Permanent link">&para;</a></h1> <p>This application contains a generic engine to display MongoDB data according to any specified data model, respecting access privileges.</p> <h2 id=mongodb>MongoDB<a class=headerlink href=#mongodb title="Permanent link">&para;</a></h2> <p>We store the data in a <a href=https://docs.mongodb.com>MongoDB</a>. A MongoDB does not work with a fixed schema. A MongoDB <em>collection</em> consists of <em>documents</em>, which are essentially JSON-like structures, arbitrarily large and arbitrarily nested. That makes it easy to add new kinds of data to documents and collections when the need arises to do so. This will not break the existing code.</p> <p>MongoDB is optimized to read quickly, at the cost of more expensive data manipulation operations. Its documentation favours storing related data inside the main document. This increases the redundancy of the data and may lead to consistency problems, unless the application tries to enforce consistency somehow.</p> <p>In this app, with a limited amount of data, we use MongoDB primarily for its flexibility. We still adhere largely to SQL-like practices when we deal with related tables. So instead of storing the information of related records directly inside the main record, we only store references to related records inside the main records.</p> <h2 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link">&para;</a></h2> <p>The <a href=/models/model.yaml>model</a> and the files in <a href=/models/tables>table</a> are YAML configuration files, and by tweaking them you can achieve a lot of customization.</p> <h3 id=name-handling>Name handling<a class=headerlink href=#name-handling title="Permanent link">&para;</a></h3> <p>There are a lot of names in these yaml files. The most obvious way to use them in our programs (Python on the server, JavaScript on the client) is by just mentioning them as strings, e.g.:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=n>title</span> <span class=o>=</span> <span class=n>DM</span><span class=p>[</span><span class=s1>&#39;tables&#39;</span><span class=p>][</span><span class=s1>&#39;permissionGroup&#39;</span><span class=p>][</span><span class=s1>&#39;title&#39;</span><span class=p>]</span>
</pre></div> </td></tr></table> <p>and</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nx>title</span> <span class=o>=</span> <span class=nx>DM</span><span class=p>.</span><span class=nx>tables</span><span class=p>.</span><span class=nx>permissionGroup</span><span class=p>.</span><span class=nx>title</span>
</pre></div> </td></tr></table> <p>or</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>const</span> <span class=p>{</span> <span class=nx>tables</span><span class=o>:</span> <span class=p>{</span> <span class=nx>permissionGroup</span><span class=o>:</span> <span class=p>{</span> <span class=nx>title</span> <span class=p>}</span> <span class=p>}</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>DM</span>
</pre></div> </td></tr></table> <p>But then the question arises: how can we use these names in our programs in such a way that we are protected agains typos?</p> <p>Well, we convert the <code>.yaml</code> model files to Python modules that expose the same model, but now as Python data structure. This is done by means of the <a href=https://github.com/Dans-labs/dariah/blob/master/server/compile.py>compile.py</a> script, just before starting the server. That enables us to collect the names and generate some code. Every part of the <code>.yaml</code> files that may act as a name, is collected. We generate a module <a href=https://github.com/Dans-labs/dariah/blob/master/server/models/names.py>names.py</a> that contains a line</p> <p><code>N_</code><em>name</em> <code>= '</code><em>name</em><code>'</code></p> <p>This module of names will be imported whenever the models are imported. So whenever we want to refer to a name in one of the models, we have a Python variable in our name space that is equal to that name prepended with <code>N_</code>. By consequently using <code>N_</code><em>names</em> instead of plain strings, we guard ourselves against typos, because the Python parser will complain about undefined variables.</p> <p>Moreover, the same <a href=https://github.com/Dans-labs/dariah/blob/master/server/compile.py>compile.py</a> module also checks all the code in the controllers directory for names:</p> <ul> <li>whether every <code>N_</code><em>name</em> is defined in the <code>names.py</code> and</li> <li>if there are occurrences of plain strings for which an <code>N_</code><em>name</em> is defined.</li> </ul> <p>This solves the case for the Python server code.</p> <p>For the client JavaScript code we do not have such measures. We could do the same approach, but that would severely uglify the code:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nx>title</span> <span class=o>=</span> <span class=nx>DM</span><span class=p>[</span><span class=nx>N_tables</span><span class=p>][</span><span class=nx>N_permissionGroup</span><span class=p>][</span><span class=nx>N_title</span><span class=p>]</span>
</pre></div> </td></tr></table> <p>or</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>const</span> <span class=p>{</span> <span class=p>[</span><span class=nx>N_tables</span><span class=p>]</span><span class=o>:</span> <span class=p>{</span> <span class=p>[</span><span class=nx>N_permissionGroup</span><span class=p>]</span><span class=o>:</span> <span class=p>{</span> <span class=p>[</span><span class=nx>N_title</span><span class=p>]</span><span class=o>:</span> <span class=nx>title</span> <span class=p>}</span> <span class=p>}</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>DM</span>
</pre></div> </td></tr></table> <p>Especially the replacement of</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=p>{</span>
  <span class=nx>name</span>
<span class=p>}</span>
</pre></div> </td></tr></table> <p>by</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=p>{</span> <span class=p>[</span><span class=nx>N_name</span><span class=p>]</span><span class=o>:</span> <span class=nx>name</span> <span class=p>}</span>
</pre></div> </td></tr></table> <p>really hurts. So we do not do anything here, and rely on debugging away the typos the hard way.</p> <h2 id=data-model>Data model<a class=headerlink href=#data-model title="Permanent link">&para;</a></h2> <p>The data model consists of the dictionaries <em>generic</em>, <em>custom</em> and <em>tables</em>.</p> <p>The <em>generic</em> dictionary contains field names that are used in many tables, such as <code>dateCreated</code>.</p> <p>The <em>custom</em> dictionary is a list of names used in custom workflows, such as defined in <a href=/controllers/workflow.py>workflow</a> (see also <a href=Workflow>Workflow</a>.</p> <p>The <em>tables</em> dictionary has a key for each table, and contains all model information that the application needs to work with that table.</p> <p>Here is a description of the table model information.</p> <h3 id=generic><code>generic</code><a class=headerlink href=#generic title="Permanent link">&para;</a></h3> <p>Most branches of the <em>generic</em> dictionary are lists of names with the purpose of triggering the creation of a <code>N_</code><em>name</em>, so that we can refer to those names in a consistent way.</p> <p>A few branches will actually be used as such by the app.</p> <h4 id=systemfields><code>systemFields</code><a class=headerlink href=#systemfields title="Permanent link">&para;</a></h4> <p>A list of field names that occur in most records. The fields themselves must still be specified in the tables where they occur, including their types.</p> <h4 id=table-defaults>Table defaults<a class=headerlink href=#table-defaults title="Permanent link">&para;</a></h4> <p>Here are the branches under <code>generic</code> that contain defaults for the table specifications.</p> <h5 id=title><code>title</code><a class=headerlink href=#title title="Permanent link">&para;</a></h5> <p>The name of the field that will be used as title when a records are listed.</p> <h5 id=item><code>item</code><a class=headerlink href=#item title="Permanent link">&para;</a></h5> <p>A display name by which we call individual entities, with a value for singular and plural. E.g. for the table <code>country</code> we have as item: <code>country</code> and <code>countries</code>.</p> <h5 id=sort><code>sort</code><a class=headerlink href=#sort title="Permanent link">&para;</a></h5> <p>A list of sort keys. A sort key is a pair consisting of a field, and a direction (-1: descending, 1: ascending).</p> <h5 id=fieldorder><code>fieldOrder</code><a class=headerlink href=#fieldorder title="Permanent link">&para;</a></h5> <p>A list of the fields, in the order by which will we displayed when the interface presents a record.</p> <h5 id=fieldspecs><code>fieldSpecs</code><a class=headerlink href=#fieldspecs title="Permanent link">&para;</a></h5> <p>A dictionary of the fields and their characteristics, needed to accommodate the display and manipulation of its values.</p> <p>A field spec is a dictionary, keyed by field name. A field spec value may contain the following bits of information:</p> <ul> <li><code>label</code>: a user-friendly display name of the field.</li> <li><code>multiple</code>: whether there is only one value allowed for this field, or a list of values.</li> <li><code>valType</code>: the type of the field and its other behavioural characteristics: see the section <strong>valType</strong> below.</li> <li><code>grid</code>: this is a branch of settings relevant for laying out the table in a grid. They are the CSS <a href>flex</a> attributes. <code>width</code>: the intended width of the column in which this field is presented; <code>grow</code> (<em>optional: default:</em> <code>0</code>) the degree by which the column width is allowed to increase <code>shrink</code> (<em>optional: default:</em> <code>0</code>) the degree by which the column width is allowed to decrease.</li> <li> <p><code>valid</code>: the name of a client-side validation function by which new and modified values for this field are validated. The validators are exposed in <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/fields.js>fields.js</a> as member functions of a <code>validation</code> object.</p> <p><strong>N.B:</strong> the server carries out extensive, non-customizable validation as well, in order to protect the integrity of the database.</p> </li> </ul> <h6 id=valtype><code>valType</code><a class=headerlink href=#valtype title="Permanent link">&para;</a></h6> <p>If a field contains an explicit value or list of values, i.e. a value that stands on its own and does not refer to other records, <code>valType</code> is just a string that specifies the type of the field. If the field may contain a list of values, <code>valType</code> specifies the type of a single value.</p> <p>Possible types are:</p> <ul> <li><code>bool</code>: <code>true</code> or <code>false</code>.</li> <li><code>datetime</code>: a date time, mostly represented in its <a href=https://en.wikipedia.org/wiki/ISO_8601>ISO 8601</a> format.</li> <li><code>number</code>: an integer or real number.</li> <li><code>text</code>: a string of characters, usually just a one-liner.</li> <li><code>url</code>: a syntactically valid URL: i.e. a string of text that can be interpreted as a URL. A validation routine will check this.</li> <li><code>email</code>: a syntactically valid email address. A validation routine will check this.</li> <li><code>textarea</code>: a string of characters, which may extend to several pages. It is assumed that this is Markdown text, and its formatted version will be shown on the interface, see <a href=Components#markdownarea>MarkdownArea</a>.</li> </ul> <p>When a field refers to other records, there is much more to specify. In this case <code>valType</code> is a branch with the following information.</p> <ul> <li><code>relTable</code>: the table that contains the related records;</li> <li><code>allowNew</code>: whether the user is allowed to enter new records in the related table;</li> <li><code>popUpIfEmpty</code>: (<em>optional: default:</em> <code>false</code>) if an edit view on a record having an empty value for this field is shown, a widget to choose a value will pop up immediately. Otherwise there will be just a control button, inviting you to enter a value.</li> <li><code>select</code>: a criterion on records in the related table, see section <strong>select</strong> below;</li> <li><code>fixed</code> (<em>optional, default:</em> <code>false</code>) whether the value of this field is fixed after it has been assigned initially; see section <strong>fixed</strong> below.</li> <li><code>inactive</code>: (<em>optional</em>) this field relates to custom presentations, defined in <a href=Workflow>Workflow</a>; see section <strong>inactive</strong> below.</li> </ul> <h6 id=select><code>select</code><a class=headerlink href=#select title="Permanent link">&para;</a></h6> <p>Only the records that satisfy the criterion specified in <code>select</code>, are allowed values. The criterion may be an arbitrary MongoDb selction constraint.</p> <p><strong>Example 1:</strong> the <code>country</code> field in the <code>contrib</code> table has <code>isMember: true</code>. So when we choose a country for a contribution, we will be presented with a choice between those countries that are a member of DARIAH.</p> <p><strong>Example 2:</strong> the <code>reviewerE</code> field in the <code>assessment</code> table points to the user table, but it has a <code>select</code> condition:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="l l-Scalar l-Scalar-Plain">authority</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">$ne</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">legacy</span>
</pre></div> </td></tr></table> <p>That means, only users for which the <code>authority</code> field is not <code>legacy</code> can be chosen as reviewer.</p> <h6 id=fixed><code>fixed</code><a class=headerlink href=#fixed title="Permanent link">&para;</a></h6> <p>A fixed field can be assigned a value, and after that it is frozen. If a field is fixed, the user interface will be informed to not provide edit controls for it, and the server will be instructed not to modify this field.</p> <p><strong>Example:</strong> When an assessment record is created for a contribution, its field <code>assessmentType</code> is copied from the <code>typeContribution</code> field of the master <code>contribution</code> record. Based on that, a fixed set of <code>criteriaEntry</code> records are assembled as details to the <code>assessment</code> record. If the contribution type is changed in a later stage, the <code>assessmentType</code> still shows the type on which the assembly of <code>criteriaEntry</code> records is based. We cannot change these records, because the user may have entered data in it. If the contribution really needs an other type, the best way to proceed is to create a new blank assessment, copy the relevant information over from the old assessment, and then remove the old assessment.</p> <h6 id=inactive><code>inactive</code><a class=headerlink href=#inactive title="Permanent link">&para;</a></h6> <p>By some definition, certain records can be marked as <em>inactive</em>. <code>inactive</code> is a branch with settings how to present inactive items:</p> <ul> <li><code>disabled</code>: if true, do not present inactive items in choice widgets: so if you modify the value, you cannot choose inactive values.</li> <li><code>attributes</code>: e.g. a CSS <code>className</code> and a <code>title</code> attribute (tooltip) that will be put on the element that renders the item. Any set of valid attributes will do, there are no additional constraints.</li> </ul> <p><strong>Example:</strong> The <code>typeContribution</code> field of a <code>contrib</code> record may be obsolete, because it is not specified in the current package (see <a href=Workflow>Workflow</a>. In the <code>valType</code> for this field we see the following specification:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class="l l-Scalar l-Scalar-Plain">inactive</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">attributes</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">className</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">inactive</span>
    <span class="l l-Scalar l-Scalar-Plain">disabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div> </td></tr></table> <p>This is the rendered HTML for this value:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=p>&lt;</span><span class=nt>a</span>
    <span class=na>href</span><span class=o>=</span><span class=s>&quot;/data/typeContribution/list/item/00000000cca4bbd9fe00000b&quot;</span>
    <span class=na>class</span><span class=o>=</span><span class=s>&quot;tag disabled inactive&quot;</span>
<span class=p>&gt;</span>Tools and Software<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</pre></div> </td></tr></table> <h5 id=listing-related-records>Listing related records<a class=headerlink href=#listing-related-records title="Permanent link">&para;</a></h5> <p>When we need to show a related record as a single value, we use its title field, as specified by its <code>title</code> entry in the table info, if present, otherwise we look it up from the generic branch. However, the client code may have implemented special code for certain tables, such as <code>user</code>, and <code>country</code>. See <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/app/dux/table.js>repCountry and repUser</a>. Note, that in many cases, the related table is a <em>value list</em>: every record consists of an <code>_id</code> field (the standard MongoDB identifier field) and a field called <code>rep</code>, which contains the representation of the value. Value lists may or may not have table information specified. The default table information in <code>generic</code> is such that the value lists are covered by it.</p> <p><strong>N.B.</strong> In all cases, the permissions model is also consulted, because the permissions model has a say in which fields are allowed to reach the client. For example, if a non-authenticated user is shown the creator of a record, (s)he sees information from the <code>user</code> table. But the permissions are such that (s)he may not see the email address of that user. So the email address does not even reach the client.</p> <h3 id=tables><code>tables</code><a class=headerlink href=#tables title="Permanent link">&para;</a></h3> <p>For every table we specify its fields, filters, details and a few other attributes. We have already seen branches under <code>generic</code> for the default specification. The specific tables may have these branches too, with table-specific values. There are some more.</p> <h4 id=filters><code>filters</code><a class=headerlink href=#filters title="Permanent link">&para;</a></h4> <p>A list of filters by which to constrain the set of records to be displayed. There are <em>fulltext</em> filters and <em>faceted</em> filters.</p> <p>Each filter is a dictionary with the following information.</p> <ul> <li><code>field</code> The name of the field to be filtered.</li> <li><code>relField</code> (<em>optional</em>) If <code>field</code> is an identifier pointing to a related table, the <code>relField</code> specifies which field in the related table should be filtered. For example, if you want to filter <code>criteriaEntry</code> records on there <code>score</code>, you are faced with the fact that scores live in a separate table, and the actual score is contained in the field <code>score</code> of that table. The <code>criteriaEntry</code> records contain just an <code>_id</code> into the table <code>score</code>. Hence, if we want to filter on actual scores, we say <code>field: score</code> and <code>relField: score</code>.</li> <li><code>label</code> A user friendly name for the filter, usually the label of the field to be filtered.</li> <li><code>type</code> The type of filter: <code>ByValue</code>: faceted, <code>EUMap</code>: faceted, plus a visualisation on the map of Europe, <code>Fulltext</code>: full text search in the field.</li> <li><code>maxCols</code>: (<em>not needed for <code>Fulltext</code> filters</em>) facets are displayed in a table with at most this amount of columns.</li> <li><code>expanded</code>: (<em>not needed for <code>Fulltext</code> filters</em>) whether the table of facets is initially expanded or collapsed.</li> </ul> <h4 id=details-and-detailorder><code>details</code> and <code>detailOrder</code><a class=headerlink href=#details-and-detailorder title="Permanent link">&para;</a></h4> <p>A record may have <em>detail records</em> associated with it. We call such a record a <em>master record</em> with respect to its details. Details are records, usually in another table, having a field that points to their master record by means of an <code>_id</code> value.</p> <p>A master record may have multiple kinds of detail records, i.e. detail records from several distinct tables. It is also possible to specify multiple kinds from one and the same originating table. The kind is specified by just a tag, which often is the name of the originating table.</p> <p>When a master record is presented in full view, all of its fields are expanded with their values. Below that there are lists of head lines of detail records, sorted by table where they are from.</p> <p>The order of these kinds is specified in <code>detailOrder</code>.</p> <p>The specification of each kind of detail is specified in the branch <code>details</code>. For each originating kind there is the following information:</p> <ul> <li><code>table</code> The name of the originating table;</li> <li><code>linkField</code> The name of the field in the originating table that links to the master record;</li> <li><code>mode</code> The display mode of the detal records: as grid or list;</li> <li><code>filtered</code> whether the detais of this kind should have filter controls. If yes, the filters are taken from the specification of the originating table.</li> <li><code>expand</code> (<em>optional, default:</em> <code>false</code>) If this is true, the all detail records of this kind will be immediately expanded. Normally, detail records are presented as head lines initially.</li> <li><code>border</code> (<em>optional, default:</em> <code>read: true, edit: true</code>) whether to put a border around each individual detail record of this kind. This feature must be specified for the read-only presentation and the editable presentation separately, by means of the keys <code>read</code> and <code>edit</code>.</li> <li> <p><code>cascade</code> (<em>optional, default:</em> <code>false</code>) when the master record is deleted, its details have a dangling reference to a non-existing master record. In some cases it is desirable to delete the detail records as well. If <code>cascade: true</code>, the detail records of this kind will be deleted together with the master record.</p> <p><strong>Example 1:</strong> the <code>criteriaEntry</code> detail records are deleted with their master <code>assessment</code> record.</p> <p><strong>Example 2:</strong> the <code>criteria</code> detail records are <em>not</em> deleted with their master <code>package</code> record.</p> </li> <li> <p><code>fixed</code> (<em>optional, default:</em> <code>false</code>) whether the list of details of this kind is fixed. Details of a kind are fixed, if, after having been created, no details may be added or removed. Individual details may still be modified.</p> <p><strong>Example:</strong> once an <code>assessment</code> record for a contribution has been created, a special <a href=Workflow>workflow</a> takes care to lookup the list of criteria that apply to this contribution, based on its <code>typeContribution</code> field. (This mapping is read from the <code>criteria</code> detail records of the currently active <code>package</code> records). For each criterion a <code>criteriaEntry</code> detail record is added to the master <code>assessment</code> record. After that, the list of <code>criteriaEntries</code> for this <code>assessment</code> record may not change anymore. But the user is still be able to fill out the <code>criteriaEntry</code> records.</p> </li> </ul> <h4 id=needmaster><code>needMaster</code><a class=headerlink href=#needmaster title="Permanent link">&para;</a></h4> <p><em>optional: default:</em> <code>false</code>. Some tables act as containers for detail records exclusively, and it makes no sense to create a detail record if there is no master record to point to. If that is the case, specify <code>needMaster: true</code>, otherwise, leave it out.</p> <p>If <code>needMaster: true</code>, there will be no plus button (insert item) when the records are displayed as a main list. Only when they are displayed as a list of details to some master record, the plus button will appear.</p> <p><strong>Example 1:</strong> <code>assessment</code>s can only be created as detail of a <code>contribution</code>.</p> <p><strong>Example 2:</strong> <code>package</code>s can be seen as details of <code>typeContribution</code>, in the sense that for each contribution type, there is a list of packages to tell when that contribution type was valid and which criteria were associated with it. Yet a package record makes sense on its own. When you create it, you do not have to select a contribution type first. Rather, you create a package, and in its <code>typeContribution</code> field you select a number of contribution types.</p> <h2 id=permission-model>Permission model<a class=headerlink href=#permission-model title="Permanent link">&para;</a></h2> <p>The authorization system is built on the basis of <em>permission</em> levels.</p> <p>Users are assigned to groups, which determine their permission level. In practice, we identify the concepts of <em>groups</em> and <em>permission levels</em>.</p> <p>Users may call <em>methods</em> which undertake <em>actions</em> on tables and fields.</p> <p>These actions are authorized to happen on behalf of a certain user if the permission level of the user, is at least the permission level that the thing requires for that action.</p> <p>In some cases, the identity of the user is relevant, namely when users want to modify things they themselves have created. For those things, users are in a pseudo group called <em>own</em>.</p> <p>In yet other cases, when users change the permission levels of users, the permission levels of both users need to be taken into account.</p> <p>Here are the details.</p> <h3 id=groups>Groups<a class=headerlink href=#groups title="Permanent link">&para;</a></h3> <p>The following groups are distinguished, from least powerful to most powerful:</p> <ul> <li><code>public</code>: unauthenticated user</li> <li><code>auth</code>: authenticated user</li> <li><code>office</code>: management user</li> <li><code>system</code>: system administrator</li> <li><code>root</code>: root access</li> </ul> <h3 id=levels>Levels<a class=headerlink href=#levels title="Permanent link">&para;</a></h3> <p>Things may require the following access levels, from least powerful to most powerful:</p> <ul> <li><code>public</code></li> <li><code>auth</code></li> <li><code>own</code>: authenticated user and creator of records in question</li> <li><code>OWN</code>: idem, cannot be overridden by higher levels</li> <li><code>ownLT</code>: only if owner's power is less than editor's power</li> <li><code>office</code></li> <li><code>system</code></li> <li><code>root</code></li> <li><code>nobody</code>: omnipotent access (however: nobody can be member of this group, so this effectively means: nobody is allowed to do this)</li> </ul> <p>The difference between <em>own</em> and <em>OWN</em> is subtle and only relevant for groups more powerful than <em>own</em>. If a thing requires level <em>own</em>, but the user is in a more powerful group, such as <em>system</em>, that user has access to the thing, even if it is not his own thing.</p> <p>In some circumstances this is undesirable. For example if you want to show a user a list of <em>My items</em>, we want to show the items this user owns, not the items he is allowed to change. In such a case, we specify level <em>OWN</em> for <em>My items</em>.</p> <p>The level <em>ownLT</em> is only relevant when one user modifies the group of another user. The level <em>ownLT</em> means that this operation is only permitted if the user that undergoes modification is currently less powerful than the user that performs the modification.</p> <h4 id=authorize>Authorize<a class=headerlink href=#authorize title="Permanent link">&para;</a></h4> <p>A table which specify the power of each group over each level that a thing may require. It is a dictionary of dictionaries: the first key is the user group, the second key is the level of the thing.</p> <p>If the dictionary of a user group does not contain a key for a certain level, then the users in that group have no power to do that things that require that level.</p> <p>Otherwise the value is either 1, -1, or -2, meaning:</p> <ul> <li><code>1</code> : access is to be granted.</li> <li><code>-1</code> : access is only to be granted if the thing has been created by the user.</li> <li><code>-2</code> : access is only to be granted if the relative group levels work out:<ul> <li>like <em>ownLT</em> above: users cannot modify the power of more powerful users</li> <li>and users cannot assign more power (to themselves or others) than they themselves have.</li> </ul> </li> </ul> <h4 id=methods>Methods<a class=headerlink href=#methods title="Permanent link">&para;</a></h4> <p>If a user needs to do something, (s)he interacts with the user interface at the client. That will lead to an API call to the server, which will translate into the invocation of a <em>method</em>. At that point, the first check will be made: is this user allowed to invoke this method? The check is performed on the basis of the methods table, which is a dictionary of method names. For each method name a description is given, and the level required to invoke that method.</p> <p>Currently we have the following methods:</p> <ul> <li><code>mylist</code> get my items from a list</li> <li><code>list</code> get all items from a list</li> <li><code>view</code> get the details of a record</li> <li><code>mod</code> modify the details of a record, or insert/delete a record</li> </ul> <h4 id=actions>Actions<a class=headerlink href=#actions title="Permanent link">&para;</a></h4> <p>Methods give rise to <em>actions</em>. We distinguish:</p> <ul> <li><code>insert</code>: create an item</li> <li><code>list</code>: read item titles</li> <li><code>read</code>: read items</li> <li><code>update</code>: update an item</li> <li><code>delete</code>: delete an item.</li> </ul> <p>Note the difference between <code>read</code> and <code>list</code>. An item may allow <code>list</code> to <em>public</em> but not <code>read</code>. In that case, unauthenticated user may see the list of items, usually their titles, but they cannot drill down to see the full details of records.</p> <h4 id=tables-and-fields>Tables and Fields<a class=headerlink href=#tables-and-fields title="Permanent link">&para;</a></h4> <p>For every table and every field in it, we specify an access level. That means: for every action on that field we state the required access level.</p> <p>The authorization logic on tables then works like this:</p> <ol> <li>the access level for invoking the method is checked;</li> <li>if allowed, the actions and tables that the method is going to perform are considered;</li> <li>for every (table-action) combination a row filter and a field filter is constructed, restricting the action to only those rows and fields that are permitted to the user; this might be an empty set;</li> <li>if the set is not empty, the action is executed on those rows and those fields that pass the filters.</li> </ol> <p>The permissions model has a configuration section for tables as a whole, which will be checked first. This will give rise to the row filter.</p> <p>Then there is also a configuration section for all fields in all tables, which will give rise to the field filter.</p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../Architecture/ title=Architecture class="md-flex md-footer-nav__link md-footer-nav__link--prev head-type" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> Architecture </span> </div> </a> <a href=../Routing/ title=Routing class="md-flex md-footer-nav__link md-footer-nav__link--next head-type" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> Routing </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> customised by <a href=https://github.com/Dans-labs>Dans-labs</a> </div> <div class=md-footer-dans> <div>DANS is an institute of KNAW and NWO</div> <div> <a href=https://dans.knaw.nl/en title="Data Archiving and Networked Services (DANS)"><img class=md-footer-dans__img src=../../assets/images/DANS.gif height=50></a> <a target=_blank href=https://www.knaw.nl/en><img src=../../assets/images/knaw.png height=50></a> <a target=_blank href=https://www.nwo.nl/en><img src=../../assets/images/nwo.png height=50></a> </div> <div><i>Driven by data</i></div> </div> <link rel=stylesheet href=../../assets/fonts/font-awesome.css> <ul class=md-footer-social> <li class=md-footer-social__li> <a href=http://eepurl.com/dvnr8D class="md-footer-social__link fa fa-envelope-square"> <span class=md-footer-social__desc>Newsletter</span> </a> </li> <li class=md-footer-social__li> <a href=https://twitter.com/DANSKNAW class="md-footer-social__link fa fa-twitter-square"> <span class=md-footer-social__desc>Twitter</span> </a> </li> <li class=md-footer-social__li> <a href=https://www.youtube.com/user/DANSDataArchiving class="md-footer-social__link fa fa-youtube-square"> <span class=md-footer-social__desc>YouTube</span> </a> </li> <li class=md-footer-social__li> <a href=https://www.linkedin.com/company/dans class="md-footer-social__link fa fa-linkedin-square"> <span class=md-footer-social__desc>LinkedIn</span> </a> </li> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.6152a718.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> </body> </html>