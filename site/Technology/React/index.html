<!doctype html><html lang=en class=no-js> <head><link href=https://fonts.gstatic.com rel=preconnect crossorigin><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="The technical documentation of the DARIAH Contribution Tool. Design, specs, rationales, patterns, diagrams.
"><link href=https://dans-labs.github.io/dariah/Technology/React/ rel=canonical><meta name=author content="Dirk Roorda"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../icons/favicon.ico><meta name=generator content="mkdocs-1.0.4, mkdocs-dans-4.4.1"><title>React - Tech Doc DARIAH contribution tool</title><link rel=stylesheet href=../../assets/stylesheets/application.27a306a7.css><script src=../../assets/javascripts/modernizr.74668098.js></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,700|Glegoo:300,400,400i,700|Ubuntu+Mono&display=swap"><style>.body-type,body,input{font-family:"Open Sans",sans-serif}.head-type,h1,h2,h3,h4,h5{font-family:"Glegoo",serif}.code-type,code,kbd,pre{font-family:"Ubuntu Mono",monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css></head> <body dir=ltr> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#react tabindex=1 class=md-skip> Skip to content </a> <header class="md-header md-dev" data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://www.dariah.eu title=DARIAH class="md-header-nav__button md-logo"> <img src=../../images/dariah.png height=50> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://dans-labs.github.io/dariah/ title="Tech Doc DARIAH contribution tool" class="md-header-nav__button md-logo"> <img src=../../images/inkind_logo.png height=50> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title head-type" data-md-component=title> <span class=md-header-nav__topic> Tech Doc DARIAH contribution tool <span class="md-dev-inline head-type"> still in beta </span> </span> <span class=md-header-nav__topic> React <span class="md-dev-inline head-type"> still in beta </span> </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/dans-labs/dariah/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> Dans-labs/dariah </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. title=Home class="md-tabs__link head-type"> Home </a> </li> <li class=md-tabs__item> <a href=../../About/Codebase/ title=About class="md-tabs__link head-type"> About </a> </li> <li class=md-tabs__item> <a href=../../Functionality/Business/ title=Functionality class="md-tabs__link head-type"> Functionality </a> </li> <li class=md-tabs__item> <a href=../../Legacy/Content/ title=Legacy class="md-tabs__link head-type"> Legacy </a> </li> <li class=md-tabs__item> <a href=../../Concepts/Architecture/ title=Concepts class="md-tabs__link head-type"> Concepts </a> </li> <li class=md-tabs__item> <a href=../../Server/Authentication/ title=Server class="md-tabs__link head-type"> Server </a> </li> <li class=md-tabs__item> <a href=../../Client/Components/ title=Client class="md-tabs__link head-type"> Client </a> </li> <li class=md-tabs__item> <a href=../Tech/ title=Technology class="md-tabs__link md-tabs__link--active head-type"> Technology </a> </li> <li class=md-tabs__item> <a href=../../Integration/API/ title=Integration class="md-tabs__link head-type"> Integration </a> </li> <li class=md-tabs__item> <a href=../../Maintenance/Deploy/ title=Maintenance class="md-tabs__link head-type"> Maintenance </a> </li> </ul> </div> </nav> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title head-type md-nav__title--site" for=__drawer> <a href=https://dans-labs.github.io/dariah/ title="Tech Doc DARIAH contribution tool" class="md-nav__button md-logo"> <img src=../../images/inkind_logo.png width=48 height=48> </a> Tech Doc DARIAH contribution tool </label> <div class=md-nav__source> <a href=https://github.com/dans-labs/dariah/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> Dans-labs/dariah </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Home class="md-nav__link head-type"> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class="md-nav__link head-type" for=nav-2> About </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-2> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../About/Codebase/ title=Codebase class="md-nav__link head-type"> Codebase </a> </li> <li class=md-nav__item> <a href=../../About/Stats/ title=Stats class="md-nav__link head-type"> Stats </a> </li> <li class=md-nav__item> <a href=../../About/News/ title=News class="md-nav__link head-type"> News </a> </li> <li class=md-nav__item> <a href=../../About/Lessons/ title=Lessons class="md-nav__link head-type"> Lessons </a> </li> <li class=md-nav__item> <a href=../../About/Diagrams/ title=Diagrams class="md-nav__link head-type"> Diagrams </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class="md-nav__link head-type" for=nav-3> Functionality </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-3> Functionality </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Functionality/Business/ title=Business class="md-nav__link head-type"> Business </a> </li> <li class=md-nav__item> <a href=../../Functionality/Tables/ title=Tables class="md-nav__link head-type"> Tables </a> </li> <li class=md-nav__item> <a href=../../Functionality/Workflow/ title=Workflow class="md-nav__link head-type"> Workflow </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class="md-nav__link head-type" for=nav-4> Legacy </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-4> Legacy </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Legacy/Content/ title=Content class="md-nav__link head-type"> Content </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class="md-nav__link head-type" for=nav-5> Concepts </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-5> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Concepts/Architecture/ title=Architecture class="md-nav__link head-type"> Architecture </a> </li> <li class=md-nav__item> <a href=../../Concepts/Model/ title=Model class="md-nav__link head-type"> Model </a> </li> <li class=md-nav__item> <a href=../../Concepts/Routing/ title=Routing class="md-nav__link head-type"> Routing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class="md-nav__link head-type" for=nav-6> Server </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-6> Server </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Server/Authentication/ title=Authentication class="md-nav__link head-type"> Authentication </a> </li> <li class=md-nav__item> <a href=../../Server/Server/ title=Server class="md-nav__link head-type"> Server </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class="md-nav__link head-type" for=nav-7> Client </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-7> Client </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Client/Components/ title=Components class="md-nav__link head-type"> Components </a> </li> <li class=md-nav__item> <a href=../../Client/Dux/ title=Dux class="md-nav__link head-type"> Dux </a> </li> <li class=md-nav__item> <a href=../../Client/Templates/ title=Templates class="md-nav__link head-type"> Templates </a> </li> <li class=md-nav__item> <a href=../../Client/Lib/ title=Lib class="md-nav__link head-type"> Lib </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8 type=checkbox id=nav-8 checked> <label class="md-nav__link head-type" for=nav-8> Technology </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-8> Technology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Tech/ title=Tech class="md-nav__link head-type"> Tech </a> </li> <li class=md-nav__item> <a href=../ES6/ title=ES6 class="md-nav__link head-type"> ES6 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active head-type" for=__toc> React </label> <a href=./ title=React class="md-nav__link md-nav__link--active head-type"> React </a> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title head-type" for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#components title=Components class="md-nav__link head-type"> Components </a> </li> <li class=md-nav__item> <a href=#processing-concepts title="Processing concepts" class="md-nav__link head-type"> Processing concepts </a> </li> <li class=md-nav__item> <a href=#property-management title="Property management" class="md-nav__link head-type"> Property management </a> </li> <li class=md-nav__item> <a href=#life-cycle title="Life cycle" class="md-nav__link head-type"> Life cycle </a> </li> <li class=md-nav__item> <a href=#controlled-component title="Controlled Component" class="md-nav__link head-type"> Controlled Component </a> </li> <li class=md-nav__item> <a href=#state title=State class="md-nav__link head-type"> State </a> </li> <li class=md-nav__item> <a href=#redux title=Redux class="md-nav__link head-type"> Redux </a> </li> <li class=md-nav__item> <a href=#merge title=Merge class="md-nav__link head-type"> Merge </a> </li> <li class=md-nav__item> <a href=#select title=Select class="md-nav__link head-type"> Select </a> </li> <li class=md-nav__item> <a href=#connect title=Connect class="md-nav__link head-type"> Connect </a> </li> <li class=md-nav__item> <a href=#routing title=Routing class="md-nav__link head-type"> Routing </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-9 type=checkbox id=nav-9> <label class="md-nav__link head-type" for=nav-9> Integration </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-9> Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Integration/API/ title=API class="md-nav__link head-type"> API </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-10 type=checkbox id=nav-10> <label class="md-nav__link head-type" for=nav-10> Maintenance </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-10> Maintenance </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Maintenance/Deploy/ title=Deploy class="md-nav__link head-type"> Deploy </a> </li> <li class=md-nav__item> <a href=../../Maintenance/Tests/ title=Tests class="md-nav__link head-type"> Tests </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title head-type" for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#components title=Components class="md-nav__link head-type"> Components </a> </li> <li class=md-nav__item> <a href=#processing-concepts title="Processing concepts" class="md-nav__link head-type"> Processing concepts </a> </li> <li class=md-nav__item> <a href=#property-management title="Property management" class="md-nav__link head-type"> Property management </a> </li> <li class=md-nav__item> <a href=#life-cycle title="Life cycle" class="md-nav__link head-type"> Life cycle </a> </li> <li class=md-nav__item> <a href=#controlled-component title="Controlled Component" class="md-nav__link head-type"> Controlled Component </a> </li> <li class=md-nav__item> <a href=#state title=State class="md-nav__link head-type"> State </a> </li> <li class=md-nav__item> <a href=#redux title=Redux class="md-nav__link head-type"> Redux </a> </li> <li class=md-nav__item> <a href=#merge title=Merge class="md-nav__link head-type"> Merge </a> </li> <li class=md-nav__item> <a href=#select title=Select class="md-nav__link head-type"> Select </a> </li> <li class=md-nav__item> <a href=#connect title=Connect class="md-nav__link head-type"> Connect </a> </li> <li class=md-nav__item> <a href=#routing title=Routing class="md-nav__link head-type"> Routing </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/dans-labs/dariah/edit/master/docs/Technology/React.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=react>React<a class=headerlink href=#react title="Permanent link">&para;</a></h1> <h2 id=components>Components<a class=headerlink href=#components title="Permanent link">&para;</a></h2> <p><a href=https://facebook.github.io/react/docs/react-component.html>React Components</a> represent pieces of the web page and their functionality.</p> <details class=abstract><summary>Building blocks</summary><p>Components are organized hierarchically.</p> <p>Components can be parametrized by <em>properties</em>, which parents pass to children.</p> <p>A component acts as a template instruction to build a piece of DOM.</p> <p>Components can be programmed as classes or as functions.</p> </details> <p>In this app we distinguish between three <em>capability levels</em> of components.</p> <details class=abstract><summary>Pure components</summary><p>If a component knows how to build the DOM, purely on the basis of its properties and a static template, it can be (and will be) coded as a pure function.</p> <p><a href=../../Client/Components/#stat>Example: Stat</a> .</p> </details> <details class=abstract><summary>Simple stateful components</summary><p>If a component needs to store the effects of the outside world (incoming server data or user interaction), it is stateful.</p> <p>If the component does not need <a href=#life-cycle>life cycle</a> methods, it can be programmed as a pure function that will be connected to the <a href=#redux>Redux</a> state by means of a simple binding: <a href=#connect>connect</a> .</p> <p><a href=../../Client/Components/#facet>Example: Facet</a> .</p> </details> <details class=abstract><summary>Complex components</summary><p>If a component has to handle the DOM after it has been constructed, e.g. apply some hiding and showing, fill a DIV with a third party component, or get data from the state in a sophisticated way, then we need to program the component as a class with so-called <a href=#life-cycle>life cycle methods</a> .</p> <p><a href=../../Client/Components/#bool3>Example: Bool3</a></p> <p><a href=../../Client/Components/#listcontainer>Example: ListContainer</a> .</p> </details> <h2 id=processing-concepts>Processing concepts<a class=headerlink href=#processing-concepts title="Permanent link">&para;</a></h2> <p>React renders updates to <a href=#components>components</a> very efficiently.</p> <p>The <a href=#life-cycle>render()</a> function is a template for a <a href=#processing-concepts>element fragment</a> , not the real <a href=#processing-concepts>DOM</a> .</p> <p>So, after an update, it is not costly to recompute the fragment for that component completely, because the DOM is not touched.</p> <details class=abstract><summary>Reconciliation</summary><p>Once the new fragment has been constructed, a clever, React-internal process called <strong>reconciliation</strong> is carried out.</p> <p>This computes the minimum number of update actions that have to be applied to the previous, real DOM incarnation of the component, to change it to match the new fragment.</p> </details> <details class=abstract><summary>MiniDOM</summary><p>A compact internal representation of the <a href=#processing-concepts>DOM</a> , made from React <em>elements</em>.</p> <p>A React element is an instance of the React Element class. In <strong>jsx</strong> you can refer to a React element just by saying</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span><span class=nx>foo</span><span class=o>&lt;</span><span class=err>/p&gt;</span>
</pre></div> </td></tr></table> <p>React elements reflect HTML elements, but you can mingle them with React components, which look nearly the same in <strong>jsx</strong>:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span>
    <span class=o>&lt;</span><span class=nx>NavLink</span> <span class=nx>to</span><span class=o>=</span><span class=s2>&quot;/data&quot;</span> <span class=o>&gt;</span><span class=nx>bar</span><span class=o>&lt;</span><span class=err>/NavLink&gt;</span>
<span class=o>&lt;</span><span class=err>/p&gt;</span>
</pre></div> </td></tr></table> </details> <details class=abstract><summary>DOM</summary><p>DOM is an abbreviation for <a href=https://developer.mozilla.org/en-US/docs/Web/API/document>Document Object Model</a> .</p> <p>The DOM is what the browser gets in memory once it has loaded an HTML document. One of the principal tasks of JavaScript in the browser is to manipulate this DOM.</p> <p>The DOM and its API are exceedingly bloated, hence DOM operations are slow, no matter how fast JavaScript currently is.</p> <p>This is one of the reasons that a niche for React exists, with its <a href=#processing-concepts>MiniDOM</a> .</p> </details> <details class=abstract><summary>Fragment</summary><p>A <a href=https://facebook.github.io/react/docs/fragments.html>fragment</a> is a mixture of properly nested React elements and components.</p> <p>It is part of the React's toolkit to manage DOM manipulations efficiently.</p> <p>See <a href=#processing-concepts>Reconciliation</a> .</p> </details> <h2 id=property-management>Property management<a class=headerlink href=#property-management title="Permanent link">&para;</a></h2> <details class=abstract><summary>PropTypes</summary><p><a href=https://facebook.github.io/react/docs/typechecking-with-proptypes.html>PropTypes</a> are a means to do type checking for React Components is done by <em>PropTypes</em>.</p> <details class=details><summary>Only in development mode</summary><p>PropType checking in react only happens in development mode. React checks whether the named props that are passed to a component correspond to the props declared. In addition, it performs a basic type check on the values inside those props.</p> </details> <details class=details><summary>We don't use them</summary><p>I find the <code>PropType</code> verbose, and no match for the otherwise clean and pleasant syntax of JSX.</p> <p>Additionally, most of the mistakes I make, do not reveal themselves as value type mistakes.</p> <p>On top it this all: declaring <code>PropTypes</code> forces you to repeat all the names of your properties, so is against the principle of <em>don't repeat yourself</em>.</p> <p>In this application, the property names are always clear in the code, either as</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>const</span> <span class=nx>MyComponent</span> <span class=o>=</span> <span class=p>({</span> <span class=nx>foo</span><span class=p>,</span> <span class=nx>bar</span> <span class=p>)}</span> <span class=p>=&gt;</span> <span class=p>...</span>
</pre></div> </td></tr></table> <p>or as</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>const</span> <span class=p>{</span> <span class=nx>props</span><span class=o>:</span> <span class=p>{</span> <span class=nx>foo</span><span class=p>,</span> <span class=nx>bar</span><span class=p>}</span> <span class=p>}</span> <span class=o>=</span> <span class=k>this</span>
</pre></div> </td></tr></table> </details> </details> <details class=abstract><summary>Context</summary><p><a href=https://facebook.github.io/react/docs/context.html>Context</a> is a React mechanism to pass data directly from ancestors to deep descendants.</p> <p>The React documentation considers context as a brittle part of itself, and warns against over-use.</p> <p>At the same time, <a href=#redux>Redux</a> depends critically on it, so I consider it safe to use.</p> <p>But our code will not use it explicitly, only through Redux.</p> </details> <h2 id=life-cycle>Life cycle<a class=headerlink href=#life-cycle title="Permanent link">&para;</a></h2> <p>The main function of a <a href=#components>component</a> is to act as a template to be <code>render()</code>ed.</p> <p>But if there is additional work to be done, this can be hooked up at various stages in the component's <a href=https://facebook.github.io/react/docs/react-component.html#the-component-lifecycle>life cycle</a> .</p> <details class=details><summary>Stages</summary><p>Most stages occur during (re)rendering, and there is a stage of construction and unmounting.</p> </details> <details class=abstract><summary>Constructor</summary><p>When a <a href=#components>component</a> is being <a href=https://facebook.github.io/react/docs/react-component.html#life-cycle>rendered</a> the <a href=https://facebook.github.io/react/docs/react-component.html#constructor>constructor</a> is the method to construct the corresponding React class.</p> <p>It will set up the <a href=#state>state</a> .</p> </details> <details class=abstract><summary>componentDidMount</summary><p>When a <a href=#components>component</a> has been added to the DOM its method <a href=https://facebook.github.io/react/docs/react-component.html#componentdidmount>componentDidMount</a> will be called just after.</p> <p>This is the recommended time to fetch data for this component, if needed.</p> </details> <details class=abstract><summary>componentDidUpdate</summary><p>When a <a href=#components>component</a> has been updated due to receiving new properties, its method <a href=https://facebook.github.io/react/docs/react-component.html#componentdidupdate>componentDidUpdate</a> will be called just after.</p> <p>If DOM manipulations are needed to complete the rendering, this is the place to do it.</p> <details class=note><summary>Not initially</summary><p>This will not called upon initial rendering.</p> <p>So if the DOM manipulation is also needed initially, it is handy to write a function for it and call it in this method and in <code>componentDidMount()</code> .</p> </details> </details> <details class=abstract><summary>componentWillMount</summary><p>When a <a href=#components>component</a> will be added to the DOM, its method <a href=https://facebook.github.io/react/docs/react-component.html#componentwillmount>componentWillMount</a> will be called just before.</p> <p>This is the first thing that happens after <code>constructor()</code> .</p> </details> <details class=abstract><summary>componentWillReceiveProps</summary><p>When a <a href=#components>component</a> is about to receive new props (as part of the update process), its method <a href=https://facebook.github.io/react/docs/react-component.html#componentwillreceiveprops>componentWillReceiveProps</a> will be called just before.</p> <p>The new props are passed with it, so that it is possible to execute actions dependent on whether pros have changed.</p> </details> <details class=abstract><summary>componentWillUnMount</summary><p>When a <a href=#components>component</a> will be removed from the DOM, its method <a href=https://facebook.github.io/react/docs/react-component.html#componentwillunmount>componentWillUnmount</a> will be called just before.</p> <p>If we want to save state, we can hook it up here.</p> </details> <details class=abstract><summary>render</summary><p>The main function of a <a href=#components>component</a> is to act as a template to be rendered.</p> <p>Its method <a href=https://facebook.github.io/react/docs/react-component.html#life-cycle>render</a> constructs the template to be rendered.</p> <p>During rendering the template will be used as a set of instructions to build a real DOM somewhere on the actual web page.</p> </details> <h2 id=controlled-component>Controlled Component<a class=headerlink href=#controlled-component title="Permanent link">&para;</a></h2> <p>For elements that can receive user input (forms, inputs, etc.) there is the option to handle input in a way controlled by React, and not by the default HTML behaviour.</p> <p>We say that those elements are used as <a href=https://facebook.github.io/react/docs/forms.html>controlled Components</a> .</p> <details class=explanation><summary>Mechanism</summary><p>So when a user clicks a checkbox, the check is not managed by the browser, but:</p> <ul> <li>a callback is called</li> <li>a parent component executes it</li> <li>the state gets updated</li> <li>the state change trickles down as property updates to child elements</li> <li>the checkbox in question is told by properties to be checked (or unchecked).</li> </ul> </details> <h2 id=state>State<a class=headerlink href=#state title="Permanent link">&para;</a></h2> <p>There are two main reasons for a component to maintain <a href=https://facebook.github.io/react/docs/state-and-lifecycle.html>state</a>:</p> <ul> <li>getting external data,</li> <li>reacting to user events.</li> </ul> <p>In both cases, something happens in the outside world that must be remembered.</p> <details class=abstract><summary>Local State</summary><p>Components remember events in their <a href=#state>state</a> , which only they can update.</p> <details class=explanation><summary>Trickle down through properties</summary><p>Components can compute derived data from their state and pass that as properties to their children.</p> <p>State updates trigger these computations automatically, and children whose properties are dependent on this state, are re-rendered automatically (and economically).</p> </details> <details class=abstract><summary>Vanilla React</summary><p>The vanilla React way is that <a href=#components>components</a> have their own state, which only they can modify through <a href=https://facebook.github.io/react/docs/react-component.html#setstate>setState</a> .</p> <p>Local state is very intuitive and leads to nice separation of concerns.</p> </details> <details class=details><summary>Lift state up</summary><p>But even in React, state is not completely local, because in many cases several components need to have access to the state.</p> <p>The preferred way of dealing with that is to lift state up to the nearest common ancestor of all components that need the state.</p> <p>Descendants that must modify ancestral state are passed a callback to do so.</p> </details> <details class=details><summary>Drawback of local state</summary><p>There comes a moment that components want to be informed of each other's state.</p> <p>Especially when components start modifying data from the server and saving it, other components that rely on the same data, want to be notified.</p> <p>Setting up ad-hoc communication between such components leads to an asynchronous dependency hell, which can be avoided by a central state as a single source of truth.</p> </details> </details> <details class=abstract><summary>Central State</summary><p>In this app, we have left the path of local state, and embraced <em>central state</em>.</p> <p>A widely used approach to <em>central</em> state is <a href=#redux>Redux</a> .</p> </details> <h2 id=redux>Redux<a class=headerlink href=#redux title="Permanent link">&para;</a></h2> <p><a href=https://redux.js.org>Redux</a> is a popular implementation of the idea that <a href=#state>state</a> is centralized and all components have to subscribe to a state <a href=https://react-redux.js.org/api/provider>Provider</a> , the store.</p> <details class=abstract><summary>Mechanism</summary><ul> <li>Components read slices of the state by means of <em>selectors</em>.</li> <li>If a component needs to update the state:<ul> <li>it dispatches an <em>action</em> to the store;</li> <li>so-called <em>reducers</em> translate the action into state updates;</li> <li>then the component is triggered to re-render.</li> </ul> </li> </ul> </details> <details class=abstract><summary>Code organization</summary><p>Using Redux requires a lot of extra code in actions and reducers, which get separated from the components for which it is used.</p> <details class=abstract><summary>Idiomatic Redux</summary><p>However, there is a way to do it nicely.</p> <p>There is a way of writing <em>idiomatic</em> redux, beautifully advocated by its creator, Dan Abramov, in <a href=https://egghead.io/courses/getting-started-with-redux>30 videos</a> .</p> </details> <details class=abstract><summary>Dux</summary><p>A next level of organization is <a href=https://github.com/erikras/ducks-modular-redux>ducts (we call them dux)</a> .</p> <p>We divide the state into segments that are responsible for well-described tasks, such as</p> <ul> <li>tables of data from the server</li> <li>notification</li> <li>faceted browsing</li> <li>alternative presentations to the user</li> <li>window resizing</li> </ul> <p>For every such task, we make a <em>duct</em> and put it into the <em>dux</em> directory.</p> <p>Every duct manages a slice of the state has four sections:</p> <details class=abstract><summary>Actions</summary><p>Functions that create the actions whose dispatch will trigger a state update.</p> </details> <details class=abstract><summary>Reducer</summary><p>A single function that translates all relevant actions into updates of its slice of the state.</p> </details> <details class=abstract><summary>Selectors</summary><p>Functions that grab data from the state in order to offer it to <a href=#connect>connected</a> components.</p> </details> <details class=abstract><summary>Helpers</summary><p>Functions that contain additional logic, especially for selectors.</p> <p>See for an example <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/app/dux/filters.js>filters</a> .</p> </details> </details> </details> <h2 id=merge>Merge<a class=headerlink href=#merge title="Permanent link">&para;</a></h2> <p>When a reducer transforms a state, it must happen in such a way that</p> <ul> <li>unaffected parts of the state do not change,</li> <li>all intermediate objects between the top-level state and a changed leaf are fresh objects.</li> </ul> <details class=abstract><summary>Merge tools</summary><details class=caution><summary>lodash merge/mergeWith</summary><p>A candidate to achieve this is to use <a href=https://lodash.com/docs/4.17.15#merge>lodash merge</a> and <a href=https://lodash.com/docs/4.17.15#mergeWith>lodash mergeWith</a> .</p> <p>The hint to use Lodash functions for this is given <a href=https://redux.js.org/docs/recipes/reducers/UpdatingNormalizedData.html>here</a> .</p> <p>But <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/test/merge.js>tests</a> have shown that not in all cases equal parts remained identical objects.</p> </details> <details class=abstract><summary>immutability helper</summary><p>We ended up using <a href=https://github.com/kolodny/immutability-helper>Immutability-Helper</a> in all cases.</p> <p>Its function <code>update()</code> takes an object, and transforms it on the basis of an other object, precisely as needed for our purposes.</p> <p>See the code in the <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/app/dux/notes.js>notes duct</a> .</p> </details> </details> <h2 id=select>Select<a class=headerlink href=#select title="Permanent link">&para;</a></h2> <p>The opposite of merging data into the state is selecting data from the state.</p> <details class=abstract><summary>Selectors</summary><p>Our components need bits and pieces of the state in order to know what they should render.</p> <p>To this end, we write <em>selector</em> functions, that return suitable slices of the state.</p> </details> <details class=abstract><summary>computations</summary><p>In some cases, selecting the data requires quite a bit of computation.</p> <details class=example><summary>Normalized data</summary><p>When the data in the state is <em>normalized</em> and the component needs denormalized data.</p> </details> <details class=example><summary>Faceted browsing</summary><p>The items to show must be computed from the list of items in the table slice of the state, combined with the current filter settings from the filter slice of the state.</p> </details> </details> <details class=caution><summary>Performance problem</summary><p>Here we encounter a potential performance problem.</p> <p>Sometimes components will be re-rendered even if their piece of the state has not changed.</p> <p>Or, if it has changed, it is often the case that the derived data that the component needs, has not changed.</p> <p>In general, if we do nothing about it, the computations in selectors will be executed more often than necessary.</p> </details> <details class=note><summary>Solution: memoization</summary><p>The method to deal with this is memoization.</p> <details class=abstract><summary>Reselect</summary><p>The redux documentation suggests the <a href=https://github.com/reactjs/reselect>reselect</a> library <a href=https://redux.js.org/docs/recipes/ComputingDerivedData.html>here</a> .</p> <p><em>Reselect</em> facilitates the fabrication of selectors that remember their last output in combination with the parameters passed to it.</p> <p>If such a selector is called repeatedly with the same arguments, it will fetch the computed result from its cache the second time it is called and then onwards.</p> <p>We use this library only to implement a function that <a href=../../Client/Lib/#utils>combines selectors</a> .</p> </details> <details class=abstract><summary>Homegrown memoization</summary><p>However, we will also encounter cases where we need more complete memoization, so that functions have a cache for their results given multiple sets of parameters.</p> <p>See <a href=../../Client/Lib/#memo>memo</a> .</p> </details> </details> <h2 id=connect>Connect<a class=headerlink href=#connect title="Permanent link">&para;</a></h2> <p>Redux and the dux streamline very much how components deal with the centralized store.</p> <p>The central function is Redux <a href=https://react-redux.js.org/docs/api#connect>connect</a> .</p> <details class=abstract><summary>Connecting components to the state</summary><p>If a component <code>X</code> needs state, we can create a <em>connected</em> component <code>Xc</code> from <code>X</code>.</p> <p>Connected means: connected to the state.</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nx>Xc</span> <span class=o>=</span> <span class=nx>connect</span><span class=p>(</span><span class=nx>selectors</span><span class=p>,</span> <span class=nx>dispatchers</span><span class=p>)(</span><span class=nx>X</span><span class=p>)</span>
</pre></div> </td></tr></table> <p>The new component <code>Xc</code> has extra props:</p> <details class=explanation><summary>selectors</summary><p>Data provided by the function <code>selectors</code>, which is a function that reads the global state and returns information of it as a props object.</p> </details> <details class=explanation><summary>dispatchers</summary><p>Callback provided by the function <code>dispatchers</code>.</p> <p>This returns a props object of action creator functions. <code>Xc</code> can use these where a callback is needed.</p> <p>When such a function is called, the action will be created and dispatched, which in turn will lead to a state change.</p> </details> <p>See also <a href=../../Concepts/Architecture/#overview>Architecture</a> .</p> </details> <h2 id=routing>Routing<a class=headerlink href=#routing title="Permanent link">&para;</a></h2> <p><a href=https://github.com/ReactTraining/react-router>React-router</a> is a convenient library to manage the connection between the URL and the part of your app that should be active in response to it.</p> <details class=details><summary>Routers as components</summary><p>The router and its routes are basically React <a href=#components>components</a> .</p> <p>But they come loaded with some extra behaviour.</p> <p>Basically, when a route is rendered, it checks its <code>path</code> attribute with the current URL.</p> <p>If it matches, it renders itself.</p> <p>Otherwise, it does not mount, or if it was mounted, it will unmount.</p> </details> <details class=details><summary>API and State</summary><p>Several tricks are employed to make this a really useful library. See the <a href=https://reacttraining.com/react-router/web/guides/quick-start>API docs</a> .</p> <p>However, precisely because of this repeated mounting and unmounting caused by routing events, the need arises for components to save their states, especially the ones with a costly state.</p> <p>Here is another reason why local state becomes cumbersome.</p> <p>With Redux, this is not a problem, because state is severed from the components.</p> </details> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../ES6/ title=ES6 class="md-flex md-footer-nav__link md-footer-nav__link--prev head-type" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> ES6 </span> </div> </a> <a href=../../Integration/API/ title=API class="md-flex md-footer-nav__link md-footer-nav__link--next head-type" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> API </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-disclaimer> The content of this site is produced under responsibility of project <b>Dans-labs/dariah</b> and is subject to change. </div> <div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> customised by <a href=https://github.com/Dans-labs>Dans-labs</a> </div> </div> <div class=md-footer-dans> <div>DANS is an institute of KNAW and NWO</div> <div> <a href=https://dans.knaw.nl/en title="Data Archiving and Networked Services (DANS)"><img class=md-footer-dans__img src=../../assets/images/DANS.gif height=50></a> <a target=_blank href=https://www.knaw.nl/en><img src=../../assets/images/knaw.png height=50></a> <a target=_blank href=https://www.nwo.nl/en><img src=../../assets/images/nwo.png height=50></a> </div> <div><i>Driven by data</i></div> </div> <link rel=stylesheet href=../../assets/fonts/font-awesome.css> <style>.md-footer-social__desc{font-family:"Open Sans",sans-serif;-webkit-font-smoothing:auto}</style> <ul class=md-footer-social> <li class=md-footer-social__li> <a href=http://eepurl.com/dvnr8D class="md-footer-social__link fa fa-envelope-square"> <span class=md-footer-social__desc>Newsletter</span> </a> </li> <li class=md-footer-social__li> <a href=https://twitter.com/DANSKNAW class="md-footer-social__link fa fa-twitter-square"> <span class=md-footer-social__desc>Twitter</span> </a> </li> <li class=md-footer-social__li> <a href=https://www.youtube.com/user/DANSDataArchiving class="md-footer-social__link fa fa-youtube-square"> <span class=md-footer-social__desc>YouTube</span> </a> </li> <li class=md-footer-social__li> <a href=https://www.linkedin.com/company/dans class="md-footer-social__link fa fa-linkedin-square"> <span class=md-footer-social__desc>LinkedIn</span> </a> </li> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.f780ca69.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> </body> </html>