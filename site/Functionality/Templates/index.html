<!doctype html><html lang=en class=no-js> <head><link href=https://fonts.gstatic.com rel=preconnect crossorigin><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="The technical documentation of the DARIAH Contribution Tool. Design, specs, rationales, patterns, diagrams.
"><link href=https://dans-labs.github.io/dariah/Functionality/Templates/ rel=canonical><meta name=author content="Dirk Roorda"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../icons/favicon.ico><meta name=generator content="mkdocs-1.0.4, mkdocs-dans-4.4.0"><title>Templates - Tech Doc DARIAH contribution tool</title><link rel=stylesheet href=../../assets/stylesheets/application.f08c3f5e.css><script src=../../assets/javascripts/modernizr.74668098.js></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,700|Glegoo:300,400,400i,700|Ubuntu+Mono&display=swap"><style>body,input{font-family:"Open Sans",sans-serif}h1,h2,h3,h4,h5{font-family:"Glegoo",serif}code,kbd,pre{font-family:"Ubuntu Mono",monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css></head> <body dir=ltr> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#templates tabindex=1 class=md-skip> Skip to content </a> <header class="md-header md-dev" data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://dans.knaw.nl/en title="Data Archiving and Networked Services (DANS)" class="md-header-nav__button md-logo"> <img src=../../assets/images/DANS.png height=50> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://dans-labs.github.io/dariah/ title="Tech Doc DARIAH contribution tool" class="md-header-nav__button md-logo"> <img src=../../images/inkind_logo.png height=50> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Tech Doc DARIAH contribution tool <span class=md-dev-inline> still in beta </span> </span> <span class=md-header-nav__topic> Templates <span class=md-dev-inline> still in beta </span> </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/dans-labs/dariah/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. title=Home class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../About/Codebase/ title=About class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../Business/ title=Functionality class="md-tabs__link md-tabs__link--active"> Functionality </a> </li> <li class=md-tabs__item> <a href=../../Legacy/Content/ title=Legacy class=md-tabs__link> Legacy </a> </li> <li class=md-tabs__item> <a href=../../Concepts/Architecture/ title=Concepts class=md-tabs__link> Concepts </a> </li> <li class=md-tabs__item> <a href=../../Server/Authentication/ title=Server class=md-tabs__link> Server </a> </li> <li class=md-tabs__item> <a href=../../Client/Components/ title=Client class=md-tabs__link> Client </a> </li> <li class=md-tabs__item> <a href=../../Technology/Tech/ title=Technology class=md-tabs__link> Technology </a> </li> <li class=md-tabs__item> <a href=../../Integration/API/ title=Integration class=md-tabs__link> Integration </a> </li> <li class=md-tabs__item> <a href=../../Maintenance/Deploy/ title=Maintenance class=md-tabs__link> Maintenance </a> </li> </ul> </div> </nav> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://dans-labs.github.io/dariah/ title="Tech Doc DARIAH contribution tool" class="md-nav__button md-logo"> <img src=../../images/inkind_logo.png width=48 height=48> </a> Tech Doc DARIAH contribution tool </label> <div class=md-nav__source> <a href=https://github.com/dans-labs/dariah/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Home class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> About </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../About/Codebase/ title=Codebase class=md-nav__link> Codebase </a> </li> <li class=md-nav__item> <a href=../../About/Stats/ title=Stats class=md-nav__link> Stats </a> </li> <li class=md-nav__item> <a href=../../About/News/ title=News class=md-nav__link> News </a> </li> <li class=md-nav__item> <a href=../../About/Lessons/ title=Lessons class=md-nav__link> Lessons </a> </li> <li class=md-nav__item> <a href=../../About/Diagrams/ title=Diagrams class=md-nav__link> Diagrams </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3 checked> <label class=md-nav__link for=nav-3> Functionality </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> Functionality </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Business/ title=Business class=md-nav__link> Business </a> </li> <li class=md-nav__item> <a href=../Tables/ title=Tables class=md-nav__link> Tables </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Templates </label> <a href=./ title=Templates class="md-nav__link md-nav__link--active"> Templates </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#introduction title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#template-organization title="Template organization" class=md-nav__link> Template organization </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#read-edit-action title="Read, Edit, Action" class=md-nav__link> Read, Edit, Action </a> </li> <li class=md-nav__item> <a href=#insert title=Insert class=md-nav__link> Insert </a> </li> <li class=md-nav__item> <a href=#head title=Head class=md-nav__link> Head </a> </li> <li class=md-nav__item> <a href=#main-related-detail-consolidated title="Main, related, detail, consolidated" class=md-nav__link> Main, related, detail, consolidated </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#applying-templates title="Applying templates" class=md-nav__link> Applying templates </a> </li> <li class=md-nav__item> <a href=#details-of-the-kinds-of-templates title="Details of the kinds of templates" class=md-nav__link> Details of the kinds of templates </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#head_1 title=head class=md-nav__link> head </a> </li> <li class=md-nav__item> <a href=#main title=main class=md-nav__link> main </a> </li> <li class=md-nav__item> <a href=#mainedit title=mainEdit class=md-nav__link> mainEdit </a> </li> <li class=md-nav__item> <a href=#mainaction title=mainAction class=md-nav__link> mainAction </a> </li> <li class=md-nav__item> <a href=#detail title=detail class=md-nav__link> detail </a> </li> <li class=md-nav__item> <a href=#detailedit title=detailEdit class=md-nav__link> detailEdit </a> </li> <li class=md-nav__item> <a href=#detailaction title=detailAction class=md-nav__link> detailAction </a> </li> <li class=md-nav__item> <a href=#related title=related class=md-nav__link> related </a> </li> <li class=md-nav__item> <a href=#consolidated title=consolidated class=md-nav__link> consolidated </a> </li> <li class=md-nav__item> <a href=#insert_1 title=insert class=md-nav__link> insert </a> </li> <li class=md-nav__item> <a href=#editmode title=editMode class=md-nav__link> editMode </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Workflow/ title=Workflow class=md-nav__link> Workflow </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Legacy </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Legacy </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Legacy/Content/ title=Content class=md-nav__link> Content </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Concepts </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Concepts/Architecture/ title=Architecture class=md-nav__link> Architecture </a> </li> <li class=md-nav__item> <a href=../../Concepts/Model/ title=Model class=md-nav__link> Model </a> </li> <li class=md-nav__item> <a href=../../Concepts/Routing/ title=Routing class=md-nav__link> Routing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Server </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> Server </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Server/Authentication/ title=Authentication class=md-nav__link> Authentication </a> </li> <li class=md-nav__item> <a href=../../Server/Server/ title=Server class=md-nav__link> Server </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> Client </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-7> Client </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Client/Components/ title=Components class=md-nav__link> Components </a> </li> <li class=md-nav__item> <a href=../../Client/Dux/ title=Dux class=md-nav__link> Dux </a> </li> <li class=md-nav__item> <a href=../../Client/Lib/ title=Lib class=md-nav__link> Lib </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class=md-nav__link for=nav-8> Technology </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-8> Technology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Technology/Tech/ title=Tech class=md-nav__link> Tech </a> </li> <li class=md-nav__item> <a href=../../Technology/ES6/ title=ES6 class=md-nav__link> ES6 </a> </li> <li class=md-nav__item> <a href=../../Technology/React/ title=React class=md-nav__link> React </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-9 type=checkbox id=nav-9> <label class=md-nav__link for=nav-9> Integration </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-9> Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Integration/API/ title=API class=md-nav__link> API </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-10 type=checkbox id=nav-10> <label class=md-nav__link for=nav-10> Maintenance </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-10> Maintenance </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Maintenance/Deploy/ title=Deploy class=md-nav__link> Deploy </a> </li> <li class=md-nav__item> <a href=../../Maintenance/Tests/ title=Tests class=md-nav__link> Tests </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#introduction title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#template-organization title="Template organization" class=md-nav__link> Template organization </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#read-edit-action title="Read, Edit, Action" class=md-nav__link> Read, Edit, Action </a> </li> <li class=md-nav__item> <a href=#insert title=Insert class=md-nav__link> Insert </a> </li> <li class=md-nav__item> <a href=#head title=Head class=md-nav__link> Head </a> </li> <li class=md-nav__item> <a href=#main-related-detail-consolidated title="Main, related, detail, consolidated" class=md-nav__link> Main, related, detail, consolidated </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#applying-templates title="Applying templates" class=md-nav__link> Applying templates </a> </li> <li class=md-nav__item> <a href=#details-of-the-kinds-of-templates title="Details of the kinds of templates" class=md-nav__link> Details of the kinds of templates </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#head_1 title=head class=md-nav__link> head </a> </li> <li class=md-nav__item> <a href=#main title=main class=md-nav__link> main </a> </li> <li class=md-nav__item> <a href=#mainedit title=mainEdit class=md-nav__link> mainEdit </a> </li> <li class=md-nav__item> <a href=#mainaction title=mainAction class=md-nav__link> mainAction </a> </li> <li class=md-nav__item> <a href=#detail title=detail class=md-nav__link> detail </a> </li> <li class=md-nav__item> <a href=#detailedit title=detailEdit class=md-nav__link> detailEdit </a> </li> <li class=md-nav__item> <a href=#detailaction title=detailAction class=md-nav__link> detailAction </a> </li> <li class=md-nav__item> <a href=#related title=related class=md-nav__link> related </a> </li> <li class=md-nav__item> <a href=#consolidated title=consolidated class=md-nav__link> consolidated </a> </li> <li class=md-nav__item> <a href=#insert_1 title=insert class=md-nav__link> insert </a> </li> <li class=md-nav__item> <a href=#editmode title=editMode class=md-nav__link> editMode </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/dans-labs/dariah/edit/master/docs/Functionality/Templates.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=templates>Templates<a class=headerlink href=#templates title="Permanent link">&para;</a></h1> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>For some parts of the application the generic ways of presenting records and fields is just not good enough, e.g. for the display of assessments. We need a deeper customization there, where the criteriaEntry detail records should appear in one big form.</p> <p>The challenge is to use as much of the generic machinery when we define custom presentations. Our solution here is by using <em>templates</em>.</p> <p>The particulars of our templates are documented in <a href=Tables>Tables</a>, but you might need to continue reading here first about the power and organization of themt.</p> <p>Looking up a field value might seem a very innocent operation: you retrieve the appropriate document from the database, look up the field in question, and read out the value that you find there. Alas, there are several complicating factors:</p> <ol> <li>That value might be a MongoDB object identifier pointing to a related record. We do not want to display that identifier, but the corresponding record, but not the whole record. Only an informative heading. For that we have to look up additional fields in the related table, and possibly apply logic depending on what we encounter.</li> <li>We should not show fields that the current user is not entitled to view. We should not put in edit controls for fields that the current user is not allowed to edit.</li> <li>We should present values that are in some way <em>legacy</em> different from values that are <em>current</em>, where the current-ness of values is determined by certain other fields in the database (see <a href=Business>business model</a>.</li> </ol> <p>The first two concerns are built into the generic logic, in the components</p> <ul> <li><a href=Components#editinsert>EditInsert</a></li> <li><a href=Components#itemread>ItemRead</a></li> <li><a href=Components#itemedit>ItemEdit</a></li> <li><a href=Components#fieldread>FieldRead</a></li> <li><a href=Components#fieldedit>FieldEdit</a> and we do not want to reimplement this logic when we want to cater for the third concern by means of templates.</li> </ul> <p>Our solution is that templates are not static strings into which field values are merged dynamically.</p> <p>Instead, our templates are <em>functions</em> that take a properties object as arguments.</p> <p>The properties are functions that can furnish representations for fields. These functions use the general machinery to</p> <ul> <li><code>l(field)</code> fetch labels for fields;</li> <li><code>e(field)</code> check whether fields have empty values;</li> <li><code>v(field)</code> fetch the raw values for fields;</li> <li><code>w(key)</code> fetch additional <a href=Workflow>workflow</a> attributes for records;</li> <li><code>s(field)</code> fetch the plain string values for fields, replacing identifiers into related tables by headings of related records; by entity titles;</li> <li><code>f(field)</code> fetch values for fields (with related lookup), and wrap them in <a href=Components#fieldread>FieldRead</a> components;</li> <li><code>fe(field)</code> fetch values for fields, and wrap them in <a href=Components#fieldedit>FieldEdit</a> components, which are controls to let the user edit the value;</li> <li><code>fs(field)</code> present custom controls for fields and wrap them in <a href=Components#fieldset>FieldSet</a> components, which react to click events: upon a click, a baked in value will be saved for this field to the database;</li> <li><code>n</code> (only for insert templates): the number of detail records in the list</li> <li><code>at</code> a set of the <em>active</em> contribution types</li> <li><code>o</code> check whether the current record is owned by the user or whether the user</li> <li><code>m(field)</code> check whether the field is editable by the current user; is in the list of editors;</li> <li><code>me</code> all attributes of the logged in user (empty if the user is not logged in);</li> <li><code>linkMe</code> a direct hyperlink to a the value as part of its list;</li> <li><code>editButton</code> a ready-made control for switching edit/read-only mode and saving the values.</li> <li><code>onInsert</code> a ready-made handler for triggering an insert action. To be associated to the element that receives the user trigger to create a new record.</li> </ul> <p>Applying a template means feeding a higher order React component with a properties object of field rendering functions, which results in a concrete React component.</p> <p>The templates will be applied by <a href=Components#editinsert>EditInsert</a>, <a href=Components#itemread>ItemRead</a>, <a href=Components#itemedit>ItemEdit</a>, <a href=Components#itemaction>ItemAction</a>, and <a href=Components#listplain>ListPlain</a>. using the functions <a href=Templates#applytemplate>applyTemplate</a>, <a href=Templates#applyedittemplate>applyEditTemplate</a>, <a href=Templates#applyinserttemplate>applyInsertTemplate</a>, and <a href=Templates#editmode>editMode</a>.</p> <h2 id=template-organization>Template organization<a class=headerlink href=#template-organization title="Permanent link">&para;</a></h2> <p>There are several purposes for which we invoke the template mechanism:</p> <ul> <li>The presentation of:<ul> <li>headings in lists of records</li> <li>main records</li> <li>related records</li> <li>detail records</li> <li>insert buttons</li> <li>consolidated records</li> </ul> </li> <li>the determination of:<ul> <li>edit modes.</li> </ul> </li> </ul> <p>All templates can be found in files named after the tables for which they are defined. You can find them in the <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/app/tables>tables</a> directory. For each table there is an object of template functions, first keyed by their purpose and then, optionally, by the related/detail table they are for.</p> <h3 id=read-edit-action>Read, Edit, Action<a class=headerlink href=#read-edit-action title="Permanent link">&para;</a></h3> <p>For main and detail records, we have several sets of templates:</p> <ul> <li><strong>Head</strong> for presentation of record headings in lists,</li> <li><strong>Read</strong> for presentation of records in read-only mode,</li> <li><strong>Edit</strong> for presenting records as forms with editable fields,</li> <li><strong>Action</strong> for presenting actions upon records.</li> </ul> <p>The idea is that the form can switch between <strong>Read</strong> and <strong>Edit</strong> by means of a standard control, and that the <strong>Action</strong> part is independent of that switch: it is always displayed.</p> <p>In the <strong>Read</strong> part, you cannot have edit controls, but in the <strong>Edit</strong> and <strong>Action</strong> parts you can have them. However, in the <strong>Action</strong> part, you do not have <code>save</code> and <code>reset</code> buttons. This part is meant for action buttons, which change a field to a predefined value and save them immediately.</p> <h3 id=insert>Insert<a class=headerlink href=#insert title="Permanent link">&para;</a></h3> <p>For lists of detail records we have templates that format the insert button. These templates can also choose not to show the insert button, depending on conditions determined by the master record and the number of items in the detail list.</p> <h3 id=head>Head<a class=headerlink href=#head title="Permanent link">&para;</a></h3> <p>When records are listed, we see a vertical list of record headings. For things that are handled by workflows, such as contributions, assessments and review, it is desirable to display some workflow information right in front of the heading. Think of an assessment <em>score</em> for assessments and contributions, or a review status, telling whether the assessment is being reviewed, and if it has been reviewed, what the final decision was.</p> <h3 id=main-related-detail-consolidated>Main, related, detail, consolidated<a class=headerlink href=#main-related-detail-consolidated title="Permanent link">&para;</a></h3> <p><strong>Related records</strong> are records pointed to by a field in a main record. For example, an <code>assessment</code> record has a field <code>contribution</code>, containing the identifier of the contribution record that the assessment is targeting. Here the assessment record wants to display a contribution record as read-only information. A template for this can be found in the templates file <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/app/tables/contrib.jsx>contrib</a></p> <p>This template is only invoked if a contribution record has to be displayed as part of an assessment record. If we need to display it in as part of an other type of record, we can define a separate template for that case.</p> <p>We use these templates for details that want to display a representation of the master inside, or for other cases where records point to other records without an explicit master detail relationship.</p> <p><strong>Detail records</strong> are records that point to another record, called the master record. It is typically used when a piece of information consists of a variable number of items. Some central fields go into a master record, and the other items go into detail records that point to the master.</p> <p>For an example, an <code>assessment</code> record is accompanied by a series of <code>criteriaEntry</code> records. The <code>assessment</code> record has no pointers to the <code>criteriaEntry</code> records. Rather each <code>criteriaEntry</code> record points to an assessment record.</p> <p>If record A points to record B, you could say that record B is as master record and A is a detail of it. But in our application, this is not automatically so.</p> <p>For example, a contribution points to a <code>year</code> record, to indicate the year of the contribution. Yet we do not consider a contribution to be a detail of a year.</p> <p>If you want related records to be treated as detail records, you have to say so in the <a href=Model>data model</a>.</p> <p>These templates become active when records are displayed in the list of records below a master record.</p> <p><strong>Consolidated records</strong> are records for which all related values and relevant details have been collected and represented as strings. A consolidated record is a frozen snapshot of the logical content of a record. It will not change if related records and detail records are modified. We use consolidated records for storing contribution metadata in assessment records when the assessment has finished, and other cases where we have to preserve a record of activities.</p> <h2 id=applying-templates>Applying templates<a class=headerlink href=#applying-templates title="Permanent link">&para;</a></h2> <p>A template is a function that can be passed a <code>props</code> object containing functions that deliver field value information or workflow information:</p> <ul> <li><code>v = field =&gt;</code> <em>read-only string value for</em> <code>field</code></li> <li><code>f = field =&gt; &lt;FieldRead&gt;</code> <em>react component for reading</em> <code>field</code></li> <li><code>fe = field =&gt; &lt;FieldEdit&gt;</code> <em>react component for editing</em> <code>field</code></li> <li><code>fs = field =&gt; &lt;FieldSet&gt;</code> <em>customizable react component for setting</em> <code>field</code> to a predefined value</li> <li><code>e = field =&gt;</code> <em>whether that field has an empty value</em></li> <li><code>m = field =&gt;</code> <em>whether that field is editable by the current user</em></li> <li><code>w = kind =&gt;</code> workflow information, see <a href=Workflow>workflow</a>.</li> </ul> <p>See the library module <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/templates.js>templates</a></p> <p><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/app/components/Templates.jsx>Templates</a></p> <h2 id=details-of-the-kinds-of-templates>Details of the kinds of templates<a class=headerlink href=#details-of-the-kinds-of-templates title="Permanent link">&para;</a></h2> <h3 id=head_1>head<a class=headerlink href=#head_1 title="Permanent link">&para;</a></h3> <p>The templates for record headings. The result should be a string, not anything that is more complex. If there is no result, do not deliver <code>null</code>, but <code>emptyS</code> (the empty string).</p> <h3 id=main>main<a class=headerlink href=#main title="Permanent link">&para;</a></h3> <p>The <em>read</em> templates for records in tables, when presented on their own, i.e. not in relation to other, related records. They will not be passed the <code>fe</code> function.</p> <h3 id=mainedit>mainEdit<a class=headerlink href=#mainedit title="Permanent link">&para;</a></h3> <p>The <em>edit</em> templates for records in tables, when presented on their own, i.e. not in relation to other, related records.</p> <p>These template functions are passed the <code>fe</code> function. There is an extra parameter <code>editButton</code>, which is a React component that holds the <a href=EditCOntrol>edit/save button</a> for this record.</p> <h3 id=mainaction>mainAction<a class=headerlink href=#mainaction title="Permanent link">&para;</a></h3> <p>Like <em>mainEdit</em>, but now the values are <em>action</em> templates.</p> <p>These template functions do get the <code>fe</code> function.</p> <h3 id=detail>detail<a class=headerlink href=#detail title="Permanent link">&para;</a></h3> <p>The <em>read</em> templates for records in tables, when presented as detail of a master table. Per master table you can define a separate template.</p> <p>These templates are not passed the <code>fe</code> function.</p> <h3 id=detailedit>detailEdit<a class=headerlink href=#detailedit title="Permanent link">&para;</a></h3> <p>The <em>edit</em> templates for records in tables, when presented as detail of a master table. Per master table you can define a separate template.</p> <p>These templates do get the <code>fe</code> function.</p> <p>These template functions are passed the <code>fe</code> function. There is an extra parameter <code>editButton</code>, which is a React component that holds the edit/save button for this record.</p> <h3 id=detailaction>detailAction<a class=headerlink href=#detailaction title="Permanent link">&para;</a></h3> <p>Like <em>detailEdit</em>, but now the values are <em>action</em> templates.</p> <p>These template functions do get the <code>fe</code> function.</p> <h3 id=related>related<a class=headerlink href=#related title="Permanent link">&para;</a></h3> <p>The <em>read</em> templates for records in tables, when an other, related table points to them. It is more like a main record pointing to a related record. Per main table you can define a separate template.</p> <p>These template functions are not passed the <code>fe</code> function, but they get an extra parameter: <code>linkMe</code>, a hyperlink to the main record: <code>linkMe</code>.</p> <h3 id=consolidated>consolidated<a class=headerlink href=#consolidated title="Permanent link">&para;</a></h3> <p>Much like <em>related</em>, but here we have templates that only use consolidated values.</p> <p>These templates are passed a special version of the <code>v</code> function, that resolves all dependencies.</p> <h3 id=insert_1>insert<a class=headerlink href=#insert_1 title="Permanent link">&para;</a></h3> <p>When you want to customize the rather modest + button that inserts a new record in a table, you can write a template for it. This template does not operate on the level of individual items, so it does not get passed the usual functions. What it gets is the number of items that already exist (as details of a master record), and a handler to invoke when the instantiated template is clicked.</p> <h3 id=editmode>editMode<a class=headerlink href=#editmode title="Permanent link">&para;</a></h3> <p>In some situation you want to open some records in edit mode and others in read mode. A typical situation is where you want to open incomplete records in edit mode, and others not. The template functions of this kind do not deliver templates, but a boolean, which will be used whenever a table is presented to the user as a list.</p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../Tables/ title=Tables class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> Tables </span> </div> </a> <a href=../Workflow/ title=Workflow class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> Workflow </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> customised by <a href=https://github.com/Dans-labs>Dans-labs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../assets/fonts/font-awesome.css> <a href=http://eepurl.com/dvnr8D class="md-footer-social__link fa fa-envelope"></a> <a href=https://twitter.com/DANSKNAW class="md-footer-social__link fa fa-twitter"></a> <a href=https://www.youtube.com/user/DANSDataArchiving class="md-footer-social__link fa fa-youtube"></a> <a href=https://www.linkedin.com/company/dans class="md-footer-social__link fa fa-linkedin"></a> </div> <div class=md-footer-dans> <span>DANS is an institute of KNAW and NWO<span> <img src=../../assets/images/knawnwo.png height=50> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.48e0327a.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> </body> </html>