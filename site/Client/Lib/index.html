<!doctype html><html lang=en class=no-js> <head><link href=https://fonts.gstatic.com rel=preconnect crossorigin><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="The technical documentation of the DARIAH Contribution Tool. Design, specs, rationales, patterns, diagrams.
"><link href=https://dans-labs.github.io/dariah/Client/Lib/ rel=canonical><meta name=author content="Dirk Roorda"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../icons/favicon.ico><meta name=generator content="mkdocs-1.0.4, mkdocs-dans-4.4.1"><title>Lib - Tech Doc DARIAH contribution tool</title><link rel=stylesheet href=../../assets/stylesheets/application.27a306a7.css><script src=../../assets/javascripts/modernizr.74668098.js></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,700|Glegoo:300,400,400i,700|Ubuntu+Mono&display=swap"><style>.body-type,body,input{font-family:"Open Sans",sans-serif}.head-type,h1,h2,h3,h4,h5{font-family:"Glegoo",serif}.code-type,code,kbd,pre{font-family:"Ubuntu Mono",monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css></head> <body dir=ltr> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#library tabindex=1 class=md-skip> Skip to content </a> <header class="md-header md-dev" data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://www.dariah.eu title=DARIAH class="md-header-nav__button md-logo"> <img src=../../images/dariah.png height=50> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://dans-labs.github.io/dariah/ title="Tech Doc DARIAH contribution tool" class="md-header-nav__button md-logo"> <img src=../../images/inkind_logo.png height=50> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title head-type" data-md-component=title> <span class=md-header-nav__topic> Tech Doc DARIAH contribution tool <span class="md-dev-inline head-type"> still in beta </span> </span> <span class=md-header-nav__topic> Lib <span class="md-dev-inline head-type"> still in beta </span> </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/dans-labs/dariah/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> Dans-labs/dariah </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. title=Home class="md-tabs__link head-type"> Home </a> </li> <li class=md-tabs__item> <a href=../../About/Codebase/ title=About class="md-tabs__link head-type"> About </a> </li> <li class=md-tabs__item> <a href=../../Functionality/Business/ title=Functionality class="md-tabs__link head-type"> Functionality </a> </li> <li class=md-tabs__item> <a href=../../Legacy/Content/ title=Legacy class="md-tabs__link head-type"> Legacy </a> </li> <li class=md-tabs__item> <a href=../../Concepts/Architecture/ title=Concepts class="md-tabs__link head-type"> Concepts </a> </li> <li class=md-tabs__item> <a href=../../Server/Authentication/ title=Server class="md-tabs__link head-type"> Server </a> </li> <li class=md-tabs__item> <a href=../Components/ title=Client class="md-tabs__link md-tabs__link--active head-type"> Client </a> </li> <li class=md-tabs__item> <a href=../../Technology/Tech/ title=Technology class="md-tabs__link head-type"> Technology </a> </li> <li class=md-tabs__item> <a href=../../Integration/API/ title=Integration class="md-tabs__link head-type"> Integration </a> </li> <li class=md-tabs__item> <a href=../../Maintenance/Deploy/ title=Maintenance class="md-tabs__link head-type"> Maintenance </a> </li> </ul> </div> </nav> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title head-type md-nav__title--site" for=__drawer> <a href=https://dans-labs.github.io/dariah/ title="Tech Doc DARIAH contribution tool" class="md-nav__button md-logo"> <img src=../../images/inkind_logo.png width=48 height=48> </a> Tech Doc DARIAH contribution tool </label> <div class=md-nav__source> <a href=https://github.com/dans-labs/dariah/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> Dans-labs/dariah </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Home class="md-nav__link head-type"> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class="md-nav__link head-type" for=nav-2> About </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-2> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../About/Codebase/ title=Codebase class="md-nav__link head-type"> Codebase </a> </li> <li class=md-nav__item> <a href=../../About/Stats/ title=Stats class="md-nav__link head-type"> Stats </a> </li> <li class=md-nav__item> <a href=../../About/News/ title=News class="md-nav__link head-type"> News </a> </li> <li class=md-nav__item> <a href=../../About/Lessons/ title=Lessons class="md-nav__link head-type"> Lessons </a> </li> <li class=md-nav__item> <a href=../../About/Diagrams/ title=Diagrams class="md-nav__link head-type"> Diagrams </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class="md-nav__link head-type" for=nav-3> Functionality </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-3> Functionality </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Functionality/Business/ title=Business class="md-nav__link head-type"> Business </a> </li> <li class=md-nav__item> <a href=../../Functionality/Tables/ title=Tables class="md-nav__link head-type"> Tables </a> </li> <li class=md-nav__item> <a href=../../Functionality/Templates/ title=Templates class="md-nav__link head-type"> Templates </a> </li> <li class=md-nav__item> <a href=../../Functionality/Workflow/ title=Workflow class="md-nav__link head-type"> Workflow </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class="md-nav__link head-type" for=nav-4> Legacy </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-4> Legacy </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Legacy/Content/ title=Content class="md-nav__link head-type"> Content </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class="md-nav__link head-type" for=nav-5> Concepts </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-5> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Concepts/Architecture/ title=Architecture class="md-nav__link head-type"> Architecture </a> </li> <li class=md-nav__item> <a href=../../Concepts/Model/ title=Model class="md-nav__link head-type"> Model </a> </li> <li class=md-nav__item> <a href=../../Concepts/Routing/ title=Routing class="md-nav__link head-type"> Routing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class="md-nav__link head-type" for=nav-6> Server </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-6> Server </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Server/Authentication/ title=Authentication class="md-nav__link head-type"> Authentication </a> </li> <li class=md-nav__item> <a href=../../Server/Server/ title=Server class="md-nav__link head-type"> Server </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7 checked> <label class="md-nav__link head-type" for=nav-7> Client </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-7> Client </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Components/ title=Components class="md-nav__link head-type"> Components </a> </li> <li class=md-nav__item> <a href=../Dux/ title=Dux class="md-nav__link head-type"> Dux </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active head-type" for=__toc> Lib </label> <a href=./ title=Lib class="md-nav__link md-nav__link--active head-type"> Lib </a> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title head-type" for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#datatypes title=datatypes class="md-nav__link head-type"> datatypes </a> </li> <li class=md-nav__item> <a href=#details title=details class="md-nav__link head-type"> details </a> </li> <li class=md-nav__item> <a href=#edit title=edit class="md-nav__link head-type"> edit </a> </li> <li class=md-nav__item> <a href=#europegeo title=europe.geo class="md-nav__link head-type"> europe.geo </a> </li> <li class=md-nav__item> <a href=#fields title=fields class="md-nav__link head-type"> fields </a> </li> <li class=md-nav__item> <a href=#handle title=handle class="md-nav__link head-type"> handle </a> </li> <li class=md-nav__item> <a href=#memo title=memo class="md-nav__link head-type"> memo </a> </li> <li class=md-nav__item> <a href=#templates title=templates class="md-nav__link head-type"> templates </a> </li> <li class=md-nav__item> <a href=#utils title=utils class="md-nav__link head-type"> utils </a> </li> <li class=md-nav__item> <a href=#values title=values class="md-nav__link head-type"> values </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class="md-nav__link head-type" for=nav-8> Technology </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-8> Technology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Technology/Tech/ title=Tech class="md-nav__link head-type"> Tech </a> </li> <li class=md-nav__item> <a href=../../Technology/ES6/ title=ES6 class="md-nav__link head-type"> ES6 </a> </li> <li class=md-nav__item> <a href=../../Technology/React/ title=React class="md-nav__link head-type"> React </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-9 type=checkbox id=nav-9> <label class="md-nav__link head-type" for=nav-9> Integration </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-9> Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Integration/API/ title=API class="md-nav__link head-type"> API </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-10 type=checkbox id=nav-10> <label class="md-nav__link head-type" for=nav-10> Maintenance </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class="md-nav__title head-type" for=nav-10> Maintenance </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Maintenance/Deploy/ title=Deploy class="md-nav__link head-type"> Deploy </a> </li> <li class=md-nav__item> <a href=../../Maintenance/Tests/ title=Tests class="md-nav__link head-type"> Tests </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title head-type" for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#datatypes title=datatypes class="md-nav__link head-type"> datatypes </a> </li> <li class=md-nav__item> <a href=#details title=details class="md-nav__link head-type"> details </a> </li> <li class=md-nav__item> <a href=#edit title=edit class="md-nav__link head-type"> edit </a> </li> <li class=md-nav__item> <a href=#europegeo title=europe.geo class="md-nav__link head-type"> europe.geo </a> </li> <li class=md-nav__item> <a href=#fields title=fields class="md-nav__link head-type"> fields </a> </li> <li class=md-nav__item> <a href=#handle title=handle class="md-nav__link head-type"> handle </a> </li> <li class=md-nav__item> <a href=#memo title=memo class="md-nav__link head-type"> memo </a> </li> <li class=md-nav__item> <a href=#templates title=templates class="md-nav__link head-type"> templates </a> </li> <li class=md-nav__item> <a href=#utils title=utils class="md-nav__link head-type"> utils </a> </li> <li class=md-nav__item> <a href=#values title=values class="md-nav__link head-type"> values </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/dans-labs/dariah/edit/master/docs/Client/Lib.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=library>Library<a class=headerlink href=#library title="Permanent link">&para;</a></h1> <p>Lower level functions called by various reducers, selectors, helpers and components.</p> <h2 id=datatypes><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/datatypes.js>datatypes</a><a class=headerlink href=#datatypes title="Permanent link">&para;</a></h2> <details class=explanation open=open><summary>Explanation</summary><p>Elementary operations on data that comes in basic types, such as strings, numbers and dates. This file contains also the functions that normalize and validate values.</p> </details> <details class=explanation><summary>getDateTime</summary><p>Convert a datetime object or string into a numerical value, so you can make comparisons. If absent, yield negative infinity for start dates and positive infinity for end dates. Used in <a href=../Dux/#workflow>workflow</a> .</p> </details> <details class=explanation><summary>normalization</summary><p>An object with normalization functions, named after the types of the values they normalize. All functions take a value, and return a normalized value.</p> </details> <details class=explanation><summary>sortStringTemplate</summary><p>Compare function for sorting. Wraps the values to be compared in a template before actually comparing them.</p> <p>Used in <a href=../Dux/#workflow>workflow</a> .</p> </details> <details class=explanation><summary>sortTimeInterval</summary><p>Sort by time interval. Sorting by time intervals should works as follows:</p> <ul> <li>if both intervals are fully specified, the interval with the earlier start date comes first;</li> <li>if the start dates are equal, the one with the LATER end date comes first, in this way, containing intervals come before contained intervals;</li> <li>if the start date is missing, the start date is assumed to be in the infinite past;</li> <li>if the end date is missing, the end date is assumed to be in the infinite future.</li> </ul> <p>Used in <a href=../Dux/#workflow>workflow</a> .</p> </details> <details class=explanation><summary>trimDate</summary><p>Removes the milliseconds from an ISO string representing a datetime. Can also remove the whole time part from a datetime. This essentially presents a datetime as a date.</p> </details> <details class=explanation><summary>validation</summary><p>An object with validation functions, named after the types of the values they validate. All functions take a value, and return undefined if the value passes validation or is itself undefined. If a value does not pass validation, a simple string expressing the reason is returned.</p> </details> <h2 id=details><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/detail.js>details</a><a class=headerlink href=#details title="Permanent link">&para;</a></h2> <details class=explanation open=open><summary>Explanation</summary><p>These functions help by setting up lists of detail records for master records. The carry out what has been specified in the <a href=../../Concepts/Model/ >data model</a> config files under the keys <code>detail</code> and <code>detailOrder</code>.</p> </details> <details class=explanation><summary>getMasterTable</summary><p>Given a table and the name of a field that links to an other, related, table, if finds the name of that related table. If that other table list this table as a details table, and marks this field as the link field, then the related table is indeed the master table. But this function is indifferent to that. It merely consults the <code>fieldSpec</code> of <code>field</code> in <code>table</code>.</p> </details> <details class=explanation><summary>makeDetails</summary><p>Prepare lists of details for an item of a table. Collect the specs and put all information in an array of objects, each corresponding to a details list, from which components can easily construct a widget for handling lists of details</p> </details> <details class=explanation><summary>makeKeepInfo</summary><p>Collects information on the basis of which it can be decided whether a record may be deleted or not. A record may be deleted if it has no detail records, except those that will be deleted as well. Those are the details which are marked as <code>cascade</code> in the <a href=../../Concepts/Model/ >data model</a> . This function returns a list of all non-cascade detail tables that have records linking to the record in question.</p> <details class=example open=open><summary>Example</summary><p><a href=../Components/#itemform>ItemForm</a></p> </details> </details> <h2 id=edit><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/edit.js>edit</a><a class=headerlink href=#edit title="Permanent link">&para;</a></h2> <details class=explanation open=open><summary>Explanation</summary><p>Helpers for presenting edit controls, such as a save button.</p> </details> <details class=explanation><summary>editClass</summary><p>Returns the proper CSS class for styling content that is being edited, depending on the state it may be in:</p> <ul> <li><code>dirty</code>: a changed value that has not been saved to the database yet, and/or</li> <li><code>invalid</code>: a value that does not pass validation.</li> </ul> </details> <details class=explanation><summary>editControl</summary><p>This is nearly a React component, except it needs a boolean parameter <code>canSubmit</code>, to direct it into one behaviour or another.</p> <p>The basic function of this component is to give an indication of the edit status of a record. Whether values have changed (<code>dirty</code>), values are <code>invalid</code>, or values are being <code>submitted</code>.</p> <p>If this component is put inside a <code>&lt;form&gt;</code> element under the control of <a href=https://redux-form.com>redux-form</a> , it is also capable to trigger a submit and save action.</p> <details class=abstract><summary><code>canSubmit = true</code></summary><p>The component <a href=../Components/#editcontrol>EditControl</a> calls this function with submit capacity. It also has to provide the resulting component with typical form properties, such as <code>dirty</code>, <code>valid</code>, <code>handleSubmit</code>.</p> <p>Because in this case the component lives inside a component that is already enhanced with <code>reduxForm</code>, namely <a href=../Components/#itemedit>ItemEdit</a> , these properties have been injected higher up in the component tree and can be passed down as props.</p> </details> <details class=abstract><summary><code>canSubmit = false</code></summary><p>The the component <a href=../Components/#editstatus>EditStatus</a> calls this function without submit capacity. The typical form properties are now obtained by enhancing this very component with <code>reduxForm</code>. However, because this component is not assumed to be within a <code>&lt;form&gt;</code> context, it cannot perform a submit.</p> </details> </details> <details class=explanation><summary>makeChangeSave</summary><p>Produces a function, that when triggered by a value, will submit that value (after a short delay). See <code>makeSubmitTime</code>. This is used when an input field fires an event with a value entered by the user.</p> </details> <details class=explanation><summary>makeChangeSaveVal</summary><p>Produces a function, with a value baked in. When called, this function will submit that value (after a short delay). This is used when the user clicks a button, like <code>submit review</code> in which case a specific field has to be set to a specific value, in this example: <code>submitted = true</code>.</p> </details> <details class=explanation><summary>makeReset</summary><p>Composes an attribute that sets up an <code>onKeyUp</code> handler for an input field. It will react to the <code>Esc</code> key, and reset the input field to its pristine value, i.e. the value it had before the user started interacting with it.</p> </details> <details class=explanation><summary>makeSubmit</summary><p>Produces a submit action or a null-returning function, depending on parameters. The parameters tell whether some record is dirty, valid and not currently submitting. In that case, the result is a submit function (which is also passed as parameter).</p> <p>This function is used in those cases where an input field looses focus. It then generates a submit action if all is well.</p> </details> <details class=explanation><summary>makeSubmitTime</summary><p>Given a (submit)-function, transforms it into the same function that will be invoked with a small delay.</p> <p>This can be used after events that change a form, without a blur event. The event should trigger a submit and save, but first the triggering action should have done its work.</p> <details class=example open=open><summary>Example</summary><p><a href=../Components/#input>Input</a></p> </details> </details> <details class=explanation><summary>onSubmitSuccess</summary><p>Needed in a workaround for an <a href=https://github.com/erikras/redux-form/issues/2841>issue in redux-form</a> .</p> <details class=example open=open><summary>Example</summary><p><a href=../Components/#itemedit>ItemEdit</a></p> </details> </details> <h2 id=europegeo><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/europe.geo.js>europe.geo</a><a class=headerlink href=#europegeo title="Permanent link">&para;</a></h2> <details class=explanation open=open><summary>Explanation</summary><p>Representing the European country borders.</p> </details> <details class=explanation><summary>countryBorders</summary><p>Object that contains the borders of the European countries plus a bit of additional information in <a href=http://geojson.org>geojson</a> format.</p> <details class=example open=open><summary>Example</summary><p><a href=https://github.com/Dans-labs/dariah/blob/master/static/tools/country_compose/countries.ipynb>Jupyter notebook</a> shows where this data comes from and how it has been tweaked for this website.</p> </details> </details> <h2 id=fields><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/fields.js>fields</a><a class=headerlink href=#fields title="Permanent link">&para;</a></h2> <details class=explanation open=open><summary>Explanation</summary><p>Functions to deal with field specifications.</p> </details> <details class=explanation><summary>checkDisabled</summary><p>Checks whether a certain value is inactive and should be disabled. See <a href=../Dux/#workflow>workflow logic</a> . Used in component <a href=../Components/#relselect>RelSelect</a> .</p> </details> <details class=explanation><summary>dealWithProvenance</summary><p>Remove provenance fields if current settings require that. See <a href=../Dux/#settings>settings</a> . Used in component <a href=../Components/#itemcontainer>ItemContainer</a> and others.</p> </details> <details class=explanation><summary>itemEditField</summary><p>Render an edit field in standard presentation, like <a href=../Components/#itemedit>ItemEdit</a> does it. In fact, ItemEdit uses this very function to render its editable fields.</p> <p>This function can be conveniently used in custom templates to render some fields in the standard way.</p> <details class=example open=open><summary>Example</summary><p><a href=../../Functionality/Templates/ >Templates</a></p> </details> </details> <details class=explanation><summary>itemReadField</summary><p>Render an read-only field in standard presentation, like <a href=../Components/#itemread>ItemRead</a> does it. In fact, ItemRead uses this very function to render its read-only fields.</p> <p>This function can be conveniently used in custom templates to render some fields in the standard way.</p> <details class=example open=open><summary>Example</summary><p><a href=../../Functionality/Templates/ >Templates</a></p> </details> </details> <details class=explanation><summary>makeFields</summary><p>Prepare field components for an item of a table. Collect the specs from the <code>fieldOrder</code> and <code>fieldSpecs</code> fields of the <a href=../../Concepts/Model/ >data model</a> and put all information in an array objects, each corresponding to a field, from which components can easily construct a widget for showing or editing that field.</p> <details class=example open=open><summary>Example</summary><p><a href=../Components/#itemform>ItemForm</a></p> </details> </details> <details class=explanation><summary>someEditable</summary><p>Checks whether a list of fields contains at least one that the current user may edit.</p> <details class=example open=open><summary>Example</summary><p><a href=../Components/#itemform>ItemForm</a></p> </details> </details> <details class=explanation><summary>toFieldInfo</summary><p>Reduces the information in the fragments produced by <a href=#makefields>makeFields</a> to a simple object with only the value(s) of that field.</p> <details class=example open=open><summary>Example</summary><p><a href=../Components/#itemread>ItemRead</a> to pass an argument to <a href=#applytemplate>applyTemplate</a></p> </details> </details> <h2 id=handle><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/handle.js>handle</a><a class=headerlink href=#handle title="Permanent link">&para;</a></h2> <details class=explanation open=open><summary>Explanation</summary><p>Construct event handle functions.</p> <details class=explanation><summary>Why do this?</summary><p>It is tempting to pass callbacks to React components as arrow functions, like this:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=o>&lt;</span><span class=nx>MyComp</span>
    <span class=nx>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>event</span> <span class=p>=&gt;</span> <span class=nx>handle</span><span class=p>(</span><span class=nx>event</span><span class=p>)}</span>
<span class=err>/&gt;</span>
</pre></div> </td></tr></table> <p>The problem with this is that the <code>event =&gt; handle(event)</code> creates a brand new function object every time <code>&lt;MyComp/&gt;</code> is being rendered.</p> <p>This is not incorrect, but it is a burden for the garbage collector, especially when your component is part of a list item in a big list.</p> <p>It is much better to defined a fixed function elsewhere, and pass it to <code>&lt;MyComp&gt;</code>.</p> <p>But what if the callback is dependent on some parameters, that depend on its instances? For example, if the callback has to be passed to the items of a list, and cause the showing of hiding of individual list items? You could do it like this:</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>const</span> <span class=nx>handleItem</span> <span class=o>=</span> <span class=nx>item</span> <span class=p>=&gt;</span> <span class=nx>event</span> <span class=p>=&gt;</span> <span class=nx>handle</span><span class=p>(</span><span class=nx>event</span><span class=p>,</span> <span class=nx>item</span><span class=p>)</span>

<span class=nx>items</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>item</span> <span class=p>=&gt;</span>
    <span class=o>&lt;</span><span class=nx>MyComp</span>
        <span class=nx>onClick</span><span class=o>=</span><span class=p>{</span><span class=nx>handleItem</span><span class=p>(</span><span class=nx>item</span><span class=p>)}</span>
    <span class=o>/&gt;</span>
<span class=p>)</span>
</pre></div> </td></tr></table> <p>As it stands, this suffers from the same problem, because for every item a fresh bound function object is allocated. And if the list is rendered twice, the second time results in completely new function objects.</p> <p>The solution is to use a <a href=#memo>memoized</a> version of <code>handleItem</code>.</p> </details> <p>The following functions are conveniences for doing exactly that.</p> </details> <details class=explanation><summary>handle</summary><p>Arguments: <code>(dispatch, actionCreator, actionArgs)</code></p> <p>This is a memoized action <em>creator</em> wrapper. It return a function, that can be called with an event. After receiving the event, the passed <code>actionCreator</code> will be called with the given arguments to produce an action. Subsequently, this action will be <em>dispatched</em> to the store that holds the state, which will result in the intended state change.</p> <p>This particular function <code>handle</code> will not use the information in the event. It takes trouble to neutralize the event instead. If there is relevant information in the event, use one of the following functions.</p> </details> <details class=explanation><summary>handlE</summary><p>Like <code>handle</code>, and the information in the event is not used, but the default behaviour of the event and its propagation are not suppressed.</p> </details> <details class=explanation><summary>handlEV</summary><p>Like <code>handle</code>, but now the <code>event.target.value</code> is passed the actionCreator as final argument.</p> </details> <h2 id=memo><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/memo.js>memo</a><a class=headerlink href=#memo title="Permanent link">&para;</a></h2> <details class=explanation open=open><summary>Explanation</summary><p>Our home-grown memoization function.</p> </details> <details class=explanation><summary>makeSet</summary><p>We use plain objects, including <code>Array</code>s for all things on the state. But what if your component prefers the data as a <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set>Set</a> ? Well, it is easy to turn an object into a <code>Set</code>. But if you do it twice, based on an identical state, you get two copies of the same set, which is a waste. Here memoization is a solution. <code>makeSet</code> is a memoized function that takes an array and returns its values as a <code>Set</code>.</p> </details> <details class=explanation><summary>memoize</summary><p>Turns the function <code>f</code> into a memoized function <code>memF</code> that yields the same results for the same parameters. It stores computed results under a key dependent on the parameters for which the result is computed. When the function is called with the same parameters again, it delivers its result from cache, rather than to recompute it.</p> <p>In development mode, if you call the memoized function without arguments, it sends usage information to the console: the number of times it has computed a result and the number of times it has retrieved a result from cache.</p> <details class=note><summary>Comparison with <code>reselect</code></summary><p>In many cases, the <a href=https://github.com/reactjs/reselect>reselect</a> library is all we need for the memoization of <em>selector functions</em>. However, if you want to bind a callback function to concrete arguments, e.g. in <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/app/components/InputMulti.jsx>InputMulti</a> , you need more powerful memoization, such as <code>memoize</code> here.</p> </details> <details class=explanation><summary>from arguments to key</summary><p>However, a naive implementation of memoize has a big drawback. In order to store a function result obtained when computing the function on the basis of a list of arguments, you need to come up with key under which to store those results. This key must be computed from the list of arguments, and the computation of the key should not take more time than bluntly computing the function in question.</p> <p>The most common way of computing a key from arguments is to <code>JSON.stringify</code> them.</p> <p>However, many of the functions we need to memoize, take a slice of the state as argument. That can be a big object, e.g. <code>tables</code>, which hold all data that the app has downloaded from the server in the current section.</p> <p>In those cases it will not do to stringify the argument. Rather we fall back on object identity: we use a <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap>WeakMap</a> , which seems to have been designed exactly for this purpose. However, it is not immediately obvious how to use this solution if you have more than one argument, and if you mix non-object values and functions with real objects.</p> <p>These problems can be solved, and <code>memoize()</code> has evolved into a flexible memoizer for all kinds of situations. What you can do with it is to stringify a shallow to-level structure of an object, to a given depth, and from then on work with object identity and WeakMaps. You can also forego object identity altogether and use solely stringify, which is often the most efficient solution.</p> <details class=note><summary>tests</summary><p>We have built quite a few <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/test/memo.js>tests</a> to verify the logic and the performance of this memoizer.</p> </details> <details class=note><summary>cache clearing</summary><p>The flip-side of a memoizer is that you end-up with a lot of obsolete function results, that will never be used again. Especially when one of the arguments is a slice of the state, the corresponding result will be outdated as soon as that slice of the state has undergone an update. Even if it will revert to the same state later on, it will be a different object.</p> <p>To prevent a needless clutter of obsolete computation results, the cache will be emptied periodically. By default, every result will live at most 30 minutes after having been created, but this is configurable.</p> <details class=note><summary>why WeakMap?</summary><p>This brings us to the reason why we use WeakMap and not the more versatile <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map>Map</a> data structure. For <code>Map</code> does not suffer the constraint that keys must be objects, so if your arguments are a mixture of objects and non-objects, <code>Map</code> seems the obvious choice.</p> <p>However, if your Map key is a big object, the object can not be garbage collected as long as it is part of the map. That is a pity, because the only information we need of this object is its identity as an object, not its complete value. Think again of the <code>tables</code> slice of the state. It keeps changing when users fetch or change data, so memoized functions that use <code>tables</code> will cling to many successive copies of this state. Despite the fact that these copies share most of their data, this hampers a smooth garbage collection process.</p> <p>WeakMaps do not cling to the objects that act as their keys. They somehow store the identity of their key objects, without claiming the continued existence of them.</p> </details> </details> </details> <details class=abstract><summary>Usage</summary><table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4
5
6</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=kr>const</span> <span class=nx>baseFunction</span> <span class=o>=</span> <span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>,</span> <span class=nx>z</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>expensiveResult</span>

<span class=kr>const</span> <span class=nx>memBaseFunction</span> <span class=o>=</span> <span class=nx>memoize</span><span class=p>(</span><span class=nx>baseFunction</span><span class=p>,</span> <span class=nx>levels</span><span class=p>,</span> <span class=nx>config</span><span class=p>)</span>

<span class=nx>memBaseFunction</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=c1>// computes baseFunction(a, b, c)</span>
<span class=nx>memBaseFunction</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=c1>// retrieves baseFunction(a, b, c) from cache instead of computing it</span>
</pre></div> </td></tr></table> </details> <details class=abstract><summary>level</summary><p>If the <code>level</code> paramter is <code>null</code> or <code>undefined</code>, all arguments will be stringified in one go.</p> <p>If <code>levels</code> is an empty object, all object arguments will be treated by object identity.</p> <p>Otherwise, <code>levels</code> should be an object, keyed by argument position and valued by level.</p> <p>If you specify a level for argument <code>n</code>, it means that argument <code>n</code> contributes to the memo key in the following way:</p> <ul> <li>level <em>-1</em>: JSON stringify it</li> <li>level <em>0</em>: use the object identity of it as key in a <code>WeakMap</code></li> <li>level <em>i+i</em>: JSON stringify the top <em>i</em> levels of it; everything from level <em>i+1</em> onwards is treated by object identity.</li> </ul> <details class=note><summary>function arguments</summary><p>N.B: <em>Function arguments</em> can not be stringified, they always go by way of object identitiy.</p> </details> <details class=example open=open><summary>Example</summary><p><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/test/memo.js>test suite</a></p> </details> </details> <details class=abstract><summary>config</summary><p>The <code>config</code> parameter takes the following keys:</p> <ul> <li><code>clearCache</code>: time in seconds that a key is being retained in the memCache</li> <li><code>debug</code>: <code>string</code>: when the memoized function computes a result, retrieves it from cache, or cleares it from cache, the debug string will be output through <code>console.warn</code>. Only in development mode! It is also possible to add extra bits of debugging information, by adapting the <code>debugStyle</code> object in the <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/memo.js>source code</a> .</li> </ul> </details> <details class=caution><summary>big parameters</summary><p>If you memoize a function that takes big objects as parameters, and you forget to specify that those arguments must be treated by object identity, you may hit a murderous performance penalty. I did forget it and the function involved computed related values for given identifiers, and in order to find those values it needed to receive the <code>tables</code> slice of the state. As a consequence, opening a contribution record within the list of all contributions, took a full 3 seconds. It took me long to pinpoint the memoizer as the root cause of this particular slowness. The built-in profiler in Chrome showed it to me.</p> </details> </details> <h2 id=templates><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/templates.js>templates</a><a class=headerlink href=#templates title="Permanent link">&para;</a></h2> <details class=explanation open=open><summary>Explanation</summary><p>This library contains templates that customize the presentation of records and fields. See <a href=../../Functionality/Templates/ >Templates</a> for how the template system is structured. This library contains the functions to <em>apply</em> templates.</p> </details> <details class=explanation><summary>applyInsertTemplate</summary><p>Applies a template for the <em>insert record</em> button for a list. This template cannot have field values, because it is for a whole list of records. However, it is invoked by lists that are detail lists, and hence there is a master record. This template has access to the fields of that master record. It is invoked in <a href=../Components/#editinsert>EditInsert</a> components.</p> </details> <details class=explanation><summary>applyTemplate</summary><p>Applies a read only template. You can merge a template with <a href=../Components/#fieldread>FieldRead</a> components.</p> </details> <details class=explanation><summary>applyEditTemplate</summary><p>Applies an edit template. There is a bit of extra data here compared to read-only templates, namely whether fields are editable or not. You can merge a template with <a href=../Components/#fieldread>FieldRead</a> components, as well as with <a href=../Components/#fieldedit>FieldEdit</a> components.</p> <p><strong>Examples</strong>: <a href=../Components/#itemread>ItemRead</a> <a href=../Components/#itemedit>ItemEdit</a></p> <p>See also <a href=../../Functionality/Templates/ >Templates</a> .</p> </details> <details class=explanation><summary>editMode</summary><p>This function computes a test function for a record, and the test function is customized per table, in the same way as templates are customized per table.</p> <p>Per table you can define any function, and in doing so you are given the information which fields are empty.</p> <p>In practice we use this function to determine whether we start the presentation of a record in read-only mode or in edit mode.</p> <p><strong>Example</strong> In <a href=../Components/#listplain>ListPlain</a> we invoke this function to determine the <code>startMode</code> function, which computes for each record a choice between alternatives (edit mode or read-only mode), called <code>thisStartMode</code>.</p> <p>When ListPlain is called to display the <code>criteriaEntry</code> detail records of an <code>assessment</code> record, a test function is invoked, defined in <a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/app/tables/criteriaEntry.js>criteriaEntry</a> telling to return <code>1</code> if the <code>score</code> is empty or if the <code>evidence</code> is empty. Alternative <code>1</code> corresponds to edit mode.</p> <p>So, whenever a <code>criteriaEntry</code> record is certainly incomplete, it will be opened in edit mode. If it is possibly complete, it will be opened in read-only mode.</p> </details> <h2 id=utils><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/utils.js>utils</a><a class=headerlink href=#utils title="Permanent link">&para;</a></h2> <details class=explanation open=open><summary>Explanation</summary><p>Lower level utility functions.</p> </details> <details class=explanation><summary>combineSelectors</summary><p>Arguments: <code>(...selectors)</code></p> <p>Given a list of <em>selector</em> functions, creates a combined selector that returns an object containing the results of the individual selectors. This function uses the <em>reselect's</em> <a href=https://github.com/reactjs/reselect#createselectorinputselectors--inputselectors-resultfunc>createSelector</a> . We use it quite often when components need multiple sections of the state.</p> </details> <details class=explanation><summary>emptyX (S A O F)</summary><table> <thead> <tr> <th>name</th> <th>thing</th> </tr> </thead> <tbody> <tr> <td><code>emptyA</code></td> <td>Array</td> </tr> <tr> <td><code>emptyF</code></td> <td>Function</td> </tr> <tr> <td><code>emptyO</code></td> <td>Object</td> </tr> <tr> <td><code>emptyS</code></td> <td>String</td> </tr> <tr> <td><code>emptySet</code></td> <td>Set</td> </tr> </tbody> </table> <details class=explanation open=open><summary>Explanation</summary><p>Many objects get created during rendering and re-rendering. If we render a list of thousand entries, and we pass each item component a property with a value like</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=nx>details</span><span class=o>=</span><span class=p>{</span><span class=nx>details</span> <span class=o>||</span> <span class=p>{}}</span>
</pre></div> </td></tr></table> <p>then thousand instances of an empty object will be created and need to be garbage collected soon after that. But if we are interested in the value of the empty object, without an intention to modify it, this is an utter waste.</p> <p>Therefore we declare a few <em>empty</em> concepts:</p> <p>We also</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=p>[</span><span class=nx>freeze</span><span class=p>](</span><span class=nx>https</span><span class=o>:</span><span class=c1>//developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze)</span>
</pre></div> </td></tr></table> <p>them, so that we cannot inadvertently mutate them.</p> <p>The contract with ourselves is: do not ever use one of</p> <table class=codehilitetable><tr><td class=linenos><div class=linenodiv><pre><span></span>1
2
3
4</pre></div></td><td class=code><div class=codehilite><pre><span></span><span class=s1>&#39;&#39;</span>
<span class=p>[]</span>
<span class=p>{}</span>
<span class=nx>x</span> <span class=p>=&gt;</span> <span class=nx>x</span>
</pre></div> </td></tr></table> <p>if you need an empty value, but use an <code>empty</code><em>X</em> (<em>X</em> in <code>S</code>, <code>A</code>, <code>O</code>, <code>F</code>) instead.</p> </details> </details> <details class=explanation><summary>getUrlParts</summary><p>Analyse URLs in order to extract a part <code>/item/</code><em>itemID</em> from it (if present).</p> <p>This is needed if we open and close items in a list and want the URL to reflect that.</p> <details class=example open=open><summary>Example</summary><p><a href=../Components/#listplain>ListPlain</a></p> </details> </details> <details class=explanation><summary>jString</summary><p>When we need the value of an object as a key, for example when we <a href=#memo>memoize</a> functions, the most straightforward way is to <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify>JSON.stringify</a> that object (if it is not forbiddingly large). But this has one defect: the order in which the keys of objects are serialized is not fixed. So two results of a stringify of objects with the same value can be different, due to different orders of keys.</p> <p>Our function <code>jString</code> fixes that. It is a bit more expensive to run than the plain <code>JSON.stringify</code>, but the penalty of not using it has the consequence that we fail to detect the equality of objects, which results in spurious re-rendering of components. If that happens too often, the cost adds up or even multiplies quickly.</p> </details> <details class=explanation><summary>makeReducer</summary><p>Arguments: <code>(flows, init)</code></p> <p>Given an object of <em>flows</em> and an initial state, returns a <em>reducer</em> function. The <em>flows</em> is an object with functions, named after <em>actions</em>. These functions define how a new state must be produced when an action has been <em>dispatched</em>.</p> <p>This function helps to write down complex reducer function as small components with a clean syntax.</p> </details> <details class=explanation><summary>max</summary><p>Returns the maximum of an array of numbers. If the array is empty, return negative infinity.</p> </details> <details class=explanation><summary>min</summary><p>Returns the minimum of an array of numbers. If the array is empty, return positive infinity.</p> </details> <details class=explanation><summary>propsChanged</summary><p>Arguments: <code>(newProps, need, oldProps, keyPropNames)</code></p> <p>Determines whether <code>newProps</code> differ significantly from <code>oldProps</code>, based on the props with <code>keyPropNames</code> only. If the props are sufficiently changed, it uses the <code>need</code> function to finally determine whether the change should result in an action.</p> </details> <details class=explanation><summary>sum</summary><p>Returns the sum of an array of numbers. If the array is empty, return <code>0</code>.</p> </details> <details class=explanation><summary>updateAuto</summary><p>The <code>update()</code> function of the <a href=https://github.com/kolodny/immutability-helper>Immutability-Helper module</a> is great. But one thing is a bit clumsy: it does not have <a href=https://en.wikipedia.org/wiki/Autovivification>auto-vivification</a> . The documentation points to a <a href=https://github.com/kolodny/immutability-helper#autovivification>way out</a> , but the code for that becomes tedious quickly.</p> <p>The idea, however, is right, and this function is a variant of the <code>update()</code> function with auto vivification.</p> </details> <details class=explanation><summary>withParams</summary><p>Arguments: <code>(Component)</code></p> <p>Higher order function that turns a Component (which is a function) into another component.</p> <p>The outgoing component is identical to the incoming one, except that you can offer the outgoing component its properties in a slightly different form. Instead of offering properties <code>foo</code>, <code>bar</code>, it is also possible to offer it property <code>{ params: { foo, bar } }</code>.</p> <p>Put otherwise: the resulting component spreads its <code>params</code> alongside the rest of its properties.</p> <p>We also do this for <code>route</code>, like <code>params</code>.</p> <p>This function is useful for components that occur as component on a route in <a href=../Components/#main>main</a> on the one hand, but are also used as ordinary children that receive props from parents. In the first case, it receives some properties as <code>params</code>.</p> <p>When we write our components, we do not want to care about this, hence we wrap them as <code>withParams(Component)</code>.</p> </details> <h2 id=values><a href=https://github.com/Dans-labs/dariah/blob/master/client/src/js/lib/values.js>values</a><a class=headerlink href=#values title="Permanent link">&para;</a></h2> <details class=explanation open=open><summary>Explanation</summary><p>This is a library of functions that produce formatted representations of values from the database.</p> </details> <details class=explanation><summary>composeAttributes</summary><p>When composing a Field component for an item, compute attributes telling whether the item is active or not, and merge them into the other attributes. Used in component <a href=../Components/#relselect>RelSelect</a> .</p> </details> <details class=explanation><summary>getValType</summary><p>Arguments: <code>(valType)</code></p> <p>For a given value type, such as <code>text</code>, <code>URL</code>, <code>number</code>, return a component and subtype for handling the input of such values, e.g. <code>&lt;input type="URL" /&gt;</code>.</p> <details class=example open=open><summary>Example</summary><p><a href=../Components/#fieldedit>FieldEdit</a></p> </details> </details> <details class=explanation><summary>wrappedRepr</summary><p>Produces a representation for a field value, complete with surrounding elements and attributes. Values of link fields will be wrapped in <code>&lt;a href="..."&gt;</code> elements,</p> <p>Used in <a href=../Components/#fieldread>FieldRead</a> .</p> </details> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../Dux/ title=Dux class="md-flex md-footer-nav__link md-footer-nav__link--prev head-type" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> Dux </span> </div> </a> <a href=../../Technology/Tech/ title=Tech class="md-flex md-footer-nav__link md-footer-nav__link--next head-type" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> Tech </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-disclaimer> The content of this site is produced under responsibility of project <b>Dans-labs/dariah</b> and is subject to change. </div> <div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> customised by <a href=https://github.com/Dans-labs>Dans-labs</a> </div> </div> <div class=md-footer-dans> <div>DANS is an institute of KNAW and NWO</div> <div> <a href=https://dans.knaw.nl/en title="Data Archiving and Networked Services (DANS)"><img class=md-footer-dans__img src=../../assets/images/DANS.gif height=50></a> <a target=_blank href=https://www.knaw.nl/en><img src=../../assets/images/knaw.png height=50></a> <a target=_blank href=https://www.nwo.nl/en><img src=../../assets/images/nwo.png height=50></a> </div> <div><i>Driven by data</i></div> </div> <link rel=stylesheet href=../../assets/fonts/font-awesome.css> <style>.md-footer-social__desc{font-family:"Open Sans",sans-serif;-webkit-font-smoothing:auto}</style> <ul class=md-footer-social> <li class=md-footer-social__li> <a href=http://eepurl.com/dvnr8D class="md-footer-social__link fa fa-envelope-square"> <span class=md-footer-social__desc>Newsletter</span> </a> </li> <li class=md-footer-social__li> <a href=https://twitter.com/DANSKNAW class="md-footer-social__link fa fa-twitter-square"> <span class=md-footer-social__desc>Twitter</span> </a> </li> <li class=md-footer-social__li> <a href=https://www.youtube.com/user/DANSDataArchiving class="md-footer-social__link fa fa-youtube-square"> <span class=md-footer-social__desc>YouTube</span> </a> </li> <li class=md-footer-social__li> <a href=https://www.linkedin.com/company/dans class="md-footer-social__link fa fa-linkedin-square"> <span class=md-footer-social__desc>LinkedIn</span> </a> </li> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.f780ca69.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> </body> </html>