!function t(e,i,s){function n(r,o){if(!i[r]){if(!e[r]){var l="function"==typeof require&&require;if(!o&&l)return l(r,!0);if(a)return a(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[r]={exports:{}};e[r][0].call(h.exports,function(t){var i=e[r][1][t];return n(i?i:t)},h,h.exports,t,e,i,s)}return i[r].exports}for(var a="function"==typeof require&&require,r=0;r<s.length;r++)n(s[r]);return n}({1:[function(t,e,i){"use strict";function s(t,e,i){this.name=t,this.page=i,this.specs=e,this.variants=e.variants,this._stage={};for(var s in this.variants){this._stage[s]={};for(var n in this.page.stages)this._stage[s][n]=!0}this.msg={},this.container={},this.state=this.page.state,this.data={},this.related_values={},this.ids_fetched={},this.implementation=new e.specific(this)}var n=t("./generic.js"),a=t("./message.js");s.prototype={need:function(t,e){return!this._stage[t][e].state||"rejected"==this._stage[t][e].state()},_deed:function(t,e,i){var s=this[i].bind(this,t),n=this.page.getBefore(this.name,e),a=[];n.forEach(function(e){var i=e[0],s=e[1],n=this.page.getComponent(i);n.hasVariant(t)&&a.push(n._stage[t][s])},this),this._stage[t][e]=$.when.apply($,a).then(s)},ensure:function(t,e,i){if(e in this.page.stages){var s=this.page.stages[e]&&!this.specs.by_id;s&&!this.need(t,e)||this._deed(t,e,i)}},hasVariant:function(t){return t in this.variants},_visibility:function(t,e){this.hasVariant(t)&&t in this.container&&(e?this.container[t].show():this.container[t].hide())},_fetch:function(t,e){var i=url_tpl.replace(/_c_/,"data").replace(/_f_/,this.specs.fetch_url+"_"+t)+".json";this.msg[t].msg("fetching data ...");var s=this._postFetch.bind(this,t);return void 0!=e&&(i+="?ids="+e.join(",")),$.ajax({type:"POST",url:i,contentType:"application/json; charset=utf-8",dataType:"json"}).then(function(t){s(t,e)})},_postFetch:function(t,e,i){this.msg[t].clear(),e.msgs.forEach(function(e){this.msg[t].msg(e)},this),e.good&&(this.data[t]=e.data,this.specs.by_id&&console.log(e.data),"relvals"in e&&(this.related_values[t]=e.relvals),this.specs.by_id&&i.forEach(function(t){this.ids_fetched[t]=!0},this)),this.implementation.weld(t)},_weld:function(t){if(this._dst=this.page.getContainer(this.specs.dest,this.variants),this.specs.by_id){if(!(t in this.msg)){var e=this._dst[t];e.prepend('<div id="msg_'+this.name+"_"+t+'"></div>'),this.msg[t]=new a("msg_"+this.name+"_"+t)}}else{if(this.container[t]=$("#"+this.name+"_"+t),0==this.container[t].length){var e=this._dst[t];e.append('<div id="msg_'+this.name+"_"+t+'"></div>'),e.append('<div id="'+this.name+"_"+t+'" class="component"></div>'),this.container[t]=$("#"+this.name+"_"+t)}this.msg[t]=new a("msg_"+this.name+"_"+t)}if(null!=this.specs.fetch_url){var i=[];if(!this.specs.by_id)return this._fetch(t);var s=n.from_str(this.state.getState(this.specs.fetch_url+"_"+t));for(var r in s)r in this.ids_fetched||i.push(r);if(console.log("ids to fetch "+this.name+" - "+t,i),0!=i.length)return this._fetch(t,i)}else this.implementation.weld(t)},_wire:function(t){this.implementation.wire(t)},_work:function(t){this._visibility(t,!0),this.implementation.work(t)},weld:function(t){this.hasVariant(t)&&this.implementation.show(t)&&this.ensure(t,"weld","_weld")},wire:function(t){this.hasVariant(t)&&this.implementation.show(t)&&this.ensure(t,"wire","_wire")},work:function(t){this.hasVariant(t)&&this.implementation.show(t)?this.ensure(t,"work","_work"):this._visibility(t,!1)}},e.exports=s},{"./generic.js":7,"./message.js":11}],2:[function(t,e,i){"use strict";function s(t){this.component=t,this.widget={},this.ctl={}}s.prototype={_html:function(t){this.component.container[t].html('<a class="control_title" href="#">'+this.component.state.showState("list",t,"sg")+"</a> ")},_dressup:function(t){this.ctl[t].click(function(e){e.preventDefault(),this.component.state.setState("list",t)}.bind(this))},_isActive:function(t){return this.component.state.getState("list")==t},show:function(t){return!0},weld:function(t){this._html(t),this.widget[t]=this.component.container[t],this.widget[t].addClass("control_big"),this.ctl[t]=this.component.container[t].find("a")},wire:function(t){this._dressup(t)},work:function(t){this._isActive(t)?(this.ctl[t].addClass("ison"),this.widget[t].addClass("ison")):(this.ctl[t].removeClass("ison"),this.widget[t].removeClass("ison"))}},e.exports=s},{}],3:[function(t,e,i){"use strict";function s(t){n.call(this,t,"type")}var n=t("./relative.js");s.prototype=Object.create(n.prototype),s.prototype.constructor=s,e.exports=s},{"./relative.js":13}],4:[function(t,e,i){"use strict";function s(t){a.call(this,t,"country"),this._map_object={},this._map_container={},this._marker={},this._setvalues={},this._not_mapped={"-":!0,CY:!0,KS:!0,TR:!0,MC:!0,GE:!0}}var n=t("./generic.js"),a=t("./relative.js");s.prototype=Object.create(a.prototype),s.prototype.constructor=s,s.prototype._preHtml=function(t){return'<div id="map-europe_'+t+'" class="position"><p class="zoom"><a class="fa fa-arrows" href="#" title="zoom to fit all countries"/></p></div>'},s.prototype._myDressup=function(t){var e=this,i=this.component.container[t];this._map_container[t]=i.find("#map-europe_"+t);var s=.6*this._map_container[t].width();this._map_container[t].width("100%"),this._map_container[t].height(s),this._map_container[t].vectorMap({map:"europe_mill",backgroundColor:"#ccccff",regionsSelectable:!0,markersSelectable:!0,regionsSelectableOne:!1,markersSelectableOne:!1,markerStyle:{initial:{fill:"#008800","fill-opacity":.2,stroke:"none","stroke-width":0,"stroke-opacity":.2,r:1},hover:{cursor:"pointer",stroke:"#ffff44","stroke-width":1,"stroke-opacity":1},selected:{fill:"#008800","fill-opacity":1},selectedHover:{}},regionStyle:{initial:{fill:"#bbbbbb","fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":1},hover:{cursor:"pointer",stroke:"#ffff44","stroke-width":3,"stroke-opacity":1},selected:{fill:"#dd8844","fill-opacity":1},selectedHover:{}},markers:this._marker[t],series:{markers:[{values:{},scale:[0,20],normalizeFunction:"linear",attribute:"r",min:0,max:100}],regions:[{scale:{outdariah:"#ffffff",indariah:"#ffddbb"},attribute:"fill",values:this._setvalues[t]}]},onRegionTipShow:function(e,i,s){i.html(s+": "+(s in this._statistics[t]?this._statistics[t][s]:"not in DARIAH"))}.bind(this),onMarkerTipShow:function(e,i,s){i.html(s+": "+(s in this._statistics[t]?this._statistics[t][s]:"not in DARIAH"))}.bind(this),onRegionClick:function(e,i){i in this._related_values_index[t]||e.preventDefault()}.bind(this),onMarkerClick:function(e,i){i in this._related_values_index[t]||e.preventDefault()}.bind(this),onRegionSelected:function(e,i,s,a){this.change_state&&this.component.state.setState("rel_"+this._type+"_"+t,n.a_to_str(a)+this._unmapped_selected(t))}.bind(this),onMarkerSelected:function(e,i,s,a){this.change_state&&this.component.state.setState("rel_"+this._type+"_"+t,n.a_to_str(a)+this._unmapped_selected(t))}.bind(this)});var a=i.find("p.zoom");a.css("top",s-20+"px"),a.css("left","10px");var r=i.find("p.zoom a");r.click(function(i){i.preventDefault(),e._map_object[t].setFocus({regions:["GB","GR"]})}),this._map_object[t]=this._map_container[t].vectorMap("get","mapObject"),this._map_object[t].setFocus({regions:["GB","GR"]})},s.prototype._unmapped_selected=function(t){var e=[],i=this._from_str(t,this.component.state.getState("rel_"+this._type+"_"+t)),s=!0;for(var n in this._not_mapped)n in i&&i[n]&&(e.push(n),s=!1);return s?"":","+e.join(",")},s.prototype._mySetFacet=function(t,e){this.change_state=!1;var i={};for(var s in e)s in this._not_mapped||s==this._no_values.value||(i[s]=e[s]);this._map_object[t].setSelectedRegions(i),this._map_object[t].setSelectedMarkers(i),this.change_state=!0},s.prototype._myStats=function(t){var e=this.distilled[t].length;0==e&&(e=1);var i={};for(var s in this._statistics[t])if(s!=this._no_values.value){var n=100*this._statistics[t][s]/e;i[s]=10>e?n:10*Math.sqrt(n)}this._map_object[t].series.markers[0].setValues(i)},s.prototype._plainWeld=function(t){},s.prototype._myWeld=function(t){this._marker[t]={},this._setvalues[t]={};var e=this.component.related_values[t];for(var i in e){var s=e[i];s[1]?(this._related_values_off[t][i]=!1,this._related_values_on[t][i]=!0,this._related_values_list[t].push(i),this._related_values_index[t][i]=s[0],s.length>3&&(this._marker[t][i]={latLng:[s[2],s[3]],name:s[0]}),this._setvalues[t][i]="indariah"):this._setvalues[t][i]="outdariah"}this._related_values_list[t].sort(function(t,i){return e[t]<e[i]?-1:e[t][0]>e[i][0]?1:0})},e.exports=s},{"./generic.js":7,"./relative.js":13}],5:[function(t,e,i){"use strict";function s(t){this.component=t,this._stats={},this.data={},this.table={},this.distilled={},this.enabled_facets={}}var n=t("./generic.js");s.prototype={_html:function(t){var e="";e+='<p><span fct="all"></span>Filtering <span id="fstats_'+t+'"></span></p>',this.component.container[t].html(e)},show:function(t){return this.component.state.getState("list")==t},weld:function(t){var e=this.component.children;this.enabled_facets[t]={};for(var i in e){var s=e[i];s.hasVariant(t)&&(this.enabled_facets[t][i]=e[i])}this._html(t)},_display:function(t,e){var i=this,s=t.closest("p"),a=s.find(".hidec"),r=s.find(".morec"),o=s.find(".showc"),l=t.closest("div").find("table,.flt"),c=t.closest("div").find(".value_list2,.flt_compact"),h=t.closest("div").find(".flt_not_expanded"),_="fctx_"+t.closest("span").attr("fct"),f=void 0==e;f&&(e=n.localstorage_vars.isSet(_)?n.localstorage_vars.get(_):1);var d="fctx_all"==_;d&&!f&&t.closest("div").find("div.component span[fct]").each(function(){i._display($(this),e)}),n.localstorage_vars.set(_,e),0==e?(a.show(),r.hide(),o.hide(),d||(h.show(),l.hide(),c.hide())):1==e?(a.hide(),r.show(),o.hide(),d||(h.show(),l.hide(),c.show())):(a.hide(),r.hide(),o.show(),d||(h.hide(),l.show(),c.hide()))},wire:function(t){var e=this,i=this.component.container[t],s=this.component.page.getComponent("list").container[t];this._stats[t]=i.find("#fstats_"+t),this.table[t]=s.find("#table_"+t);var n=" details; click to change level of details",a='<a class="showc fa fa-fw fa-list-ul" href="#" title="full'+n+'"></a><a class="morec fa fa-fw fa-align-left" href="#" title="condensed'+n+'"></a><a class="hidec fa fa-fw fa-minus" href="#" title="hidden'+n+'"></a>';i.addClass("facet"),i.find("span[fct]").each(function(){$(this).html(a+"&nbsp"),e._display($(this))}),i.find(".hidec").click(function(t){t.preventDefault(),e._display($(this),1)}),i.find(".morec").click(function(t){t.preventDefault(),e._display($(this),2)}),i.find(".showc").click(function(t){t.preventDefault(),e._display($(this),0)})},work:function(t){this.table[t].find("tr[id]").hide();var e=this.component.page.getComponent("list"),i=e.data[t],s=this.enabled_facets[t];this.distilled[t]=[];for(var n in s){var a=s[n].implementation;a.distilled[t]=[]}i.forEach(function(e,i){var n=!0,a=null,r=!1;for(var o in s)if(!r){var l=s[o].implementation,c=l.v(t,e[0]);c||(n=!1,null==a?a=l:r=!0)}if(!r)if(n&&(this.distilled[t].push(e[0]),this.table[t].find('tr[id="r'+e[0]+'"]').show()),null!=a)a.distilled[t].push(e[0]);else for(var o in s){var l=s[o].implementation;l.distilled[t].push(e[0])}},this);for(var n in s){var a=s[n].implementation;a.stats(t)}this._stats[t].html(this.distilled[t].length+" of "+i.length)}},e.exports=s},{"./generic.js":7}],6:[function(t,e,i){"use strict";function s(t){this.component=t,this._tags={},this._filter_control={},this._filter_control2={},this._box={},this._completions_dst={},this._stats_dst={},this._clear_filter_control={},this._wire_mode={},this._distilled={},this.distilled={}}s.prototype={_html:function(t){var e='\n<div>\n    <p class="dctrl"><span fct="'+this.component.name+"-"+t+'"></span> By full text search\n        <a href="#" title="modify full text filter" id="flt2_'+t+'" class="flt_not_expanded facet_single ison flt_pat"></a>\n        <a href="#" class="control_med fa fa-close filtc" id="clearf_'+t+'"></a>\n    </p>\n    <div id="fltw_'+t+'">\n        <p id="fbox_'+t+'" class="flt control_med fbox ui-widget">\n            <input id="flt_'+t+'" class="flt flt_pat"/>\n            <span fbox class="stats" id="stats_'+t+'"></span>\n        </p>\n        <div id="autoc_'+t+'" style="display: none;">here '+t+"</div>\n    </div>\n</div>";this.component.container[t].html(e)},_setFilter:function(t){var e=this.component.state.getState("flt_"+t);this._filter_control2[t].html(e),this._filter_control[t].val(e),this._filter_control[t].autocomplete("search",e)},_response:function(t){return function(e,i){if(this._distilled[t]={},i.content.forEach(function(e,i){this._distilled[t][e.value]=1},this),!this._wire_mode[t]){var s=this._filter_control[t].val();this.component.state.setState("flt_"+t,s)}}.bind(this)},_setClear:function(t){this._clear_filter_control[t].click(function(e){e.preventDefault(),this._filter_control[t].val(""),this._filter_control[t].autocomplete("search","")}.bind(this))},stats:function(t){var e;""==this._filter_control[t].val()?(e="",this._stats_dst[t].removeClass("ison")):(e=this.facet.distilled[t].length+" of ",this._stats_dst[t].addClass("ison")),this._stats_dst[t].html(""+e+this.distilled[t].length)},v:function(t,e){return e in this._distilled[t]},show:function(t){return this.component.state.getState("list")==t},weld:function(t){this._html(t)},wire:function(t){this.facet||(this.facet=this.component.page.getComponent("facet").implementation);var e=this.component.page.getComponent("list").data[t];this._tags[t]=[],e.forEach(function(e,i){this._tags[t].push({label:e[1],value:""+e[0]})},this),this._distilled[t]={},this.distilled[t]=[];var i=this.component.container[t],s=i.find("#fltw_"+t),n=$("#flt_"+t);this._filter_control[t]=n;var a=$("#flt2_"+t);this._filter_control2[t]=a,this._box[t]=s.find("#fbox_"+t),this._completions_dst[t]=s.find("#autoc_"+t),this._stats_dst[t]=s.find("#stats_"+t),this._clear_filter_control[t]=i.find("#clearf_"+t),this._filter_control[t].autocomplete({appendTo:this._completions_dst[t],source:this._tags[t],response:this._response(t),minLength:0}),a.click(function(t){t.preventDefault(),$(this).closest("div").find(".morec").click(),n[0].focus()}),this._wire_mode[t]=!0,this._setClear(t),this._setFilter(t),this._wire_mode[t]=!1},work:function(t){var e=this.component.state.getState("flt_"+t);""==e?(this._box[t].removeClass("ison"),this._clear_filter_control[t].hide()):(this._box[t].addClass("ison"),this._clear_filter_control[t].show()),this._filter_control2[t].html(e)}},e.exports=s},{}],7:[function(t,e,i){"use strict";function s(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()}function n(t){if(s(),document.selection){var e=document.body.createTextRange();e.moveToElementText(document.getElementById(t)),e.select()}else if(window.getSelection){var e=document.createRange();e.selectNode(document.getElementById(t)),window.getSelection().addRange(e)}}function a(t,e,i){var s=void 0==e?t.closest("div").find(".detail"):e;s.toggle(),void 0!=i&&i(t);var n,a;t.hasClass("fa-chevron-right")?(n="fa-chevron-right",a="fa-chevron-down"):(n="fa-chevron-down",a="fa-chevron-right"),t.removeClass(n),t.addClass(a)}function r(t,e,i){return i.length>t?i.replace(/[^ -]+/g,function(t){return t.substr(0,e)}):i}function o(t){var e={};if(null!==t&&void 0!=t&&""!=t){var i=t.split(",");i.forEach(function(t){e[t]=!0})}return e}function l(t){return t.join(",")}function c(t){var e=[];for(var i in t)t[i]&&e.push(i);return e.join(",")}var h=function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;"};return function(e){return e.replace(/[&<>]/g,function(e){return t[e]})}}(),_={parameter:function(t){return this.parameters()[t]},parameters:function(t){var e,i,s,n;return n={},t||(t=window.location.search),-1===t.indexOf("?")?{}:(s=t.slice(1),i=s.split("&"),i.forEach(function(t,i){e=t.split("="),n[e[0]]=e[1]}),n)}},f=_.parameters(),d=$.initNamespaceStorage("req"),p=d.localStorage;e.exports.escapeHTML=h,e.exports.request_vars=f,e.exports.localstorage_vars=p,e.exports.selectText=n,e.exports.deselectText=s,e.exports.toggleDetail=a,e.exports.compact=r,e.exports.from_str=o,e.exports.to_str=c,e.exports.a_to_str=l},{}],8:[function(t,e,i){"use strict";function s(t){this.component=t}s.prototype={_html:function(t,e){var i=this.component._dst[t],s=i.find('tr[id="r'+e[0]+'"]');console.log("Finding "+t+" row r"+e[0]+":",s);var n='<tr iid="'+e[0]+'">';if("contrib"==t){var a=[];e[5].forEach(function(t){a.push('<a href="#" tid="'+t[0]+'">'+t[1]+"</a>")}),n+="\n<td>\n<b>Contact person:</b> "+e[2]+"<br/>\n<b>Country:</b> "+e[3]+" = "+e[4]+"<br/>\n<b>Types:</b> "+a.join(", ")+"</br>\n</td>\n"}else"country"==t?this.component.data[t].forEach(function(t){in_dariah=1==t[3]?"dariah":"",n+='<tr id="r'+t[0]+'"><td class="country_code">'+t[1]+'<td><td class="country_name">'+t[2]+'<td><td class="in_dariah">'+in_dariah+'</td><td class="latlng">'+t[4]+'</td><td class="latlng">'+t[5]+"</td></tr>"}):"type"!=t&&"tadiraha"!=t&&"tadiraho"!=t&&"tadiraht"!=t||this.component.data[t].forEach(function(t){n+='<tr id="r'+t[0]+'"><td class="value">'+t[1]+"<td></tr>"});n+="</tr>",console.log(n),s.after(n)},show:function(t){return this.component.state.getState("list")==t},weld:function(t){this.component.data[t].forEach(function(e){this._html(t,e)},this)},wire:function(t){},work:function(t){}},e.exports=s},{}],9:[function(t,e,i){"use strict";function s(t){this.component=t}var n=t("./generic.js");s.prototype={_html:function(t){var e="";e+='<table id="table_'+t+'">',this.component.data[t].forEach(function(i){var s='<tr rid="'+i[0]+'"><td><a class="showc fa fa-fw fa-list-ul" href="#" title="hide fields"></a><a class="hidec fa fa-fw fa-minus" href="#" title="show fields"></a></td>',n="</tr>";"contrib"==t?e+=s+'<td><a href="#" class="fa fa-fw fa-minus"></a>'+i[1]+"</td>"+n:"country"==t?(in_dariah=1==i[3]?"dariah":"",e+=s+'<td class="country_code">'+i[1]+'<td><td class="country_name">'+i[2]+'<td><td class="in_dariah">'+in_dariah+'</td><td class="latlng">'+i[4]+'</td><td class="latlng">'+i[5]+"</td>"+n):"type"!=t&&"tadiraha"!=t&&"tadiraho"!=t&&"tadiraht"!=t||(e+=s+'<td class="value">'+i[1]+"<td>"+n)}),e+="</table>",this.component.container[t].html(e)},_display:function(t,e,i){var s=t.find(".hidec"),n=t.find(".showc"),a=t.attr("rid"),r=this.component.container[e].find('tr[iid="'+a+'"]'),o=a in i&&i[a];o?(s.show(),n.hide(),r.length&&r.show()):(s.hide(),n.hide(),r.length&&r.hide())},_set_it:function(t,e,i){var s=n.from_str(this.state.getState(key)),a=t.closest("tr").attr("rid");s[a]=i,this.state.setState(key,n.to_str(s))},show:function(t){return this.component.state.getState("list")==t},weld:function(t){this._html(t)},wire:function(t){var e=this,i=this.component.container[t];this.component.name+"_"+t;i.find(".hidec").click(function(i){i.preventDefault(),e._set_it($(this),t,!0)}),i.find(".showc").click(function(i){i.preventDefault(),e._set_it($(this),t,!1)})},work:function(t){var e=this,i=(this.component.name+"_"+t,this.component.container[t]),s=n.from_str(this.component.state.getState(this.component.name+"_"+t));i.find("tr[rid]").each(function(){e._display($(this),t,s)})}},e.exports=s},{"./generic.js":7}],10:[function(t,e,i){"use strict";var s=t("./page.js");$(function(){(new s).work()})},{"./page.js":12}],11:[function(t,e,i){"use strict";function s(t,e){this._destination=$("#"+t),this._trash_control=$("#trash_"+t),this._trash_control_para=this._trash_control.closest("p"),this._trash_control.click(function(t){t.preventDefault(),this.clear()}.bind(this)),this._hide(),this._on_clear=e}s.prototype={_hide:function(){this._destination.hide(),this._trash_control_para.hide()},_show:function(){this._destination.show(),""!=this._destination.html()&&this._trash_control_para.show()},clear:function(){this._destination.html(""),void 0!=this._on_clear&&this._on_clear(),this._hide()},msg:function(t,e){void 0==e&&(e="info");var i=this._destination.html();this._destination.html(i+'<p class="'+e+'">'+t+"</p>"),this._show()}},e.exports=s},{}],12:[function(t,e,i){"use strict";function s(){this.name="page",this.msg=new a("msg_"+this.name),this.state=new n(this),this.stages={weld:!0,wire:!0,work:!1},this.stages_prev={wire:"weld",work:"wire"};var t=this.state.getValues("list"),e={contrib:1},i={"":1};this._component_specs={share:{dest:"body",variants:i,fetch_url:null,specific:r},control:{dest:"left",variants:t,fetch_url:null,specific:v},list:{dest:"middle",variants:t,fetch_url:"list",specific:p},item:{dest:"list",variants:t,fetch_url:"item",specific:u},facet:{dest:"control",variants:t,fetch_url:null,specific:d},filter:{dest:"facet",variants:t,fetch_url:null,specific:f},eumap:{dest:"facet",variants:e,fetch_url:"country",specific:_},ctype:{dest:"facet",variants:e,fetch_url:"type",specific:o},tadiraha:{dest:"facet",variants:e,fetch_url:"tadiraha",specific:c},tadiraho:{dest:"facet",variants:e,fetch_url:"tadiraho",specific:l},tadiraht:{dest:"facet",variants:e,fetch_url:"tadiraht",specific:h}},this._by_id={item:!0},this._before={weld:{item:{list:1},facet:{control:1,list:1},filter:{facet:1},eumap:{facet:1,filter:1},ctype:{facet:1,eumap:1},tadiraha:{facet:1,ctype:1},tadiraho:{facet:1,tadiraha:1},tadiraht:{facet:1,tadiraho:1},share:{facet:1,list:1}},wire:{item:{list:1},facet:{filter:1,eumap:1,ctype:1,tadiraha:1,tadiraho:1,tadiraht:1},filter:{list:1},eumap:{list:1},ctype:{list:1},tadiraha:{list:1},tadiraho:{list:1},tadiraht:{list:1}},work:{facet:{filter:1,eumap:1,ctype:1,tadiraha:1,tadiraho:1,tadiraht:1}}},this._ignore={},this.components={};for(var s in this._component_specs)if(!(s in this._ignore)){this._component_specs[s].by_id=s in this._by_id&&this._by_id[s];var g=new m(s,this._component_specs[s],this);g.children={},this.components[s]=g}for(var s in this.components){var y=this.components[s],w=this._component_specs[s].dest;if(w in this.components){var b=this.components[w];b.children[s]=y}}this._resolveTiming(),this._setHeight(80),History.Adapter.bind(window,"statechange",this.state.work())}var n=(t("./generic.js"),t("./viewstate.js")),a=t("./message.js"),r=t("./share.js"),o=t("./ctype.js"),l=t("./tadiraho.js"),c=t("./tadiraha.js"),h=t("./tadiraht.js"),_=t("./eumap.js"),f=t("./filter.js"),d=t("./facet.js"),p=t("./list.js"),u=t("./item.js"),v=t("./control.js"),m=t("./components.js");s.prototype={_setHeight:function(t){var e=window.innerHeight-t+"px";for(var i in{middle:1,left:1,right:1})$("#"+i).css("height",e)},_resolveTiming:function(){function t(t,e){t in i||(i[t]={}),e in s||(s[e]={}),i[t][e]=!0,s[e][t]=!0}var e=[],i={},s={};for(var n in this.components)for(var a in this.stages)e.push(n+"-"+a);for(var r in this.stages_prev){var o=this.stages_prev[r];for(var n in this.components)t(n+"-"+o,n+"-"+r)}for(var a in this._before)for(var l in this._before[a])if(!(l in this._ignore))for(var c in this._before[a][l])c in this._ignore||t(c+"-"+a,l+"-"+a);for(var h=0,_=[],f={};h<=e.length;){if(_.push({}),0==h)e.forEach(function(t){t in s||(_[h][t]=1)});else for(var d in f)if(d in i)for(var p in i[d])if(!(p in f)){var u=!0;for(var v in s[p])if(!(v in f)){u=!1;break}u&&(_[h][p]=1)}if(!Object.keys(_[h]).length)break;for(var m in _[h])f[m]=1;h++}if(this._tasks=[],this._timing={},Object.keys(f).length!=e.length){var g=[];e.forEach(function(t){t in f||g.push(t)}),console.log("Circular timing constraints detected",g)}else _.forEach(function(t,e){for(var i in t)this._tasks.push(i)},this),this._timing=s,console.log("Timing resolved",this._tasks)},getComponent:function(t){return this.components[t]},getContainer:function(t,e){var i={};if(t in this.components)i=this.components[t].container;else{var s="body"==t?$("body"):$("#"+t);for(var n in e)i[n]=s}return i},getBefore:function(t,e){var i=[],s=t+"-"+e;for(var n in this._timing[s]||{})i.push(n.split("-"));return i},work:function(){this._tasks.forEach(function(t){var e=t.split("-"),i=e[0],s=e[1],n=this.getComponent(i);for(var a in n.variants)n[s](a)},this)}},e.exports=s},{"./components.js":1,"./control.js":2,"./ctype.js":3,"./eumap.js":4,"./facet.js":5,"./filter.js":6,"./generic.js":7,"./item.js":8,"./list.js":9,"./message.js":11,"./share.js":14,"./tadiraha.js":15,"./tadiraho.js":16,"./tadiraht.js":17,"./viewstate.js":18}],13:[function(t,e,i){"use strict";function s(t,e,i,s,n){this.component=t,this.distilled={},this._list={},this._list2={},this._related_state={},this._all_values_control={},this._statistics={},this._related_values_list={},this._related_values_index={},this._related_values_on={},this._related_values_off={},this._no_values={value:"-",name:"-none"},this._type=e,this._cols=i||2,this._cutoff=s||14,this._shortsize=n||6}var n=t("./generic.js");s.prototype={_html:function(t){var e=this.component.state.showState("list",this._type,"sg"),i=this.component.state.showState("list",this._type,"pl"),s="";s+=this._preHtml(t),s+='\n<div>\n    <p class="dctrl"><span fct="'+this.component.name+"-"+t+'"></span> By '+e+'</p>\n    <p class="all"><span rv="_all" class="stats"></span> <a rv="_all" href="#" class="facet_single_all">all '+i+'</a></p>\n    <table class="value_list" id="list-'+this._type+"-vals_"+t+'">\n        <tr>\n',this._related_values_list[t].forEach(function(e,i,a){i%this._cols==0&&i>0&&i<a.length&&(s+="</tr><tr>");var r=this._related_values_index[t][e];s+='\n            <td><span rv="'+e+'" class="stats"></span></td>\n            <td><a rv="'+e+'" href="#" class="facet_single">'+n.escapeHTML(r)+"</a></td>\n            "},this),s+='\n        </tr>\n    </table>\n    <p class="value_list2" id="list2-'+this._type+"-vals_"+t+'">\n',this._related_values_list[t].forEach(function(e,i,a){var r=this._related_values_index[t][e],o=n.escapeHTML(n.compact(this._cutoff,this._shortsize,r));s+='<a href="#" rv="'+e+'" class="passive_small" title="'+n.escapeHTML(r)+'">'+o+"</a> "},this),s+="\n    </p>\n</div>",this.component.container[t].html(s)},_dressup:function(t){var e=this.component.container[t];this._list[t]=e.find("#list-"+this._type+"-vals_"+t),this._list2[t]=e.find("#list2-"+this._type+"-vals_"+t);var i=this;this._list[t].find(".facet_single").click(function(s){s.preventDefault();var a=$(this).attr("rv"),r=i._from_str(t,i.component.state.getState("rel_"+i._type+"_"+t));r[a]=a in r?!r[a]:!0,i.component.state.setState("rel_"+i._type+"_"+t,n.to_str(r)),e.find(".last_handled").removeClass("last_handled"),$(this).addClass("last_handled")}),this._list2[t].find(".passive_small").click(function(s){s.preventDefault();var a=$(this).attr("rv"),r=i._from_str(t,i.component.state.getState("rel_"+i._type+"_"+t));r[a]=a in r?!r[a]:!0,i.component.state.setState("rel_"+i._type+"_"+t,n.to_str(r)),$(this).closest("div").find(".morec").click();var o=i._list[t].find('a[rv="'+a+'"]');e.find(".last_handled").removeClass("last_handled"),o.addClass("last_handled"),$("#left")[0].scrollTop=50,o[0].scrollIntoView({behavior:"smooth",alignToTop:"true"})}),this._all_values_control[t]=this.component.container[t].find('[rv="_all"]'),this._all_values_control[t].click(function(e){e.preventDefault();var s=$(this).hasClass("ison");s?i.component.state.setState("rel_"+i._type+"_"+t,n.to_str(i._related_values_off[t])):i.component.state.setState("rel_"+i._type+"_"+t,n.to_str(i._related_values_on[t]))})},_setFacet:function(t,e){var i=!0;for(var s in this._related_values_index[t]){var n=this._list[t].find('[rv="'+s+'"]'),a=this._list2[t].find('[rv="'+s+'"]');s in e&&e[s]?(n.addClass("ison"),a.addClass("ison")):(n.removeClass("ison"),a.removeClass("ison"),i=!1)}i?this._all_values_control[t].addClass("ison"):this._all_values_control[t].removeClass("ison")},_from_str:function(t,e){var i={};if(null!==e&&void 0!=e&&""!=e){var s=e.split(",");s.forEach(function(t){i[t]=!0})}for(var n in this._related_values_index[t])n in i||(i[n]=!1);return i},stats:function(t){this._statistics[t]={};for(var e in this._related_values_index[t])this._statistics[t][e]=0;var i=this.component.data[t];for(var s in this.distilled[t]){var n=this.distilled[t][s],a=!1;for(var e in i[n])this._statistics[t][e]+=1,a=!0;a||(this._statistics[t][this._no_values.value]+=1)}for(var e in this._statistics[t])this.component.container[t].find('span[rv="'+e+'"].stats').html(this._statistics[t][e]);this.component.container[t].find('span[rv="_all"].stats').html(this.distilled[t].length),this._myStats(t)},v:function(t,e){var i=this.component.data[t],s=this._from_str(t,this._related_state[t]);if(e in i&&0!=Object.keys(i[e]).length){for(var n in i[e])if(n in s&&s[n])return!0}else if(this._no_values.value in s&&s[this._no_values.value])return!0;return!1},show:function(t){return this.component.state.getState("list")==t},weld:function(t){this._related_values_list[t]=[],this._related_values_index[t]={},this._related_values_off[t]={},this._related_values_on[t]={},this._plainWeld(t),this._myWeld(t),this._related_values_list[t].push(this._no_values.value),this._related_values_index[t][this._no_values.value]=this._no_values.name,this._related_values_off[t][this._no_values.value]=!1,this._related_values_on[t][this._no_values.value]=!0,this._html(t)},wire:function(t){this._myDressup(t),this._dressup(t)},work:function(t){this._related_state[t]=this.component.state.getState("rel_"+this._type+"_"+t);var e=this._from_str(t,this._related_state[t]);this._mySetFacet(t,e),this._setFacet(t,e)},_plainWeld:function(t){var e=this.component.related_values[t];for(var i in e){var s=e[i];this._related_values_off[t][i]=!1,this._related_values_on[t][i]=!0,this._related_values_list[t].push(i),this._related_values_index[t][i]=s}this._related_values_list[t].sort(function(t,i){return e[t]<e[i]?-1:e[t]>e[i]?1:0})},_myWeld:function(t){},_preHtml:function(t){return""},_myDressup:function(t){},_mySetFacet:function(t){},_myStats:function(t){}},e.exports=s},{"./generic.js":7}],14:[function(t,e,i){"use strict";function s(t){this.component=t}var n=t("./generic.js");s.prototype={show:function(t){return!0},weld:function(t){var e='\n<p id="•citeh">Cite</p>\n<table align="center">\n    <tr>\n        <td class="•clip_pv clr">\n            <a lnk="" href="#" id="•clip_pv_md" title="link to page content and appearance (markdown)" class="ctrl fa fa-level-down fa-lg fa-fw"></a>\n            <a lnk="" href="#" id="•clip_pv_ht" title="link to page content and appearance (html)" class="ctrl fa fa-external-link-square fa-lg fa-fw"></a>\n            <a lnk="" href="#" id="•clip_pv_htc" title="link to page content (html)" class="ctrl fa fa-external-link fa-lg fa-fw"></a>\n            <a lnk="" href="#" id="•clip_pv_cn" title="copy page content" class="ctrl fa fa-file-text-o fa-lg fa-fw"></a>\n        </td>\n    </tr>\n    <tr>\n        <th class="•clip_pv" width="60px">page view</th>\n    </tr>\n    <tr class="•citexpl">\n        <td class="•clip_pv"><span id="•xc_pv" class="ctrl fa fa-chevron-right fa-fw"></span><span id="•x_pv" class="•detail">share link to this page with or without view settings.</span></td>\n    </tr>\n</table>\n<p id="•cdiagpub"></p>\n<p id="•cdiagsts"></p>\n';this.component.container[t].html(e)},wire:function(t){var e=this,i=this.component.container[t],s=$("#self_link");s.hide(),i.addClass("•socialdrawer"),i.find(".•detail").hide(),i.find("#•clip_pv_md,#•clip_pv_ht,#•clip_pv_htc,#•clip_pv_nl").click(function(t){t.preventDefault(),window.prompt("Press <Cmd-C> and then <Enter> to copy link on clipboard",$(this).attr("lnk"))}),i.find("#•clip_pv_cn").click(function(t){t.preventDefault();var i="middle",a=app_url_cite+e.component.state.getVars(!0);s.show(),s.attr("href",a),n.selectText(i)}),i.find("#•xc_pv").click(function(t){t.preventDefault(),n.toggleDetail($(this),$("#•x_pv"))}),i.click(function(t){t.preventDefault();var i=app_url_cite+e.component.state.getVars(!0),s=app_url_cite+e.component.state.getVars(!1);$("#•citeh").hide(),$("#•cdiagpub").html(""),$("#•cdiagsts").html(""),$(".•clip_pv.clr,#•cdiagpub,#•cdiagsts").removeClass("error warning good special");var a=n.escapeHTML($("title").text());$("#•clip_pv_md").attr("lnk","["+a+"]("+i+")"),$("#•clip_pv_ht").attr("lnk",i),$("#•clip_pv_htc").attr("lnk",s),$("#•clip_pv_cn").attr("lnk",i),
$("#•clip_pv_cn").attr("tit",a),$(this).animate({height:"100px",width:"200px",opacity:.95},300)}),i.mouseleave(function(){return s.hide(),$("#•citeh").show(),i.animate({height:"20px",width:"40px",opacity:.7},300),!1})},work:function(t){}},e.exports=s},{"./generic.js":7}],15:[function(t,e,i){"use strict";function s(t){n.call(this,t,"tadiraha")}var n=t("./relative.js");s.prototype=Object.create(n.prototype),s.prototype.constructor=s,e.exports=s},{"./relative.js":13}],16:[function(t,e,i){"use strict";function s(t){n.call(this,t,"tadiraho")}var n=t("./relative.js");s.prototype=Object.create(n.prototype),s.prototype.constructor=s,e.exports=s},{"./relative.js":13}],17:[function(t,e,i){"use strict";function s(t){n.call(this,t,"tadiraht",1,30)}var n=t("./relative.js");s.prototype=Object.create(n.prototype),s.prototype.constructor=s,e.exports=s},{"./relative.js":13}],18:[function(t,e,i){"use strict";function s(t){this._data={},this.page=t,this.msg=t.msg,this._getInitstate(),this._addHistory()}var n=t("./generic.js");s.prototype={_specs:{list:{url:!0,type:"string",values:{contrib:1,country:1,type:1,tadiraha:1,tadiraho:1,tadiraht:1},default_value:"contrib"},flt_contrib:{url:!1,type:"string",values:null,default_value:""},flt_country:{url:!1,type:"string",values:null,default_value:""},flt_type:{url:!1,type:"string",values:null,default_value:""},flt_tadiraha:{url:!1,type:"string",values:null,default_value:""},flt_tadiraho:{url:!1,type:"string",values:null,default_value:""},flt_tadiraht:{url:!1,type:"string",values:null,default_value:""},rel_country_contrib:{url:!1,type:"string",values:null,default_value:""},rel_type_contrib:{url:!1,type:"string",values:null,default_value:""},rel_tadiraha_contrib:{url:!1,type:"string",values:null,default_value:""},rel_tadiraho_contrib:{url:!1,type:"string",values:null,default_value:""},rel_tadiraht_contrib:{url:!1,type:"string",values:null,default_value:""},item_contrib:{url:!0,type:"string",values:null,default_value:""},item_country:{url:!0,type:"string",values:null,default_value:""},sort:{url:!1,type:"boolean",values:{v:!0,x:!1},default_value:!0}},_showas:{list:{contrib:{sg:"contribution",pl:"contributions"},country:{sg:"country",pl:"countries"},type:{sg:"type",pl:"types"},tadiraha:{sg:"tadirah activity",pl:"tadirah activities"},tadiraho:{sg:"tadirah object",pl:"tadirah objects"},tadiraht:{sg:"tadirah technique",pl:"tadirah techniques"}}},_validate:function(t,e){var i;if(t in this._specs){var s=this._specs[t];"string"==s.type?s.values?e in s.values?i=e:(i=s.default_value,this.msg.msg("illegal string value for "+t+': "'+e+'" is replaced by "'+s.default_value+'"',"warning")):i=e:"integer"==s.type?(/^(\-|\+)?[0-9]+$/.test(e)?i=Number(e):(i=s.default_value,this.msg.msg("not a number value for "+t+': "'+e+'" is replaced by "'+s.default_value+'"',"warning")),i<s.limits.min&&this.msg.msg("number to small for "+t+': "'+i+'" is replaced by "'+s.limits.min+'"',"warning"),i>s.limits.max&&this.msg.msg("number to big for "+t+': "'+i+'" is replaced by "'+s.limits.max+'"',"warning")):"boolean"==s.type&&(e in s.values?i=s.values[e]:(i=s.default_value,this.msg.msg("illegal boolean value for "+t+': "'+e+'" is replaced by "'+s.default_value+'"',"warning")))}else i=null,this.msg.msg("unknown parameter: "+t+"="+e,"warning");return i},getVars:function(t){var e=[];for(var i in this._data){var s=this._data[i],n=this._specs[i];if(t||n.url)if("string"==n.type||"integer"==n.type)e.push(i+"="+s);else if("boolean"==n.type)for(var a in n.values)n.values[a]==s&&e.push(i+"="+a)}return e.join("&")},_getInitstate:function(){for(var t in n.request_vars)t in this._specs||this.msg.msg("unknown parameter: "+t+"="+e,"warning");for(var t in this._specs){var e=null;if(t in n.request_vars){var i=n.request_vars[t];e=this._validate(t,i),n.localstorage_vars.set(t,e)}else n.localstorage_vars.isSet(t)?e=n.localstorage_vars.get(t):(e=this._specs[t].default_value,n.localstorage_vars.set(t,e));this._data[t]=e}},_addHistory:function(t,e){var i="DARIAH contribution tool",s=app_url+"?"+this.getVars(!1);History.pushState(this._data,i,s)},setState:function(t,e){this._data[t]=e,n.localstorage_vars.set(t,e),this._addHistory()},getState:function(t){return this._data[t]},getValues:function(t){return this._specs[t].values},showState:function(t,e,i){var s=e;return void 0!=this._showas[t]&&void 0!=this._showas[t][e]&&(s=this._showas[t][e][i]),s},work:function(){return function(){var t=History.getState();t&&t.data&&(this._data=t.data,this.page.work())}.bind(this)}},e.exports=s},{"./generic.js":7}]},{},[10]);
//# sourceMappingURL=../maps/main.js.map
