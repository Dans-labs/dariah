'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally {try{if(!_n&&_i['return'])_i['return']()}finally {if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else {throw new TypeError('Invalid attempt to destructure non-iterable instance')}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _generic=require('./generic.js');var g=_interopRequireWildcard(_generic);var _viewstate=require('./viewstate');var _viewstate2=_interopRequireDefault(_viewstate);var _share=require('./share');var _share2=_interopRequireDefault(_share);var _ctype=require('./ctype');var _ctype2=_interopRequireDefault(_ctype);var _tadiraho=require('./tadiraho');var _tadiraho2=_interopRequireDefault(_tadiraho);var _tadiraha=require('./tadiraha');var _tadiraha2=_interopRequireDefault(_tadiraha);var _tadiraht=require('./tadiraht');var _tadiraht2=_interopRequireDefault(_tadiraht);var _eumap=require('./eumap');var _eumap2=_interopRequireDefault(_eumap);var _filter=require('./filter');var _filter2=_interopRequireDefault(_filter);var _facet=require('./facet');var _facet2=_interopRequireDefault(_facet);var _list=require('./list');var _list2=_interopRequireDefault(_list);var _item=require('./item');var _item2=_interopRequireDefault(_item);var _control=require('./control');var _control2=_interopRequireDefault(_control);var _components=require('./components');var _components2=_interopRequireDefault(_components);var _skeleton=require('./skeleton');var _skeleton2=_interopRequireDefault(_skeleton);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else {var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _by_id=Symbol();var _class=function(_Skeleton){_inherits(_class,_Skeleton);function _class(){_classCallCheck(this,_class);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(_class).call(this));_this.name='page';_this.state=new _viewstate2.default(_this);var main_lists=_this.state.getValues('list');var contrib_list=new Set(['contrib']);var empty_list=new Set(['']);_this._component_specs=new Map([['share',{dest:'body',variants:empty_list,fetch_url:null,specific:_share2.default}],['control',{dest:'left',variants:main_lists,fetch_url:null,specific:_control2.default}],['list',{dest:'middle',variants:main_lists,fetch_url:'list',specific:_list2.default}],['item',{dest:'list',variants:main_lists,fetch_url:'item',specific:_item2.default}],['facet',{dest:'control',variants:main_lists,fetch_url:null,specific:_facet2.default}],['filter',{dest:'facet',variants:main_lists,fetch_url:null,specific:_filter2.default}],['eumap',{dest:'facet',variants:contrib_list,fetch_url:'country',specific:_eumap2.default}],['ctype',{dest:'facet',variants:contrib_list,fetch_url:'type',specific:_ctype2.default}],['tadiraha',{dest:'facet',variants:contrib_list,fetch_url:'tadiraha',specific:_tadiraha2.default}],['tadiraho',{dest:'facet',variants:contrib_list,fetch_url:'tadiraho',specific:_tadiraho2.default}],['tadiraht',{dest:'facet',variants:contrib_list,fetch_url:'tadiraht',specific:_tadiraht2.default}]]),_this[_by_id]=new Set(['item']),_this.ignore=new Set([]),_this.components=new Map;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=_this._component_specs[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _step$value=_slicedToArray(_step.value,2);var name=_step$value[0];var spec=_step$value[1];if(_this.ignore.has(name)){continue}spec.by_id=_this[_by_id].has(name);var component=new _components2.default(name,spec,_this);component.children=new Map;_this.components.set(name,component)}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=_this.components[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _step2$value=_slicedToArray(_step2.value,2);var name=_step2$value[0];var child_component=_step2$value[1];var dest_name=_this._component_specs.get(name).dest;if(_this.components.has(dest_name)){var parent_component=_this.components.get(dest_name);parent_component.children.set(name,child_component)}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally {try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally {if(_didIteratorError2){throw _iteratorError2}}}_this.resolveTiming();_this._setHeight(80);History.Adapter.bind(window,'statechange',_this.state.work());return _this}_createClass(_class,[{key:'_setHeight',value:function _setHeight(subtract){var wh=window.innerHeight-subtract+'px';var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=new Set(['middle','left','right'])[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var w=_step3.value;$('#'+w).css('height',wh)}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally {try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally {if(_didIteratorError3){throw _iteratorError3}}}}},{key:'getComponent',value:function getComponent(name){return this.components.get(name)}},{key:'getContainer',value:function getContainer(name,variants){if(this.components.has(name)){return this.components.get(name).container}else {var container=new Map;var addto=name=='body'?$('body'):$('#'+name);var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=variants[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var vr=_step4.value;container.set(vr,addto)}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally {try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally {if(_didIteratorError4){throw _iteratorError4}}}return container}}},{key:'getBefore',value:function getBefore(name,stage){var prev_nodes=[];var next_node=name+'-'+stage;var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=(this._timing.get(next_node)||new Set)[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var prev_node=_step5.value;prev_nodes.push(prev_node.split('-'))}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally {try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally {if(_didIteratorError5){throw _iteratorError5}}}return prev_nodes}},{key:'work',value:function work(){var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=this._tasks[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var task=_step6.value;var _task$split=task.split('-');var _task$split2=_slicedToArray(_task$split,2);var name=_task$split2[0];var stage=_task$split2[1];var component=this.getComponent(name);var _iteratorNormalCompletion7=true;var _didIteratorError7=false;var _iteratorError7=undefined;try{for(var _iterator7=component.variants[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=true){var vr=_step7.value;component[stage](vr)}}catch(err){_didIteratorError7=true;_iteratorError7=err}finally {try{if(!_iteratorNormalCompletion7&&_iterator7.return){_iterator7.return()}}finally {if(_didIteratorError7){throw _iteratorError7}}}}}catch(err){_didIteratorError6=true;_iteratorError6=err}finally {try{if(!_iteratorNormalCompletion6&&_iterator6.return){_iterator6.return()}}finally {if(_didIteratorError6){throw _iteratorError6}}}}}]);return _class}(_skeleton2.default);exports.default=_class;