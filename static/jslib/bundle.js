(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally {try{if(!_n&&_i['return'])_i['return']()}finally {if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else {throw new TypeError('Invalid attempt to destructure non-iterable instance')}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _generic=require('./generic.js');var g=_interopRequireWildcard(_generic);var _message=require('./message');var _message2=_interopRequireDefault(_message);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else {var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _stage=Symbol();var _msg=Symbol();var _ids_fetched=Symbol();var _class=function(){function _class(name,specs,page){_classCallCheck(this,_class);this.name=name;this.page=page;this.specs=specs;this.variants=specs.variants;this[_stage]=new Map;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.variants[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var vr=_step.value;this[_stage].set(vr,new Map);var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=this.page.stages.keys()[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var st=_step2.value;this[_stage].get(vr).set(st,true)}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally {try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally {if(_didIteratorError2){throw _iteratorError2}}}}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}this[_msg]=new Map;this[_ids_fetched]=new Set;this.container=new Map;this.dst=new Map;this.state=this.page.state;this.data=new Map;this.related_info=new Map;this.related_values=new Map;this.implementation=new specs.specific(this)}_createClass(_class,[{key:'need',value:function need(vr,stage){var promise=this[_stage].get(vr).get(stage);return !promise.state||promise.state()=='rejected'}},{key:'_deed',value:function _deed(vr,stage,method){var methodCall=this[method].bind(this,vr);var timing=this.page.getBefore(this.name,stage);var promises=[];var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=timing[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var _step3$value=_slicedToArray(_step3.value,2);var prev_name=_step3$value[0];var prev_stage=_step3$value[1];var prev_component=this.page.getComponent(prev_name);if(prev_component.hasVariant(vr)){promises.push(prev_component[_stage].get(vr).get(prev_stage))}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally {try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally {if(_didIteratorError3){throw _iteratorError3}}}this[_stage].get(vr).set(stage,$.when.apply($,promises).then(methodCall))}},{key:'ensure',value:function ensure(vr,stage,method){if(this.page.stages.has(stage)){var once=this.page.stages.get(stage)&&!this.specs.by_id;if(!once||this.need(vr,stage)){this._deed(vr,stage,method)}}}},{key:'hasVariant',value:function hasVariant(vr){return this.variants.has(vr)}},{key:'_visibility',value:function _visibility(vr,on){if(this.hasVariant(vr)){if(this.container.has(vr)){var widget=this.container.get(vr);if(on){widget.show()}else {widget.hide()}}}}},{key:'_fetch',value:function _fetch(vr,ids_to_fetch){var fetch_url=url_tpl.replace(/_c_/,'data').replace(/_f_/,this.specs.fetch_url+'_'+vr)+'.json';this[_msg].get(vr).msg('fetching data ...');var postFetch=this._postFetch.bind(this,vr);if(!(ids_to_fetch==undefined)){fetch_url+='?ids='+ids_to_fetch.join(',')}return $.ajax({type:'POST',url:fetch_url,contentType:'application/json; charset=utf-8',dataType:'json'}).then(function(json){postFetch(json,ids_to_fetch)})}},{key:'_postFetch',value:function _postFetch(vr,json,ids_to_fetch){this[_msg].get(vr).clear();var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=json.msgs[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var m=_step4.value;this[_msg].get(vr).msg(m)}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally {try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally {if(_didIteratorError4){throw _iteratorError4}}}if(json.good){if('data' in json){this.data.set(vr,json.data)}if('relinfo' in json){var r=new Map;var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=json.relinfo[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var x=_step5.value;r.set(x[0],new Set(x[1]))}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally {try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally {if(_didIteratorError5){throw _iteratorError5}}}this.related_info.set(vr,r)}if('relvals' in json){this.related_values.set(vr,new Map(json.relvals))}if(this.specs.by_id){var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=ids_to_fetch[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var i=_step6.value;this[_ids_fetched].add(i)}}catch(err){_didIteratorError6=true;_iteratorError6=err}finally {try{if(!_iteratorNormalCompletion6&&_iterator6.return){_iterator6.return()}}finally {if(_didIteratorError6){throw _iteratorError6}}}}}this.implementation.weld(vr)}},{key:'_weld',value:function _weld(vr){this.dst=this.page.getContainer(this.specs.dest,this.variants);if(!this.specs.by_id){this.container.set(vr,$('#'+this.name+'_'+vr));if(this.container.get(vr).length==0){var destination=this.dst.get(vr);destination.append('<div id="msg_'+this.name+'_'+vr+'"></div>');destination.append('<div id="'+this.name+'_'+vr+'" class="component"></div>');this.container.set(vr,$('#'+this.name+'_'+vr))}this[_msg].set(vr,new _message2.default('msg_'+this.name+'_'+vr))}else {if(!this[_msg].has(vr)){var _destination=this.dst.get(vr);_destination.prepend('<div id="msg_'+this.name+'_'+vr+'"></div>');this[_msg].set(vr,new _message2.default('msg_'+this.name+'_'+vr))}}if(this.specs.fetch_url!=null){var ids_to_fetch=[];if(this.specs.by_id){var ids_asked_for=g.from_str(this.state.getState(this.specs.fetch_url+'_'+vr));var _iteratorNormalCompletion7=true;var _didIteratorError7=false;var _iteratorError7=undefined;try{for(var _iterator7=ids_asked_for[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=true){var i=_step7.value;if(!this[_ids_fetched].has(i)){ids_to_fetch.push(i)}}}catch(err){_didIteratorError7=true;_iteratorError7=err}finally {try{if(!_iteratorNormalCompletion7&&_iterator7.return){_iterator7.return()}}finally {if(_didIteratorError7){throw _iteratorError7}}}if(ids_to_fetch.length!=0){return this._fetch(vr,ids_to_fetch)}}else {return this._fetch(vr)}}else {this.implementation.weld(vr)}}},{key:'_wire',value:function _wire(vr){this.implementation.wire(vr)}},{key:'_work',value:function _work(vr){this._visibility(vr,true);this.implementation.work(vr)}},{key:'weld',value:function weld(vr){if(this.hasVariant(vr)&&this.implementation.show(vr)){this.ensure(vr,'weld','_weld')}}},{key:'wire',value:function wire(vr){if(this.hasVariant(vr)&&this.implementation.show(vr)){this.ensure(vr,'wire','_wire')}}},{key:'work',value:function work(vr){if(this.hasVariant(vr)&&this.implementation.show(vr)){this.ensure(vr,'work','_work')}else {this._visibility(vr,false)}}}]);return _class}();exports.default=_class;
},{"./generic.js":7,"./message":11}],2:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _widget=Symbol();var _control=Symbol();var _class=function(){function _class(component){_classCallCheck(this,_class);this.component=component;this[_widget]=new Map;this[_control]=new Map}_createClass(_class,[{key:'_html',value:function _html(vr){this.component.container.get(vr).html('<a class="control_title" href="#">'+this.component.state.showState('list',vr,'sg')+'</a> ')}},{key:'_dressup',value:function _dressup(vr){var _this=this;this[_control].get(vr).click(function(e){e.preventDefault();_this.component.state.setState('list',vr)})}},{key:'_isActive',value:function _isActive(vr){return this.component.state.getState('list')==vr}},{key:'show',value:function show(vr){return true}},{key:'weld',value:function weld(vr){this._html(vr);this[_widget].set(vr,this.component.container.get(vr));this[_widget].get(vr).addClass('control_big');this[_control].set(vr,this.component.container.get(vr).find('a'))}},{key:'wire',value:function wire(vr){this._dressup(vr)}},{key:'work',value:function work(vr){if(this._isActive(vr)){this[_control].get(vr).addClass('ison');this[_widget].get(vr).addClass('ison')}else {this[_control].get(vr).removeClass('ison');this[_widget].get(vr).removeClass('ison')}}}]);return _class}();exports.default=_class;
},{}],3:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _relative=require('./relative');var _relative2=_interopRequireDefault(_relative);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _class=function(_Relative){_inherits(_class,_Relative);function _class(component){_classCallCheck(this,_class);return _possibleConstructorReturn(this,Object.getPrototypeOf(_class).call(this,component,'type'))}return _class}(_relative2.default);exports.default=_class;
},{"./relative":13}],4:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally {try{if(!_n&&_i['return'])_i['return']()}finally {if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else {throw new TypeError('Invalid attempt to destructure non-iterable instance')}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _generic=require('./generic.js');var g=_interopRequireWildcard(_generic);var _relative=require('./relative');var _relative2=_interopRequireDefault(_relative);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else {var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _map_object=Symbol();var _map_container=Symbol();var _marker=Symbol();var _setvalues=Symbol();var _not_mapped=Symbol();var _class=function(_Relative){_inherits(_class,_Relative);function _class(component){_classCallCheck(this,_class);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(_class).call(this,component,'country'));_this[_map_object]=new Map;_this[_map_container]=new Map;_this[_marker]=new Map;_this[_setvalues]=new Map;_this[_not_mapped]=new Set(['-','CY','KS','TR','MC','GE']);return _this}_createClass(_class,[{key:'_preHtml',value:function _preHtml(vr){return '<div id="map-europe_'+vr+'" class="position">\n    <p class="zoom"><a class="fa fa-arrows" href="#" title="zoom to fit all countries"/></p>\n</div>'}},{key:'_myDressup',value:function _myDressup(vr){var _this2=this;var that=this;var cc=this.component.container.get(vr);this[_map_container].set(vr,cc.find('#map-europe_'+vr));var mapc=this[_map_container].get(vr);var height=mapc.width()*0.6;mapc.width('100%');mapc.height(height);mapc.vectorMap({'map':'europe_mill',backgroundColor:'#ccccff',regionsSelectable:true,markersSelectable:true,regionsSelectableOne:false,markersSelectableOne:false,markerStyle:{initial:{fill:'#008800','fill-opacity':0.2,stroke:'none','stroke-width':0,'stroke-opacity':0.2,'r':1},hover:{cursor:'pointer',stroke:'#ffff44','stroke-width':1,'stroke-opacity':1},selected:{fill:'#008800','fill-opacity':1},selectedHover:{}},regionStyle:{initial:{fill:'#bbbbbb','fill-opacity':1,stroke:'none','stroke-width':0,'stroke-opacity':1},hover:{cursor:'pointer',stroke:'#ffff44','stroke-width':3,'stroke-opacity':1},selected:{fill:'#dd8844','fill-opacity':1},selectedHover:{}},markers:this[_marker].get(vr),series:{markers:[{values:{},scale:[0,20],normalizeFunction:'linear',attribute:'r',min:0,max:100}],regions:[{scale:{'outdariah':'#ffffff','indariah':'#ffddbb'},attribute:'fill',values:this[_setvalues].get(vr)}]},onRegionTipShow:function(e,el,related_value){var rvs=this.statistics.get(vr);el.html(related_value+': '+(rvs.has(related_value)?rvs.get(related_value):'not in DARIAH'))}.bind(this),onMarkerTipShow:function(e,el,related_value){var rvs=this.statistics.get(vr);el.html(related_value+': '+(rvs.has(related_value)?rvs.get(related_value):'not in DARIAH'))}.bind(this),onRegionClick:function(e,related_value){if(!this.related_values_index.get(vr).has(related_value)){e.preventDefault()}}.bind(this),onMarkerClick:function(e,related_value){if(!this.related_values_index.get(vr).has(related_value)){e.preventDefault()}}.bind(this),onRegionSelected:function(e,related_value,i,selected){if(this.change_state){this.component.state.setState('rel_'+this.typ+'_'+vr,g.a_to_str(selected)+this._unmapped_selected(vr))}}.bind(this),onMarkerSelected:function(e,related_value,i,selected){if(this.change_state){this.component.state.setState('rel_'+this.typ+'_'+vr,g.a_to_str(selected)+this._unmapped_selected(vr))}}.bind(this)});var zoom_p=cc.find('p.zoom');zoom_p.css('top',height-20+'px');zoom_p.css('left','10px');var zoom_control=cc.find('p.zoom a');zoom_control.click(function(e){e.preventDefault();_this2[_map_object].get(vr).setFocus({regions:['GB','GR']})});this[_map_object].set(vr,mapc.vectorMap('get','mapObject'));this[_map_object].get(vr).setFocus({regions:['GB','GR']})}},{key:'_unmapped_selected',value:function _unmapped_selected(vr){var result=[];var this_state=g.from_str(vr,this.component.state.getState('rel_'+this.typ+'_'+vr));var empty=true;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this[_not_mapped][Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var related_value=_step.value;if(this_state.has(related_value)){result.push(related_value);empty=false}}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}return empty?'':','+result.join(',')}},{key:'_mySetFacet',value:function _mySetFacet(vr){this.change_state=false;var map_regions={};var map_markers={};var related_values=this.related_state.get(vr);var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=this.component.related_values.get(vr)[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _step2$value=_slicedToArray(_step2.value,2);var i=_step2$value[0];var related_value=_step2$value[1];if(!this[_not_mapped].has(i)&&i!=this.no_values.value){map_regions[i]=related_values.has(i);if(related_value[1]){map_markers[i]=related_values.has(i)}}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally {try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally {if(_didIteratorError2){throw _iteratorError2}}}var mapo=this[_map_object].get(vr);mapo.setSelectedRegions(map_regions);mapo.setSelectedMarkers(map_markers);this.change_state=true}},{key:'_myStats',value:function _myStats(vr){var total=this.distilled.get(vr).length;if(total==0){total=1}var weighted_statistics={};var rvs=this.statistics.get(vr);var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=rvs[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var _step3$value=_slicedToArray(_step3.value,2);var related_value=_step3$value[0];var stat=_step3$value[1];if(related_value!=this.no_values.value){var pr=100*stat/total;weighted_statistics[related_value]=total<10?pr:10*Math.sqrt(pr)}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally {try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally {if(_didIteratorError3){throw _iteratorError3}}}this[_map_object].get(vr).series.markers[0].setValues(weighted_statistics)}},{key:'_plainWeld',value:function _plainWeld(vr){}},{key:'_myWeld',value:function _myWeld(vr){this[_marker].set(vr,{});this[_setvalues].set(vr,{});var related_values=this.component.related_values.get(vr);var marker=this[_marker].get(vr);var setv=this[_setvalues].get(vr);var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=related_values[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var _step4$value=_slicedToArray(_step4.value,2);var i=_step4$value[0];var related_value=_step4$value[1];if(related_value[1]){this.related_values_all.get(vr).add(i);this.related_values_list.get(vr).push(i);this.related_values_index.get(vr).set(i,related_value[0]);marker[i]={latLng:[related_value[2],related_value[3]],name:related_value[0]};setv[i]='indariah'}else {setv[i]='outdariah'}}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally {try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally {if(_didIteratorError4){throw _iteratorError4}}}this.related_values_list.get(vr).sort(function(a,b){return related_values.get(a)<related_values.get(b)?-1:related_values.get(a)[0]>related_values.get(b)[0]?1:0})}}]);return _class}(_relative2.default);exports.default=_class;
},{"./generic.js":7,"./relative":13}],5:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally {try{if(!_n&&_i['return'])_i['return']()}finally {if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else {throw new TypeError('Invalid attempt to destructure non-iterable instance')}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _generic=require('./generic.js');var g=_interopRequireWildcard(_generic);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else {var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _stats=Symbol();var _enabled_facets=Symbol();var _class=function(){function _class(component){_classCallCheck(this,_class);this.component=component;this[_stats]=new Map;this[_enabled_facets]=new Map;this.table=new Map;this.distilled=new Map}_createClass(_class,[{key:'_html',value:function _html(vr){var h='<p><span fct="all"></span>Filtering <span id="fstats_'+vr+'"></span></p>';this.component.container.get(vr).html(h)}},{key:'show',value:function show(vr){return this.component.state.getState('list')==vr}},{key:'weld',value:function weld(vr){var children=this.component.children;this[_enabled_facets].set(vr,new Map);var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=children[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _step$value=_slicedToArray(_step.value,2);var facet_name=_step$value[0];var facet_component=_step$value[1];if(facet_component.hasVariant(vr)){this[_enabled_facets].get(vr).set(facet_name,facet_component)}}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}this._html(vr)}},{key:'_display',value:function _display(expand_control,mode){var that=this;var dt=expand_control.closest('p');var hidec=dt.find('.hidec');var morec=dt.find('.morec');var showc=dt.find('.showc');var expanded_material=expand_control.closest('div').find('table,.flt');var condensed_material=expand_control.closest('div').find('.value_list2,.flt_compact');var not_expanded_material=expand_control.closest('div').find('.flt_not_expanded');var key='fctx_'+expand_control.closest('span').attr('fct');var mode_undef=mode==undefined;if(mode_undef){if(g.localstorage_vars.isSet(key)){mode=g.localstorage_vars.get(key)}else {mode=1}}var all_facets=key=='fctx_all';if(all_facets&&!mode_undef){expand_control.closest('div').find('div.component span[fct]').each(function(){that._display($(this),mode)})}g.localstorage_vars.set(key,mode);if(mode==0){hidec.show();morec.hide();showc.hide();if(!all_facets){not_expanded_material.show();expanded_material.hide();condensed_material.hide()}}else if(mode==1){hidec.hide();morec.show();showc.hide();if(!all_facets){not_expanded_material.show();expanded_material.hide();condensed_material.show()}}else {hidec.hide();morec.hide();showc.show();if(!all_facets){not_expanded_material.hide();expanded_material.show();condensed_material.hide()}}}},{key:'wire',value:function wire(vr){var that=this;var cc=this.component.container.get(vr);var lc=this.component.page.getComponent('list').container.get(vr);this[_stats].set(vr,cc.find('#fstats_'+vr));this.table.set(vr,lc.find('#table_'+vr));var info=' details; click to change level of details';var detailcontrols='<a class="showc fa fa-fw fa-list-ul" href="#" title="full'+info+'"></a><a class="morec fa fa-fw fa-align-left" href="#" title="condensed'+info+'"></a><a class="hidec fa fa-fw fa-minus" href="#" title="hidden'+info+'"></a>';cc.addClass('facet');cc.find('span[fct]').each(function(){$(this).html(detailcontrols+'&nbsp');that._display($(this))});cc.find('.hidec').click(function(e){e.preventDefault();that._display($(this),1)});cc.find('.morec').click(function(e){e.preventDefault();that._display($(this),2)});cc.find('.showc').click(function(e){e.preventDefault();that._display($(this),0)})}},{key:'work',value:function work(vr){this.table.get(vr).find('tr[rid],tr[iid]').hide();var mother_list=this.component.page.getComponent('list');var data=mother_list.data.get(vr);var facets=this[_enabled_facets].get(vr);this.distilled.set(vr,[]);var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=facets[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _step2$value=_slicedToArray(_step2.value,2);var facet_name=_step2$value[0];var facet_comp=_step2$value[1];var facet=facet_comp.implementation;facet.distilled.set(vr,[])}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally {try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally {if(_didIteratorError2){throw _iteratorError2}}}var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=data[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var d=_step3.value;var v=true;var the_false=null;var discard=false;var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=facets[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var _step5$value=_slicedToArray(_step5.value,2);var facet_name=_step5$value[0];var facet_comp=_step5$value[1];if(!discard){var _facet2=facet_comp.implementation;var this_v=_facet2.v(vr,d[0]);if(!this_v){v=false;if(the_false==null){the_false=_facet2}else {discard=true}}}}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally {try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally {if(_didIteratorError5){throw _iteratorError5}}}if(!discard){if(v){this.distilled.get(vr).push(d[0]);this.table.get(vr).find('tr[rid="'+d[0]+'"],tr[iid="'+d[0]+'"]').show()}if(the_false!=null){the_false.distilled.get(vr).push(d[0])}else {var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=facets[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var _step6$value=_slicedToArray(_step6.value,2);var facet_name=_step6$value[0];var facet_comp=_step6$value[1];var _facet=facet_comp.implementation;_facet.distilled.get(vr).push(d[0])}}catch(err){_didIteratorError6=true;_iteratorError6=err}finally {try{if(!_iteratorNormalCompletion6&&_iterator6.return){_iterator6.return()}}finally {if(_didIteratorError6){throw _iteratorError6}}}}}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally {try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally {if(_didIteratorError3){throw _iteratorError3}}}var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=facets[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var _step4$value=_slicedToArray(_step4.value,2);var facet_name=_step4$value[0];var facet_comp=_step4$value[1];var _facet3=facet_comp.implementation;_facet3.stats(vr)}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally {try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally {if(_didIteratorError4){throw _iteratorError4}}}this[_stats].get(vr).html(this.distilled.get(vr).length+' of '+data.length)}}]);return _class}();exports.default=_class;
},{"./generic.js":7}],6:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _tags=Symbol();var _filter_control=Symbol();var _filter_control2=Symbol();var _clear_filter_control=Symbol();var _box=Symbol();var _completions_dst=Symbol();var _wire_mode=Symbol();var _distilled=Symbol();var _class=function(){function _class(component){_classCallCheck(this,_class);this.component=component;this[_tags]=new Map;this[_filter_control]=new Map;this[_filter_control2]=new Map;this[_box]=new Map;this[_completions_dst]=new Map;this._stats_dst=new Map;this[_clear_filter_control]=new Map;this[_wire_mode]=new Map;this[_distilled]=new Map;this.distilled=new Map}_createClass(_class,[{key:'_html',value:function _html(vr){var h='\n<div>\n    <p class="dctrl"><span fct="'+this.component.name+'-'+vr+'"></span> By full text search\n        <a href="#" title="modify full text filter" id="flt2_'+vr+'" class="flt_not_expanded facet_single ison flt_pat"></a>\n        <a href="#" class="control_med fa fa-close filtc" id="clearf_'+vr+'"></a>\n    </p>\n    <div id="fltw_'+vr+'">\n        <p id="fbox_'+vr+'" class="flt control_med fbox ui-widget">\n            <input id="flt_'+vr+'" class="flt flt_pat"/>\n            <span fbox class="stats" id="stats_'+vr+'"></span>\n        </p>\n        <div id="autoc_'+vr+'" style="display: none;">here '+vr+'</div>\n    </div>\n</div>';this.component.container.get(vr).html(h)}},{key:'_setFilter',value:function _setFilter(vr){var textf=this.component.state.getState('flt_'+vr);var filterc=this[_filter_control].get(vr);this[_filter_control2].get(vr).html(textf);filterc.val(textf);filterc.autocomplete('search',textf)}},{key:'_response',value:function _response(vr){return function(event,ui){this[_distilled].set(vr,{});var dstl=this[_distilled].get(vr);var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=ui.content[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var u=_step.value;dstl[u.value]=1}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}if(!this[_wire_mode].get(vr)){var textf=this[_filter_control].get(vr).val();this.component.state.setState('flt_'+vr,textf)}}.bind(this)}},{key:'_setClear',value:function _setClear(vr){var _this=this;this[_clear_filter_control].get(vr).click(function(e){e.preventDefault();var filterc=_this[_filter_control].get(vr);filterc.val('');filterc.autocomplete('search','')})}},{key:'stats',value:function stats(vr){var stat_prefix=void 0;var statd=this._stats_dst.get(vr);if(this[_filter_control].get(vr).val()==''){stat_prefix='';statd.removeClass('ison')}else {stat_prefix=this.facet.distilled.get(vr).length+' of ';statd.addClass('ison')}statd.html(''+stat_prefix+this.distilled.get(vr).length)}},{key:'v',value:function v(vr,i){return i in this[_distilled].get(vr)}},{key:'show',value:function show(vr){return this.component.state.getState('list')==vr}},{key:'weld',value:function weld(vr){this._html(vr)}},{key:'wire',value:function wire(vr){if(!this.facet){this.facet=this.component.page.getComponent('facet').implementation}var data=this.component.page.getComponent('list').data.get(vr);this[_tags].set(vr,[]);var tgs=this[_tags].get(vr);var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=data[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var d=_step2.value;tgs.push({label:d[1],value:''+d[0]})}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally {try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally {if(_didIteratorError2){throw _iteratorError2}}}this[_distilled].set(vr,{});this.distilled.set(vr,[]);var cc=this.component.container.get(vr);var cf=cc.find('#fltw_'+vr);var flt=$('#flt_'+vr);this[_filter_control].set(vr,flt);var flt2=$('#flt2_'+vr);this[_filter_control2].set(vr,flt2);this[_box].set(vr,cf.find('#fbox_'+vr));this[_completions_dst].set(vr,cf.find('#autoc_'+vr));this._stats_dst.set(vr,cf.find('#stats_'+vr));this[_clear_filter_control].set(vr,cc.find('#clearf_'+vr));this[_filter_control].get(vr).autocomplete({appendTo:this[_completions_dst].get(vr),source:this[_tags].get(vr),response:this._response(vr),minLength:0});flt2.click(function(e){e.preventDefault();$(this).closest('div').find('.morec').click();flt[0].focus()});this[_wire_mode].set(vr,true);this._setClear(vr);this._setFilter(vr);this[_wire_mode].set(vr,false)}},{key:'work',value:function work(vr){var textf=this.component.state.getState('flt_'+vr);var clearfc=this[_clear_filter_control].get(vr);if(textf==''){this[_box].get(vr).removeClass('ison');clearfc.hide()}else {this[_box].get(vr).addClass('ison');clearfc.show()}this[_filter_control2].get(vr).html(textf)}}]);return _class}();exports.default=_class;
},{}],7:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.escapeHTML=escapeHTML;exports.deselectText=deselectText;exports.selectText=selectText;exports.toggleDetail=toggleDetail;exports.compact=compact;exports.from_str=from_str;exports.a_to_str=a_to_str;exports.to_str=to_str;function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else {return Array.from(arr)}}var chr=new Map([['&','&amp;'],['<','&lt;'],['>','&gt;']]);function escapeHTML(text){return text.replace(/[&<>]/g,function(a){return chr.get(a)||a})};var _Request={parameter:function parameter(name){return this.parameters().get(name)},parameters:function parameters(){var result=new Map;var uri=window.location.search;if(uri.indexOf('?')===-1){return result}var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=uri.slice(1).split('&')[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var paramval=_step.value;result.set.apply(result,_toConsumableArray(paramval.split('=')))}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}return result}};var request_vars=exports.request_vars=_Request.parameters();var _localstorage=$.initNamespaceStorage('req');var localstorage_vars=exports.localstorage_vars=_localstorage.localStorage;function deselectText(){if(document.selection){document.selection.empty()}else if(window.getSelection){window.getSelection().removeAllRanges()}};function selectText(containerid){deselectText();if(document.selection){var range=document.body.createTextRange();range.moveToElementText(document.getElementById(containerid));range.select()}else if(window.getSelection){var _range=document.createRange();_range.selectNode(document.getElementById(containerid));window.getSelection().addRange(_range)}};function toggleDetail(widget,detail,extra){var thedetail=detail==undefined?widget.closest('div').find('.detail'):detail;thedetail.toggle();if(extra!=undefined){extra(widget)}var thiscl=void 0,othercl=void 0;if(widget.hasClass('fa-chevron-right')){thiscl='fa-chevron-right';othercl='fa-chevron-down'}else {thiscl='fa-chevron-down';othercl='fa-chevron-right'}widget.removeClass(thiscl);widget.addClass(othercl)};function compact(cutoff,size,text){return text.length>cutoff?text.replace(/[^ -]+/g,function(x){return x.substr(0,size)}):text};function from_str(st){return st!==null&&st!=undefined&&st!=''?new Set(st.split(',')):new Set};function a_to_str(ar){return ar.join(',')};function to_str(set){return Array.from(set).join(',')};
},{}],8:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _class=function(){function _class(component){_classCallCheck(this,_class);this.component=component}_createClass(_class,[{key:'_html',value:function _html(vr,it){var destination=this.component.dst.get(vr);var dest_row=destination.find('tr[rid="'+it[0]+'"]');var h='<tr iid="'+it[0]+'">';if(vr=='contrib'){var types=[];var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=it[5][Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var tp=_step.value;types.push('<a href="#" tid="'+tp[0]+'">'+tp[1]+'</a>')}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}h+='\n<td colspan="2">\n<b>Contact person:</b> '+it[2]+'<br/>\n<b>Country:</b> '+it[3]+' = '+it[4]+'<br/>\n<b>Types:</b> '+types.join(', ')+'</br>\n</td>\n'}else if(vr=='country'){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=this.component.data.get(vr)[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var r=_step2.value;in_dariah=r[3]==1?'dariah':'';h+='<td class="country_code">'+r[1]+'<td><td class="country_name">'+r[2]+'<td><td class="in_dariah">'+in_dariah+'</td><td class="latlng">'+r[4]+'</td><td class="latlng">'+r[5]+'</td>'}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally {try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally {if(_didIteratorError2){throw _iteratorError2}}}}else if(vr=='type'||vr=='tadiraha'||vr=='tadiraho'||vr=='tadiraht'){var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=this.component.data.get(vr)[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var _r=_step3.value;h+='<td class="value">'+_r[1]+'<td>'}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally {try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally {if(_didIteratorError3){throw _iteratorError3}}}}h+='</tr>';dest_row.after(h)}},{key:'show',value:function show(vr){return this.component.state.getState('list')==vr}},{key:'weld',value:function weld(vr){var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=this.component.data.get(vr)[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var it=_step4.value;this._html(vr,it)}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally {try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally {if(_didIteratorError4){throw _iteratorError4}}}}},{key:'wire',value:function wire(vr){}},{key:'work',value:function work(vr){}}]);return _class}();exports.default=_class;
},{}],9:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _generic=require('./generic.js');var g=_interopRequireWildcard(_generic);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else {var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _class=function(){function _class(component){_classCallCheck(this,_class);this.component=component}_createClass(_class,[{key:'_html',value:function _html(vr){var h='';h+='<table id="table_'+vr+'">';var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.component.data.get(vr)[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var r=_step.value;var rowstart='<tr rid="'+r[0]+'"><td><a class="showc fa fa-fw fa-list-ul" href="#" title="hide fields"></a><a class="hidec fa fa-fw fa-minus" href="#" title="show fields"></a></td>';var rowend='</tr>';if(vr=='contrib'){h+=rowstart+'<td><a href="#" class="fa fa-fw fa-minus"></a>'+r[1]+'</td>'+rowend}else if(vr=='country'){var in_dariah=r[3]==1?'dariah':'';h+=rowstart+'<td class="country_code">'+r[1]+'<td><td class="country_name">'+r[2]+'<td><td class="in_dariah">'+in_dariah+'</td><td class="latlng">'+r[4]+'</td><td class="latlng">'+r[5]+'</td>'+rowend}else if(vr=='type'||vr=='tadiraha'||vr=='tadiraho'||vr=='tadiraht'){h+=rowstart+'<td class="value">'+r[1]+'<td>'+rowend}}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}h+='</table>';this.component.container.get(vr).html(h)}},{key:'_display',value:function _display(row,vr,open_ids){var that=this;var hidec=row.find('.hidec');var showc=row.find('.showc');var rid=row.attr('rid');var detail=this.component.container.get(vr).find('tr[iid="'+rid+'"]');if(open_ids.has(rid)){hidec.show();showc.hide();if(detail.length){detail.show()}}else {hidec.hide();showc.hide();if(detail.length){detail.hide()}}}},{key:'_set_it',value:function _set_it(control,vr,state){var open_ids=g.from_str(this.state.getState(key));var rid=control.closest('tr').attr('rid');if(state){open_ids.add(rid)}else {open_ids.delete(rid)}this.state.setState(key,g.to_str(open_ids))}},{key:'show',value:function show(vr){return this.component.state.getState('list')==vr}},{key:'weld',value:function weld(vr){this._html(vr)}},{key:'wire',value:function wire(vr){var that=this;var cc=this.component.container.get(vr);var key=this.component.name+'_'+vr;cc.find('.hidec').click(function(e){e.preventDefault();that._set_it($(this),vr,true)});cc.find('.showc').click(function(e){e.preventDefault();that._set_it($(this),vr,false)})}},{key:'work',value:function work(vr){var that=this;var key=this.component.name+'_'+vr;var cc=this.component.container.get(vr);var open_ids=g.from_str(this.component.state.getState(this.component.name+'_'+vr));cc.find('tr[rid]').each(function(){that._display($(this),vr,open_ids)})}}]);return _class}();exports.default=_class;
},{"./generic.js":7}],10:[function(require,module,exports){
'use strict';var _page=require('./page');var _page2=_interopRequireDefault(_page);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}$(function(){new _page2.default().work()});
},{"./page":12}],11:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _destination=Symbol();var _trash_control=Symbol();var _trash_control_para=Symbol();var _on_clear=Symbol();var _class=function(){function _class(destination,on_clear){var _this=this;_classCallCheck(this,_class);this[_destination]=$('#'+destination);this[_trash_control]=$('#trash_'+destination);this[_trash_control_para]=this[_trash_control].closest('p');this[_trash_control].click(function(e){e.preventDefault();_this.clear()});this._hide();this[_on_clear]=on_clear}_createClass(_class,[{key:'_hide',value:function _hide(){this[_destination].hide();this[_trash_control_para].hide()}},{key:'_show',value:function _show(){this[_destination].show();if(this[_destination].html()!=''){this[_trash_control_para].show()}}},{key:'clear',value:function clear(){this[_destination].html('');if(this[_on_clear]!=undefined){this[_on_clear]()}this._hide()}},{key:'msg',value:function msg(text,kind){if(kind==undefined){kind='info'}var message_text=this[_destination].html();this[_destination].html(message_text+'<p class="'+kind+'">'+text+'</p>');this._show()}}]);return _class}();exports.default=_class;
},{}],12:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally {try{if(!_n&&_i['return'])_i['return']()}finally {if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else {throw new TypeError('Invalid attempt to destructure non-iterable instance')}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _generic=require('./generic.js');var g=_interopRequireWildcard(_generic);var _viewstate=require('./viewstate');var _viewstate2=_interopRequireDefault(_viewstate);var _share=require('./share');var _share2=_interopRequireDefault(_share);var _ctype=require('./ctype');var _ctype2=_interopRequireDefault(_ctype);var _tadiraho=require('./tadiraho');var _tadiraho2=_interopRequireDefault(_tadiraho);var _tadiraha=require('./tadiraha');var _tadiraha2=_interopRequireDefault(_tadiraha);var _tadiraht=require('./tadiraht');var _tadiraht2=_interopRequireDefault(_tadiraht);var _eumap=require('./eumap');var _eumap2=_interopRequireDefault(_eumap);var _filter=require('./filter');var _filter2=_interopRequireDefault(_filter);var _facet=require('./facet');var _facet2=_interopRequireDefault(_facet);var _list=require('./list');var _list2=_interopRequireDefault(_list);var _item=require('./item');var _item2=_interopRequireDefault(_item);var _control=require('./control');var _control2=_interopRequireDefault(_control);var _components=require('./components');var _components2=_interopRequireDefault(_components);var _skeleton=require('./skeleton');var _skeleton2=_interopRequireDefault(_skeleton);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else {var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _by_id=Symbol();var _class=function(_Skeleton){_inherits(_class,_Skeleton);function _class(){_classCallCheck(this,_class);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(_class).call(this));_this.name='page';_this.state=new _viewstate2.default(_this);var main_lists=_this.state.getValues('list');var contrib_list=new Set(['contrib']);var empty_list=new Set(['']);_this._component_specs=new Map([['share',{dest:'body',variants:empty_list,fetch_url:null,specific:_share2.default}],['control',{dest:'left',variants:main_lists,fetch_url:null,specific:_control2.default}],['list',{dest:'middle',variants:main_lists,fetch_url:'list',specific:_list2.default}],['item',{dest:'list',variants:main_lists,fetch_url:'item',specific:_item2.default}],['facet',{dest:'control',variants:main_lists,fetch_url:null,specific:_facet2.default}],['filter',{dest:'facet',variants:main_lists,fetch_url:null,specific:_filter2.default}],['eumap',{dest:'facet',variants:contrib_list,fetch_url:'country',specific:_eumap2.default}],['ctype',{dest:'facet',variants:contrib_list,fetch_url:'type',specific:_ctype2.default}],['tadiraha',{dest:'facet',variants:contrib_list,fetch_url:'tadiraha',specific:_tadiraha2.default}],['tadiraho',{dest:'facet',variants:contrib_list,fetch_url:'tadiraho',specific:_tadiraho2.default}],['tadiraht',{dest:'facet',variants:contrib_list,fetch_url:'tadiraht',specific:_tadiraht2.default}]]),_this[_by_id]=new Set(['item']),_this.ignore=new Set([]),_this.components=new Map;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=_this._component_specs[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _step$value=_slicedToArray(_step.value,2);var name=_step$value[0];var spec=_step$value[1];if(_this.ignore.has(name)){continue}spec.by_id=_this[_by_id].has(name);var component=new _components2.default(name,spec,_this);component.children=new Map;_this.components.set(name,component)}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=_this.components[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _step2$value=_slicedToArray(_step2.value,2);var name=_step2$value[0];var child_component=_step2$value[1];var dest_name=_this._component_specs.get(name).dest;if(_this.components.has(dest_name)){var parent_component=_this.components.get(dest_name);parent_component.children.set(name,child_component)}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally {try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally {if(_didIteratorError2){throw _iteratorError2}}}_this.resolveTiming();_this._setHeight(80);History.Adapter.bind(window,'statechange',_this.state.work());return _this}_createClass(_class,[{key:'_setHeight',value:function _setHeight(subtract){var wh=window.innerHeight-subtract+'px';var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=new Set(['middle','left','right'])[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var w=_step3.value;$('#'+w).css('height',wh)}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally {try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally {if(_didIteratorError3){throw _iteratorError3}}}}},{key:'getComponent',value:function getComponent(name){return this.components.get(name)}},{key:'getContainer',value:function getContainer(name,variants){if(this.components.has(name)){return this.components.get(name).container}else {var container=new Map;var addto=name=='body'?$('body'):$('#'+name);var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=variants[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var vr=_step4.value;container.set(vr,addto)}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally {try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally {if(_didIteratorError4){throw _iteratorError4}}}return container}}},{key:'getBefore',value:function getBefore(name,stage){var prev_nodes=[];var next_node=name+'-'+stage;var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=(this._timing.get(next_node)||new Set)[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var prev_node=_step5.value;prev_nodes.push(prev_node.split('-'))}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally {try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally {if(_didIteratorError5){throw _iteratorError5}}}return prev_nodes}},{key:'work',value:function work(){var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=this._tasks[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var task=_step6.value;var _task$split=task.split('-');var _task$split2=_slicedToArray(_task$split,2);var name=_task$split2[0];var stage=_task$split2[1];var component=this.getComponent(name);var _iteratorNormalCompletion7=true;var _didIteratorError7=false;var _iteratorError7=undefined;try{for(var _iterator7=component.variants[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=true){var vr=_step7.value;component[stage](vr)}}catch(err){_didIteratorError7=true;_iteratorError7=err}finally {try{if(!_iteratorNormalCompletion7&&_iterator7.return){_iterator7.return()}}finally {if(_didIteratorError7){throw _iteratorError7}}}}}catch(err){_didIteratorError6=true;_iteratorError6=err}finally {try{if(!_iteratorNormalCompletion6&&_iterator6.return){_iterator6.return()}}finally {if(_didIteratorError6){throw _iteratorError6}}}}}]);return _class}(_skeleton2.default);exports.default=_class;
},{"./components":1,"./control":2,"./ctype":3,"./eumap":4,"./facet":5,"./filter":6,"./generic.js":7,"./item":8,"./list":9,"./share":14,"./skeleton":15,"./tadiraha":16,"./tadiraho":17,"./tadiraht":18,"./viewstate":19}],13:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally {try{if(!_n&&_i['return'])_i['return']()}finally {if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else {throw new TypeError('Invalid attempt to destructure non-iterable instance')}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _generic=require('./generic.js');var g=_interopRequireWildcard(_generic);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else {var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _list=Symbol();var _list2=Symbol();var _all_values_control=Symbol();var _cols=Symbol();var _cutoff=Symbol();var _shortsize=Symbol();var _class=function(){function _class(component,rtype,cols,cutoff,shortsize){_classCallCheck(this,_class);this.component=component;this.distilled=new Map;this[_list]=new Map;this[_list2]=new Map;this.related_state=new Map;this[_all_values_control]=new Map;this.statistics=new Map;this.related_values_list=new Map;this.related_values_index=new Map;this.related_values_all=new Map;this.no_values={value:'-',name:'-none'};this.typ=rtype;this[_cols]=cols||2;this[_cutoff]=cutoff||14;this[_shortsize]=shortsize||6}_createClass(_class,[{key:'_html',value:function _html(vr){var type_sg=this.component.state.showState('list',this.typ,'sg');var type_pl=this.component.state.showState('list',this.typ,'pl');var h='';h+=this._preHtml(vr);h+='\n<div>\n    <p class="dctrl"><span fct="'+this.component.name+'-'+vr+'"></span> By '+type_sg+'</p>\n    <p class="all"><span rv="_all" class="stats"></span> <a rv="_all" href="#" class="facet_single_all">all '+type_pl+'</a></p>\n    <table class="value_list" id="list-'+this.typ+'-vals_'+vr+'">\n        <tr>\n';var ar=this.related_values_list.get(vr);var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=ar.entries()[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _step$value=_slicedToArray(_step.value,2);var i=_step$value[0];var related_value=_step$value[1];if(i%this[_cols]==0&&i>0&&i<ar.length){h+='</tr><tr>'}var raw_value=this.related_values_index.get(vr).get(related_value);h+='\n            <td><span rv="'+related_value+'" class="stats"></span></td>\n            <td><a rv="'+related_value+'" href="#" class="facet_single">'+g.escapeHTML(raw_value)+'</a></td>\n            '}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}h+='\n        </tr>\n    </table>\n    <p class="value_list2" id="list2-'+this.typ+'-vals_'+vr+'">\n';var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=ar.entries()[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _step2$value=_slicedToArray(_step2.value,2);var i=_step2$value[0];var related_value=_step2$value[1];var _raw_value=this.related_values_index.get(vr).get(related_value);var compact_value=g.escapeHTML(g.compact(this[_cutoff],this[_shortsize],_raw_value));h+='<a href="#" rv="'+related_value+'" class="passive_small" title="'+g.escapeHTML(_raw_value)+'">'+compact_value+'</a> '}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally {try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally {if(_didIteratorError2){throw _iteratorError2}}}h+='\n    </p>\n</div>';this.component.container.get(vr).html(h)}},{key:'_dressup',value:function _dressup(vr){var cc=this.component.container.get(vr);this[_list].set(vr,cc.find('#list-'+this.typ+'-vals_'+vr));this[_list2].set(vr,cc.find('#list2-'+this.typ+'-vals_'+vr));var that=this;this[_list].get(vr).find('.facet_single').click(function(e){e.preventDefault();var related_value=$(this).attr('rv');var selected=g.from_str(that.component.state.getState('rel_'+that.typ+'_'+vr));if(selected.has(related_value)){selected.delete(related_value)}else {selected.add(related_value)}that.component.state.setState('rel_'+that.typ+'_'+vr,g.to_str(selected));cc.find('.last_handled').removeClass('last_handled');$(this).addClass('last_handled')});this[_list2].get(vr).find('.passive_small').click(function(e){e.preventDefault();var related_value=$(this).attr('rv');var selected=g.from_str(that.component.state.getState('rel_'+that.typ+'_'+vr));if(selected.has(related_value)){selected.delete(related_value)}else {selected.add(related_value)}that.component.state.setState('rel_'+that.typ+'_'+vr,g.to_str(selected));$(this).closest('div').find('.morec').click();var last_handled=that[_list].get(vr).find('a[rv="'+related_value+'"]');cc.find('.last_handled').removeClass('last_handled');last_handled.addClass('last_handled');$('#left')[0].scrollTop=50;last_handled[0].scrollIntoView({behavior:'smooth',alignToTop:'true'})});this[_all_values_control].set(vr,this.component.container.get(vr).find('[rv="_all"]'));this[_all_values_control].get(vr).click(function(e){e.preventDefault();var ison=$(this).hasClass('ison');if(ison){that.component.state.setState('rel_'+that.typ+'_'+vr,'')}else {that.component.state.setState('rel_'+that.typ+'_'+vr,g.to_str(that.related_values_all.get(vr)))}})}},{key:'_setFacet',value:function _setFacet(vr){var all_selected=true;var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=this.related_values_index.get(vr).keys()[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var related_value=_step3.value;var facet_cell=this[_list].get(vr).find('[rv="'+related_value+'"]');var facet_cell2=this[_list2].get(vr).find('[rv="'+related_value+'"]');if(this.related_state.get(vr).has(related_value+'')){facet_cell.addClass('ison');facet_cell2.addClass('ison')}else {facet_cell.removeClass('ison');facet_cell2.removeClass('ison');all_selected=false}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally {try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally {if(_didIteratorError3){throw _iteratorError3}}}if(all_selected){this[_all_values_control].get(vr).addClass('ison')}else {this[_all_values_control].get(vr).removeClass('ison')}}},{key:'stats',value:function stats(vr){this.statistics.set(vr,new Map);var rvs=this.statistics.get(vr);var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=this.related_values_index.get(vr).keys()[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var related_value=_step4.value;rvs.set(related_value,0)}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally {try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally {if(_didIteratorError4){throw _iteratorError4}}}var related_info=this.component.related_info.get(vr);var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=this.distilled.get(vr)[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var i=_step5.value;var has_related_value=false;if(related_info.has(i)){var _iteratorNormalCompletion7=true;var _didIteratorError7=false;var _iteratorError7=undefined;try{for(var _iterator7=related_info.get(i)[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=true){var _related_value=_step7.value;rvs.set(_related_value,rvs.get(_related_value)+1);has_related_value=true}}catch(err){_didIteratorError7=true;_iteratorError7=err}finally {try{if(!_iteratorNormalCompletion7&&_iterator7.return){_iterator7.return()}}finally {if(_didIteratorError7){throw _iteratorError7}}}}if(!has_related_value){var nv=this.no_values.value;rvs.set(nv,rvs.get(nv)+1)}}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally {try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally {if(_didIteratorError5){throw _iteratorError5}}}var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=rvs[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var _step6$value=_slicedToArray(_step6.value,2);var _related_value2=_step6$value[0];var stat=_step6$value[1];this.component.container.get(vr).find('span[rv="'+_related_value2+'"].stats').html(stat)}}catch(err){_didIteratorError6=true;_iteratorError6=err}finally {try{if(!_iteratorNormalCompletion6&&_iterator6.return){_iterator6.return()}}finally {if(_didIteratorError6){throw _iteratorError6}}}this.component.container.get(vr).find('span[rv="_all"].stats').html(this.distilled.get(vr).length);this._myStats(vr)}},{key:'v',value:function v(vr,i){var related_info=this.component.related_info.get(vr);var related_state=this.related_state.get(vr);if(related_info.has(i)){var _iteratorNormalCompletion8=true;var _didIteratorError8=false;var _iteratorError8=undefined;try{for(var _iterator8=related_info.get(i)[Symbol.iterator](),_step8;!(_iteratorNormalCompletion8=(_step8=_iterator8.next()).done);_iteratorNormalCompletion8=true){var related_value=_step8.value;if(related_state.has(related_value+'')){return true}}}catch(err){_didIteratorError8=true;_iteratorError8=err}finally {try{if(!_iteratorNormalCompletion8&&_iterator8.return){_iterator8.return()}}finally {if(_didIteratorError8){throw _iteratorError8}}}}else {if(related_state.has(this.no_values.value)){return true}}return false}},{key:'show',value:function show(vr){return this.component.state.getState('list')==vr}},{key:'weld',value:function weld(vr){this.related_values_list.set(vr,[]);this.related_values_index.set(vr,new Map);this.related_values_all.set(vr,new Set);this._plainWeld(vr);this._myWeld(vr);this.related_values_list.get(vr).push(this.no_values.value);this.related_values_index.get(vr).set(this.no_values.value,this.no_values.name);this.related_values_all.get(vr).add(this.no_values.value);this._html(vr)}},{key:'wire',value:function wire(vr){this._myDressup(vr);this._dressup(vr)}},{key:'work',value:function work(vr){this.related_state.set(vr,g.from_str(this.component.state.getState('rel_'+this.typ+'_'+vr)));this._mySetFacet(vr);this._setFacet(vr)}},{key:'_plainWeld',value:function _plainWeld(vr){var related_values=this.component.related_values.get(vr);var _iteratorNormalCompletion9=true;var _didIteratorError9=false;var _iteratorError9=undefined;try{for(var _iterator9=related_values[Symbol.iterator](),_step9;!(_iteratorNormalCompletion9=(_step9=_iterator9.next()).done);_iteratorNormalCompletion9=true){var _step9$value=_slicedToArray(_step9.value,2);var i=_step9$value[0];var related_value=_step9$value[1];this.related_values_list.get(vr).push(i);this.related_values_index.get(vr).set(i,related_value);this.related_values_all.get(vr).add(i)}}catch(err){_didIteratorError9=true;_iteratorError9=err}finally {try{if(!_iteratorNormalCompletion9&&_iterator9.return){_iterator9.return()}}finally {if(_didIteratorError9){throw _iteratorError9}}}this.related_values_list.get(vr).sort(function(a,b){return related_values.get(a)<related_values.get(b)?-1:related_values.get(a)>related_values.get(b)?1:0})}},{key:'_myWeld',value:function _myWeld(vr){}},{key:'_preHtml',value:function _preHtml(vr){return ''}},{key:'_myDressup',value:function _myDressup(vr){}},{key:'_mySetFacet',value:function _mySetFacet(vr){}},{key:'_myStats',value:function _myStats(vr){}}]);return _class}();exports.default=_class;
},{"./generic.js":7}],14:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _generic=require('./generic.js');var g=_interopRequireWildcard(_generic);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else {var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _class=function(){function _class(component){_classCallCheck(this,_class);this.component=component}_createClass(_class,[{key:'show',value:function show(vr){return true}},{key:'weld',value:function weld(vr){var h='\n<p id="citeh">Cite</p>\n<table align="center">\n    <tr>\n        <td class="clip_pv clr">\n            <a lnk="" href="#" id="clip_pv_md" title="link to page content and appearance (markdown)" class="ctrl fa fa-level-down fa-lg fa-fw"></a>\n            <a lnk="" href="#" id="clip_pv_ht" title="link to page content and appearance (html)" class="ctrl fa fa-external-link-square fa-lg fa-fw"></a>\n            <a lnk="" href="#" id="clip_pv_htc" title="link to page content (html)" class="ctrl fa fa-external-link fa-lg fa-fw"></a>\n            <a lnk="" href="#" id="clip_pv_cn" title="copy page content" class="ctrl fa fa-file-text-o fa-lg fa-fw"></a>\n        </td>\n    </tr>\n    <tr>\n        <th class="clip_pv" width="60px">page view</th>\n    </tr>\n    <tr class="citexpl">\n        <td class="clip_pv"><span id="xc_pv" class="ctrl fa fa-chevron-right fa-fw"></span><span id="x_pv" class="detail">share link to this page with or without view settings.</span></td>\n    </tr>\n</table>\n<p id="cdiagpub"></p>\n<p id="cdiagsts"></p>\n';this.component.container.get(vr).html(h)}},{key:'wire',value:function wire(vr){var that=this;var cc=this.component.container.get(vr);var slink=$('#self_link');slink.hide();cc.addClass('socialdrawer');cc.find('.detail').hide();cc.find('#clip_pv_md,#clip_pv_ht,#clip_pv_htc,#clip_pv_nl').click(function(e){e.preventDefault();window.prompt('Press <Cmd-C> and then <Enter> to copy link on clipboard',$(this).attr('lnk'))});cc.find('#clip_pv_cn').click(function(e){e.preventDefault();var containerid='middle';var app_url_raw=app_url_cite+that.component.state.getVars(true);slink.show();slink.attr('href',app_url_raw);g.selectText(containerid)});cc.find('#xc_pv').click(function(e){e.preventDefault();g.toggleDetail($(this),$('#x_pv'))});cc.click(function(e){e.preventDefault();var app_url_raw=app_url_cite+that.component.state.getVars(true);var app_url_rawc=app_url_cite+that.component.state.getVars(false);$('#citeh').hide();$('#cdiagpub').html('');$('#cdiagsts').html('');$('.clip_pv.clr,#cdiagpub,#cdiagsts').removeClass('error warning good special');var pvtitle=g.escapeHTML($('title').text());$('#clip_pv_md').attr('lnk','[${pvtitle}](${app_url_raw})');$('#clip_pv_ht').attr('lnk',app_url_raw);$('#clip_pv_htc').attr('lnk',app_url_rawc);$('#clip_pv_cn').attr('lnk',app_url_raw);$('#clip_pv_cn').attr('tit',pvtitle);$(this).animate({height:'100px',width:'200px',opacity:0.95},300)});cc.mouseleave(function(){slink.hide();$('#citeh').show();cc.animate({height:'20px',width:'40px',opacity:0.7},300);return false})}},{key:'work',value:function work(vr){}}]);return _class}();exports.default=_class;
},{"./generic.js":7}],15:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally {try{if(!_n&&_i['return'])_i['return']()}finally {if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else {throw new TypeError('Invalid attempt to destructure non-iterable instance')}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _class=function(){function _class(){_classCallCheck(this,_class);this.stages=new Map([['weld',true],['wire',true],['work',false]]);this.stages_prev=new Map([['wire','weld'],['work','wire']]);this.before=new Map([['weld',new Map([['item',new Set(['list'])],['facet',new Set(['control','list'])],['filter',new Set(['facet'])],['eumap',new Set(['facet','filter'])],['ctype',new Set(['facet','eumap'])],['tadiraha',new Set(['facet','ctype'])],['tadiraho',new Set(['facet','tadiraha'])],['tadiraht',new Set(['facet','tadiraho'])],['share',new Set(['facet','list'])]])],['wire',new Map([['item',new Set(['list'])],['facet',new Set(['filter','eumap','ctype','tadiraha','tadiraho','tadiraht'])],['filter',new Set(['list'])],['eumap',new Set(['list'])],['ctype',new Set(['list'])],['tadiraha',new Set(['list'])],['tadiraho',new Set(['list'])],['tadiraht',new Set(['list'])]])],['work',new Map([['facet',new Set(['filter','eumap','ctype','tadiraha','tadiraho','tadiraht'])]])]])}_createClass(_class,[{key:'resolveTiming',value:function resolveTiming(){var timing_nodes=[];var timing_edges=new Map;var timing_edges_inv=new Map;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.components.keys()[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var name=_step.value;var _iteratorNormalCompletion12=true;var _didIteratorError12=false;var _iteratorError12=undefined;try{for(var _iterator12=this.stages.keys()[Symbol.iterator](),_step12;!(_iteratorNormalCompletion12=(_step12=_iterator12.next()).done);_iteratorNormalCompletion12=true){var stage=_step12.value;timing_nodes.push(name+'-'+stage)}}catch(err){_didIteratorError12=true;_iteratorError12=err}finally {try{if(!_iteratorNormalCompletion12&&_iterator12.return){_iterator12.return()}}finally {if(_didIteratorError12){throw _iteratorError12}}}}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}function addEdge(prev_node,next_node){if(!timing_edges.has(prev_node)){timing_edges.set(prev_node,new Set)}if(!timing_edges_inv.has(next_node)){timing_edges_inv.set(next_node,new Set)}timing_edges.get(prev_node).add(next_node);timing_edges_inv.get(next_node).add(prev_node)}var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=this.stages_prev[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _step2$value=_slicedToArray(_step2.value,2);var next_stage=_step2$value[0];var prev_stage=_step2$value[1];var _iteratorNormalCompletion13=true;var _didIteratorError13=false;var _iteratorError13=undefined;try{for(var _iterator13=this.components.keys()[Symbol.iterator](),_step13;!(_iteratorNormalCompletion13=(_step13=_iterator13.next()).done);_iteratorNormalCompletion13=true){var _name=_step13.value;addEdge(_name+'-'+prev_stage,_name+'-'+next_stage)}}catch(err){_didIteratorError13=true;_iteratorError13=err}finally {try{if(!_iteratorNormalCompletion13&&_iterator13.return){_iterator13.return()}}finally {if(_didIteratorError13){throw _iteratorError13}}}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally {try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally {if(_didIteratorError2){throw _iteratorError2}}}var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=this.before[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var _step3$value=_slicedToArray(_step3.value,2);var _stage=_step3$value[0];var nexts=_step3$value[1];var _iteratorNormalCompletion14=true;var _didIteratorError14=false;var _iteratorError14=undefined;try{for(var _iterator14=nexts[Symbol.iterator](),_step14;!(_iteratorNormalCompletion14=(_step14=_iterator14.next()).done);_iteratorNormalCompletion14=true){var _step14$value=_slicedToArray(_step14.value,2);var next_name=_step14$value[0];var prevs=_step14$value[1];if(this.ignore.has(next_name)){continue}var _iteratorNormalCompletion15=true;var _didIteratorError15=false;var _iteratorError15=undefined;try{for(var _iterator15=prevs.keys()[Symbol.iterator](),_step15;!(_iteratorNormalCompletion15=(_step15=_iterator15.next()).done);_iteratorNormalCompletion15=true){var prev_name=_step15.value;if(this.ignore.has(prev_name)){continue}addEdge(prev_name+'-'+_stage,next_name+'-'+_stage)}}catch(err){_didIteratorError15=true;_iteratorError15=err}finally {try{if(!_iteratorNormalCompletion15&&_iterator15.return){_iterator15.return()}}finally {if(_didIteratorError15){throw _iteratorError15}}}}}catch(err){_didIteratorError14=true;_iteratorError14=err}finally {try{if(!_iteratorNormalCompletion14&&_iterator14.return){_iterator14.return()}}finally {if(_didIteratorError14){throw _iteratorError14}}}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally {try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally {if(_didIteratorError3){throw _iteratorError3}}}var n=0;var subset=[];var visited=new Set;while(n<=timing_nodes.length){subset.push(new Set);if(n==0){var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=timing_nodes[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var node=_step4.value;if(!timing_edges_inv.has(node)){subset[n].add(node)}}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally {try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally {if(_didIteratorError4){throw _iteratorError4}}}}else {var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=visited[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var prev_node=_step5.value;if(timing_edges.has(prev_node)){var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=timing_edges.get(prev_node)[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var next_node=_step6.value;if(!visited.has(next_node)){var good=true;var _iteratorNormalCompletion7=true;var _didIteratorError7=false;var _iteratorError7=undefined;try{for(var _iterator7=timing_edges_inv.get(next_node)[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=true){var other_prev_node=_step7.value;if(!visited.has(other_prev_node)){good=false;break}}}catch(err){_didIteratorError7=true;_iteratorError7=err}finally {try{if(!_iteratorNormalCompletion7&&_iterator7.return){_iterator7.return()}}finally {if(_didIteratorError7){throw _iteratorError7}}}if(good){subset[n].add(next_node)}}}}catch(err){_didIteratorError6=true;_iteratorError6=err}finally {try{if(!_iteratorNormalCompletion6&&_iterator6.return){_iterator6.return()}}finally {if(_didIteratorError6){throw _iteratorError6}}}}}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally {try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally {if(_didIteratorError5){throw _iteratorError5}}}}if(subset[n].size==0){break}var _iteratorNormalCompletion8=true;var _didIteratorError8=false;var _iteratorError8=undefined;try{for(var _iterator8=subset[n][Symbol.iterator](),_step8;!(_iteratorNormalCompletion8=(_step8=_iterator8.next()).done);_iteratorNormalCompletion8=true){var _node=_step8.value;visited.add(_node)}}catch(err){_didIteratorError8=true;_iteratorError8=err}finally {try{if(!_iteratorNormalCompletion8&&_iterator8.return){_iterator8.return()}}finally {if(_didIteratorError8){throw _iteratorError8}}}n++}this._tasks=[];this._timing=new Map;if(visited.size!=timing_nodes.length){var cycle=[];var _iteratorNormalCompletion9=true;var _didIteratorError9=false;var _iteratorError9=undefined;try{for(var _iterator9=timing_nodes[Symbol.iterator](),_step9;!(_iteratorNormalCompletion9=(_step9=_iterator9.next()).done);_iteratorNormalCompletion9=true){var _node2=_step9.value;if(!visited.has(_node2)){cycle.push(_node2)}}}catch(err){_didIteratorError9=true;_iteratorError9=err}finally {try{if(!_iteratorNormalCompletion9&&_iterator9.return){_iterator9.return()}}finally {if(_didIteratorError9){throw _iteratorError9}}}console.log('Circular timing constraints detected',cycle)}else {var _iteratorNormalCompletion10=true;var _didIteratorError10=false;var _iteratorError10=undefined;try{for(var _iterator10=subset[Symbol.iterator](),_step10;!(_iteratorNormalCompletion10=(_step10=_iterator10.next()).done);_iteratorNormalCompletion10=true){var nodes=_step10.value;var _iteratorNormalCompletion11=true;var _didIteratorError11=false;var _iteratorError11=undefined;try{for(var _iterator11=nodes[Symbol.iterator](),_step11;!(_iteratorNormalCompletion11=(_step11=_iterator11.next()).done);_iteratorNormalCompletion11=true){var _node3=_step11.value;this._tasks.push(_node3)}}catch(err){_didIteratorError11=true;_iteratorError11=err}finally {try{if(!_iteratorNormalCompletion11&&_iterator11.return){_iterator11.return()}}finally {if(_didIteratorError11){throw _iteratorError11}}}}}catch(err){_didIteratorError10=true;_iteratorError10=err}finally {try{if(!_iteratorNormalCompletion10&&_iterator10.return){_iterator10.return()}}finally {if(_didIteratorError10){throw _iteratorError10}}}this._timing=timing_edges_inv;console.log('Timing resolved',this._tasks)}}}]);return _class}();exports.default=_class;
},{}],16:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _relative=require('./relative');var _relative2=_interopRequireDefault(_relative);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _class=function(_Relative){_inherits(_class,_Relative);function _class(component){_classCallCheck(this,_class);return _possibleConstructorReturn(this,Object.getPrototypeOf(_class).call(this,component,'tadiraha'))}return _class}(_relative2.default);exports.default=_class;
},{"./relative":13}],17:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _relative=require('./relative');var _relative2=_interopRequireDefault(_relative);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _class=function(_Relative){_inherits(_class,_Relative);function _class(component){_classCallCheck(this,_class);return _possibleConstructorReturn(this,Object.getPrototypeOf(_class).call(this,component,'tadiraho'))}return _class}(_relative2.default);exports.default=_class;
},{"./relative":13}],18:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _relative=require('./relative');var _relative2=_interopRequireDefault(_relative);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _class=function(_Relative){_inherits(_class,_Relative);function _class(component){_classCallCheck(this,_class);return _possibleConstructorReturn(this,Object.getPrototypeOf(_class).call(this,component,'tadiraht',1,30))}return _class}(_relative2.default);exports.default=_class;
},{"./relative":13}],19:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally {try{if(!_n&&_i['return'])_i['return']()}finally {if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else {throw new TypeError('Invalid attempt to destructure non-iterable instance')}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _generic=require('./generic.js');var g=_interopRequireWildcard(_generic);var _message=require('./message');var _message2=_interopRequireDefault(_message);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else {var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _spec_info=Symbol();var _data=Symbol();var _specs=Symbol();var _msg=Symbol();var _class=function(){function _class(page){_classCallCheck(this,_class);this[_spec_info]={vars:new Set(['list','flt_contrib','flt_country','flt_type','flt_tadiraha','flt_tadiraho','flt_tadiraht','rel_country_contrib','rel_type_contrib','rel_tadiraha_contrib','rel_tadiraho_contrib','rel_tadiraht_contrib','item_contrib','item_country','sort']),vals:new Map([['list',new Set(['contrib','country','type','tadiraha','tadiraho','tadiraht'])],['sort',new Map([['v',true],['x',false]])]]),default_value:new Map([['list','contrib'],['sort',true]]),typ:new Map([['sort','boolean']]),url:new Set(['list','item_contrib','item_country']),showas:new Map([['list',new Map([['contrib',{sg:'contribution',pl:'contributions'}],['country',{sg:'country',pl:'countries'}],['type',{sg:'type',pl:'types'}],['tadiraha',{sg:'tadirah activity',pl:'tadirah activities'}],['tadiraho',{sg:'tadirah object',pl:'tadirah objects'}],['tadiraht',{sg:'tadirah technique',pl:'tadirah techniques'}]])]])};this[_data]={};this[_specs]=new Map;this.page=page;this[_msg]=new _message2.default('msg_page');this._compile_specs();this._getInitstate();this._addHistory()}_createClass(_class,[{key:'_compile_specs',value:function _compile_specs(){var info=this[_spec_info];var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=info.vars[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var v=_step.value;var spec={};spec.vals=info.vals.get(v)||null;spec.default_value=info.default_value.get(v)||'';spec.typ=info.typ.get(v)||'string';spec.url=info.url.has(v);spec.showas=info.showas.get(v)||{};this[_specs].set(v,spec)}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}}},{key:'_validate',value:function _validate(v,val){var newval=void 0,message=void 0;if(this[_specs].has(v)){var spec=this[_specs].get(v);if(spec.typ=='string'){if(spec.vals){if(spec.vals.has(val)){newval=val}else {newval=spec.default_value;this[_msg].msg('illegal string value for '+v+': "'+val+'" is replaced by "'+spec.default_value+'"','warning')}}else {newval=val}}else if(spec.typ=='integer'){if(/^(\-|\+)?[0-9]+$/.test(val)){newval=Number(val)}else {newval=spec.default_value;this[_msg].msg('not a number value for '+v+': "'+val+'" is replaced by "'+spec.default_value+'"','warning')}if(newval<spec.limits.min){this[_msg].msg('number to small for '+v+': "'+newval+'" is replaced by "'+spec.limits.min+'"','warning')}if(newval>spec.limits.max){this[_msg].msg('number to big for '+v+': "'+newval+'" is replaced by "'+spec.limits.max+'"','warning')}}else if(spec.typ=='boolean'){if(spec.vals.has(val)){newval=spec.vals.get(val)}else {newval=spec.default_value;this[_msg].msg('illegal boolean value for '+v+': "'+val+'" is replaced by "'+spec.default_value+'"','warning')}}}else {newval=null;this[_msg].msg('unknown parameter: '+v+'='+val,'warning')}return newval}},{key:'getVars',value:function getVars(comprehensive){var vars=[];for(var v in this[_data]){var val=this[_data][v];var spec=this[_specs].get(v);if(comprehensive||spec.url){if(spec.typ=='string'||spec.typ=='integer'){vars.push(v+'='+val)}else if(spec.typ=='boolean'){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=spec.vals[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _step2$value=_slicedToArray(_step2.value,2);var valid_val=_step2$value[0];var trans_val=_step2$value[1];if(trans_val==val){vars.push(v+'='+valid_val)}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally {try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally {if(_didIteratorError2){throw _iteratorError2}}}}}}return vars.join('&')}},{key:'_getInitstate',value:function _getInitstate(){var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=g.request_vars[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var _step3$value=_slicedToArray(_step3.value,2);var v=_step3$value[0];var val=_step3$value[1];if(!this[_specs].has(v)){this[_msg].msg('unknown parameter: '+v+'='+val,'warning')}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally {try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally {if(_didIteratorError3){throw _iteratorError3}}}var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=this[_specs][Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var _step4$value=_slicedToArray(_step4.value,2);var v=_step4$value[0];var spec=_step4$value[1];var val=null;if(g.request_vars.has(v)){var raw_val=g.request_vars.get(v);val=this._validate(v,raw_val);g.localstorage_vars.set(v,val)}else if(g.localstorage_vars.isSet(v)){val=g.localstorage_vars.get(v)}else {val=spec.default_value;g.localstorage_vars.set(v,val)}this[_data][v]=val}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally {try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally {if(_didIteratorError4){throw _iteratorError4}}}}},{key:'_addHistory',value:function _addHistory(title,view_url){var tit='DARIAH contribution tool';var this_url=app_url+'?'+this.getVars(false);History.pushState(this[_data],tit,this_url)}},{key:'setState',value:function setState(v,val){this[_data][v]=val;g.localstorage_vars.set(v,val);this._addHistory()}},{key:'getState',value:function getState(v){return this[_data][v]}},{key:'getValues',value:function getValues(v){return this[_specs].get(v).vals}},{key:'showState',value:function showState(v,val,mode){var result=val;var md=mode==undefined?'sg':mode;var showas=this[_specs].get(v).showas;if(showas.has(val)){result=showas.get(val)[mode]}return result}},{key:'work',value:function work(){return function(){var state=History.getState();if(state&&state.data){this[_data]=state.data;this.page.work()}}.bind(this)}}]);return _class}();exports.default=_class;
},{"./generic.js":7,"./message":11}]},{},[10]);
